!function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=19)}([function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=new(function(){function e(){this._publickey="",this._ongalleryload="",this._debug=!1,this._nomobile=!1,this._notablet=!1,this._aggressivelazy=!1,this._nocache=!1,this._idattribute="",this._scandivwbgattr="",this._bgimageselector="div, button",this._ignorepicture=!1,this._imgignore=null,this._directurl=!1,this._divignore=!1,this._divignorelevels="",this._ignoreparentelement="",this._ignorehref=!1,this._optimizely=!1,this._optimizelyoff=!1,this._passivetracking=!1,this._summaryplaytimeout=500,this._redirect=!1,this._redirecttext="Video Will Begin In...",this._ctatext="See The Full Clip",this._redirectwithclick=!0,this._redirectwithclicktarget=!1,this._redirectwithvid=!1,this._redirectafter=null,this._redirectautoplay=!1,this._socialtext="",this._autoplay=!1,this._autoplayonce=!1,this._fadeinadvance=700,this._stopnoimage=!1,this._pauseonhover=!1,this._pausehoveronce=!1,this._noimage=!1,this._audio=!1,this._audioonce=!1,this._audiohover=!1,this._resizeonscroll=!1,this._proactiveload=!1,this._urlregexp="",this._disableall=!1,this._ignorecurrenturl=!1,this._audiopolicycta=!1,this._preloadoffset=300,this._disablestorage=!1,this._iemaxelements=20,this._reduceresolution=!1,this._mobilepreload=!0,this._maxpreloadedvideos=5,this._allautoplay=!1,this._followscroll=!1,this._pulltochange=!1,this._initmobilequeue=!1,this._customimgsrc="",this._smallgif=!1,this._ingnoreelementheight=!0,this._topviewportoffset=0,this._bottomviewportoffset=0,this._minscrolldistance=50,this._mobilecta=!1,this._mobilectaloopcount=1,this._previewdelay=0,this._forcesmallvideo=!1,this._taptoplay=!1,this._hidectaicon=!1,this._horizontalthreshold=80,this._analytics=!1,this._viziodevice=null,this._abtestingpercentage=0}return Object.defineProperty(e.prototype,"horizontalthreshold",{get:function(){return parseInt(this._horizontalthreshold,10)},set:function(e){this._horizontalthreshold=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidectaicon",{get:function(){return this._hidectaicon},set:function(e){this._hidectaicon=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taptoplay",{get:function(){return this._taptoplay},set:function(e){this._taptoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forcesmallvideo",{get:function(){return this._forcesmallvideo},set:function(e){this._forcesmallvideo=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewdelay",{get:function(){return parseInt(this._previewdelay,10)},set:function(e){this._previewdelay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilectaloopcount",{get:function(){return parseInt(this._mobilectaloopcount,10)},set:function(e){this._mobilectaloopcount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilecta",{get:function(){return this._mobilecta},set:function(e){this._mobilecta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minscrolldistance",{get:function(){return parseInt(this._minscrolldistance,10)},set:function(e){this._minscrolldistance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomviewportoffset",{get:function(){return parseInt(this._bottomviewportoffset,10)},set:function(e){this._bottomviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topviewportoffset",{get:function(){return parseInt(this._topviewportoffset,10)},set:function(e){this._topviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ingnoreelementheight",{get:function(){return this._ingnoreelementheight},set:function(e){this._ingnoreelementheight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smallgif",{get:function(){return this._smallgif},set:function(e){this._smallgif=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customimgsrc",{get:function(){return this._customimgsrc},set:function(e){this._customimgsrc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initmobilequeue",{get:function(){return this._initmobilequeue},set:function(e){this._initmobilequeue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pulltochange",{get:function(){return this._pulltochange},set:function(e){this._pulltochange=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followscroll",{get:function(){return this._followscroll},set:function(e){this._followscroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allautoplay",{get:function(){return this._allautoplay},set:function(e){this._allautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxpreloadedvideos",{get:function(){return parseInt(this._maxpreloadedvideos,10)},set:function(e){this._maxpreloadedvideos=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilepreload",{get:function(){return this._mobilepreload},set:function(e){this._mobilepreload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reduceresolution",{get:function(){return this._reduceresolution},set:function(e){this._reduceresolution=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iemaxelements",{get:function(){return this._iemaxelements},set:function(e){this._iemaxelements=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disablestorage",{get:function(){return this._disablestorage},set:function(e){this._disablestorage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preloadoffset",{get:function(){return this._preloadoffset},set:function(e){this._preloadoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiopolicycta",{get:function(){return this._audiopolicycta},set:function(e){this._audiopolicycta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorecurrenturl",{get:function(){return this._ignorecurrenturl},set:function(e){this._ignorecurrenturl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disableall",{get:function(){return this._disableall},set:function(e){this._disableall=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"urlregexp",{get:function(){return this._urlregexp},set:function(e){this._urlregexp=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proactiveload",{get:function(){return this._proactiveload},set:function(e){this._proactiveload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeonscroll",{get:function(){return this._resizeonscroll},set:function(e){this._resizeonscroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiohover",{get:function(){return this._audiohover},set:function(e){this._audiohover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioonce",{get:function(){return this._audioonce},set:function(e){this._audioonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this._audio},set:function(e){this._audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noimage",{get:function(){return this._noimage},set:function(e){this._noimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pausehoveronce",{get:function(){return this._pausehoveronce},set:function(e){this._pausehoveronce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pauseonhover",{get:function(){return this._pauseonhover},set:function(e){this._pauseonhover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopnoimage",{get:function(){return this._stopnoimage},set:function(e){this._stopnoimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeinadvance",{get:function(){return parseInt(this._fadeinadvance,10)},set:function(e){this._fadeinadvance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplayonce",{get:function(){return this._autoplayonce},set:function(e){this._autoplayonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(e){this._autoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"socialtext",{get:function(){return this._socialtext},set:function(e){this._socialtext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectautoplay",{get:function(){return this._redirectautoplay},set:function(e){this._redirectautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectafter",{get:function(){return parseInt(this._redirectafter,10)},set:function(e){this._redirectafter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithvid",{get:function(){return this._redirectwithvid},set:function(e){this._redirectwithvid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclicktarget",{get:function(){return this._redirectwithclicktarget},set:function(e){this._redirectwithclicktarget=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclick",{get:function(){return this._redirectwithclick},set:function(e){this._redirectwithclick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctatext",{get:function(){return this._ctatext},set:function(e){this._ctatext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirecttext",{get:function(){return this._redirecttext},set:function(e){this._redirecttext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirect",{get:function(){return this._redirect},set:function(e){this._redirect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"summaryplaytimeout",{get:function(){return parseInt(this._summaryplaytimeout,10)},set:function(e){this._summaryplaytimeout=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"passivetracking",{get:function(){return this._passivetracking},set:function(e){this._passivetracking=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizelyoff",{get:function(){return this._optimizelyoff},set:function(e){this._optimizelyoff=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizely",{get:function(){return this._optimizely},set:function(e){this._optimizely=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorehref",{get:function(){return this._ignorehref},set:function(e){this._ignorehref=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignoreparentelement",{get:function(){return this._ignoreparentelement},set:function(e){this._ignoreparentelement=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"divignorelevels",{get:function(){return this._divignorelevels},set:function(e){this._divignorelevels=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"divignore",{get:function(){return this._divignore},set:function(e){this._divignore=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directurl",{get:function(){return this._directurl},set:function(e){this._directurl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imgignore",{get:function(){return this._imgignore},set:function(e){this._imgignore=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorepicture",{get:function(){return this._ignorepicture},set:function(e){this._ignorepicture=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bgimageselector",{get:function(){return this._bgimageselector},set:function(e){this._bgimageselector=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scandivwbgattr",{get:function(){return this._scandivwbgattr},set:function(e){this._scandivwbgattr=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idattribute",{get:function(){return this._idattribute},set:function(e){this._idattribute=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nocache",{get:function(){return this._nocache},set:function(e){this._nocache=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggressivelazy",{get:function(){return this._aggressivelazy},set:function(e){this._aggressivelazy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"notablet",{get:function(){return this._notablet},set:function(e){this._notablet=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nomobile",{get:function(){return this._nomobile},set:function(e){this._nomobile=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ongalleryload",{get:function(){return this._ongalleryload},set:function(e){this._ongalleryload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"publickey",{get:function(){return this._publickey},set:function(e){this._publickey=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollListenerAdded",{get:function(){return this._scrollListenerAdded},set:function(e){this._scrollListenerAdded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"analytics",{get:function(){return this._analytics},set:function(e){this._analytics=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viziodevice",{get:function(){return this._viziodevice},set:function(e){this._viziodevice=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"abtestingpercentage",{get:function(){return parseInt(this._abtestingpercentage,10)},set:function(e){this._abtestingpercentage=e},enumerable:!0,configurable:!0}),e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=new(function(){function e(){this.ua=navigator.userAgent.toLowerCase(),this.isMozilla=this.dr("firefox"),this.isWebkit=this.dr("webkit"),this.isOpera=this.dr("opera"),this.isMsie=this.dr("msie|trident|edge"),this.isIe=this.dr("trident"),this.isEdge=this.dr("edge"),this.isIe10=this.dr("msie"),this.isChrome=this.dr("chrome"),this.isAndroid=this.dr("android"),this.isIos=this.dr("iphone|ipad|ipod"),this.isIpad=this.dr("ipad"),this.isAndroidTablet=this.isAndroid&&this.dr("^mobile"),this.isTablet=this.isIpad||this.isAndroidTablet,this.isIphone=this.dr("iphone"),this.isOperaMini=this.dr("opera mini"),this.isWindowsMobile=this.dr("iemobile"),this.isKindle=this.dr("kindle|silk|kftt|kfot|kfjwa|kfjwi"),this.isMobile=this.isAndroid||this.isIos||this.isIphone||this.isOperaMini||this.isWindowsMobile||this.isKindle,this.isOldIphone=this.isIphone&&window.screen.height/window.screen.width==1.5&&window.devicePixelRatio<=2,this.isSafari=this._checkIsSafari(),this.isVizio=window.VIZIO&&window.VIZIO.isSmartCastDevice}return e.prototype.dr=function(e){return new RegExp(e).test(this.ua)},e.prototype._checkIsSafari=function(){var e;return!!this.dr("^((?!chrome).)*safari")&&(e=this.ua.search("version/"),parseInt(this.ua.substr(e+8,3),10))},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var o=new(function(){function e(){this._isRedirecting=!1,this._galleryVersion="5.4.1",this._iframeUrl="https://static.vilynx.com/gallery/vtrk.html",this._serverUrl="www.vilynx.com",this._bgImageRegex=/^url\("?.*$/}return Object.defineProperty(e.prototype,"bgImageRegex",{get:function(){return this._bgImageRegex},set:function(e){this._bgImageRegex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverUrl",{get:function(){return this._serverUrl},set:function(e){this._serverUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iframeUrl",{get:function(){return this._iframeUrl},set:function(e){this._iframeUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"galleryVersion",{get:function(){return this._galleryVersion},set:function(e){this._galleryVersion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scriptTag",{get:function(){return this._scriptTag},set:function(e){this._scriptTag=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRedirecting",{get:function(){return this._isRedirecting},set:function(e){this._isRedirecting=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryTime",{get:function(){return this._retryTime},set:function(e){this._retryTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollDirection",{get:function(){return this._scrollDirection},set:function(e){this._scrollDirection=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"savedEventsSended",{get:function(){return this._savedEventsSended},set:function(e){this._savedEventsSended=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},set:function(e){this._loaded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vilynxUID",{get:function(){return this._vilynxUID},set:function(e){this._vilynxUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tapToPlay",{get:function(){return this._tapToPlay},set:function(e){this._tapToPlay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxRetries",{get:function(){return this._maxRetries},set:function(e){this._maxRetries=e},enumerable:!0,configurable:!0}),e}())},function(e,t,i){"use strict";var o=i(9),n=i(12),r=function(){return function(e){switch(void 0===e&&(e="[_VLX_] "),this._prefix="[_VLX_] ",this._prefix=e,this.info=this.debug=this.warn=this.error=function(){},this.critical=Function.prototype.bind.call(console.error,console,"!!CRITICAL ERROR!!",this._prefix),o.a.logLevel){case n.a.info:this.info=Function.prototype.bind.call(console.info,console,this._prefix);break;case n.a.develop:this.info=Function.prototype.bind.call(console.info,console,this._prefix),this.debug=Function.prototype.bind.call(console.info,console,this._prefix),this.warn=Function.prototype.bind.call(console.warn,console,this._prefix),this.error=Function.prototype.bind.call(console.error,console,this._prefix)}}}();t.a=r},function(e,t,i){"use strict";var o,n;i.d(t,"a",function(){return o}),function(e){e.base64="base64",e.json="json",e.plain="plain"}(o||(o={})),function(e){e[e.sessionStorage=0]="sessionStorage",e[e.localStorage=1]="localStorage"}(n||(n={}))},function(e,t,i){"use strict";var o=i(0),n=i(3),r=i(2),s=function(){return function(){}}();i.d(t,"a",function(){return a});var a=new(function(){function e(){this._logger=new n.a("[vlx_dbg]"),this._logger.info("Viewport Queue initialized"),this._windowChange=!1,this._queue=[],this._loadedQueue=[],this._playingVideo=null,this._isPlaying=-1,this._lastToken=null,this._lastTokenTop=0,this._passTokenNow=!0,this._timeOuts=[]}return e.prototype.clearQueues=function(){var e=this;this._timeOuts.forEach(function(e){clearTimeout(e)}),this._timeOuts=[],clearTimeout(this._passTokenTimer),this._passTokenTimer=null,this._logger.info("Empty both loaded and viewport queues"),this._windowChange=!0,this._loadedQueue.forEach(function(t){e.removeFromLoadedQueue(t)}),this._queue.forEach(function(t){e.removeFromViewportQueue(t.gallery),t.gallery=null}),this._queue=[],this._loadedQueue=[],this._playingVideo=null,this._isPlaying=-1,this._lastToken=null,this._lastTokenTop=0,this._passTokenNow=!0},e.prototype.addToViewportQueue=function(e,t){var i=this;if(-1===this.findElement(e,this._queue)){var o=new s,n=this.getTokenized(),r=!0;o.gallery=e,o.token=!1,o.hadToken=!1,this._queue.push(o),n&&e.watcher.isThresholdInViewport&&(n.gallery.watcher.isThresholdInViewport?r=!1:(this.passToken(),n.gallery.stopOrCleanVideoNode())),r&&e.config.autoplay?t?this._timeOuts.push(window.setTimeout(function(){i.playNextInQueue(!0,null,!1)},280)):this.playNextInQueue(!0,null,!1):this._logger.info("Elem "+e.logger.debugId+" is waiting to play")}},e.prototype.removeFromViewportQueue=function(e){var t=this.findElement(e,this._queue);if(-1!==t){if(-1!==t)this._queue.splice(t,1)[0].gallery.stopOrCleanVideoNode();this.playNextInQueue(e.watcher.isAboveViewport,e.watcher.isBelowViewport,!1)}},e.prototype.addToLoadedQueue=function(e,t){var i=this,n=-1;e.scrollPosition=e.galleryData.domObject.getBoundingClientRect().top,this._timeOuts.push(setTimeout(function(){if(Math.abs(e.scrollPosition-e.galleryData.domObject.getBoundingClientRect().top)<=200){if(e.logMessage("adding video to the load queue!"),-1!==i._loadedQueue.indexOf(e))return void e.logMessage("Elem already in loaded queue, exit");if(i._loadedQueue.length<o.a.maxpreloadedvideos)e.logMessage("Loaded queue isn't filled!"),i._loadedQueue.push(e),e.initOrReattachGallery(!0);else{var r=e.watcher.isInViewport;i._loadedQueue.forEach(function(e,t){!e.watcher.isCanUnload&&e.videoNode||-1!==n||(n=t)}),-1===n&&r&&(i._loadedQueue.forEach(function(t,i){t.watcher.isInViewport||-1!==n||(e.logMessage("Video with preference removes another which is not in the viewport!"),n=i)}),(t||e.watcher.isFullyInViewport)&&-1===n&&i._loadedQueue.forEach(function(i,o){i.watcher.isThresholdInViewport&&!t||-1!==n||(e.logMessage("Video with preference removes another which is not in the viewport!"),e.logMessage("Video in "),i.logMessage("Video out"),n=o)})),-1!==n&&(i._loadedQueue[n].videoNode&&i._loadedQueue[n].cleanVideoNode(!1),i._loadedQueue[n]=e,e.videoNode||e.initOrReattachGallery(i._playingVideo===e))}}},100))},e.prototype.removeFromLoadedQueue=function(e){var t=-1;this._loadedQueue.forEach(function(i,o){i.logMessage("Im in the load queue"),i===e&&(e.logMessage("Remove from the load queue"),t=o,e.cleanVideoNode(!1))}),-1!==t?this._loadedQueue.splice(t,1):e.videoNode&&(this._logger.warn("Elem "+e.logger.debugId+" not found in loaded queue, not possible to remove it.\n             Removing video node!"),e.cleanVideoNode(!1))},e.prototype.passToken=function(){var e=this;this._queue.forEach(function(t){!0===t.token&&(t.token=!1,t.hadToken=!0,e._lastTokenTop=t.gallery.watcher.top,e._lastToken=t.gallery,e._logger.info("Token is free"))})},e.prototype.forceToken=function(e){if(this.elementHasToken(e))return!0;var t,i=!1;return this._queue.forEach(function(o){i||o.gallery!==e?!0===o.token&&(t=o):(i=!0,o.token=!0)}),i?(t&&(t.gallery.stopOrCleanVideoNode(),t.token=!1,t.hadToken=!0,this._lastTokenTop=t.gallery.watcher.top,this._lastToken=t.gallery,t.gallery.logMessage("Element forced to stop, and token deleted")),e.videoNode?e.videoNode.paused&&this.playVideo(e):(e.initOrReattachGallery(!0),o.a.mobilepreload&&!o.a.passivetracking&&this.addToLoadedQueue(e,!0))):(e.watcher.isFullyInViewport||e.watcher.isThresholdInViewport)&&(e.logMessage("Element in Viewport not in queue. Adding..."),this.addToViewportQueue(e)),i},e.prototype.elementHasToken=function(e){return this._queue.some(function(t){return t.gallery===e&&t.token})},e.prototype.resetHadToken=function(){this._queue.forEach(function(e){e.hadToken=!1})},e.prototype.isTokenFree=function(){var e=!0;return this._queue.forEach(function(t){!0===t.token&&(t.gallery.logMessage("Playing token is taken"),e=!1)}),e},e.prototype.getTokenized=function(){var e=null;return this._queue.forEach(function(t){!0===t.token&&(t.gallery.logMessage("Playing token is taken"),e=t)}),e},e.prototype.playNextInQueue=function(e,t,i){var n,r,s,a,l=this,c=this.getAllAutoplay(this._queue),d=0;if(c.length&&this.isTokenFree()){if(a=s=this.getAllFullInViewport(c),s.length||(a=c),r=c[0].gallery.watcher.top,i){this._logger.info("Playing next one due to scroll");var u=1e5,h=-1e5;e?a.forEach(function(e,t){e.gallery.watcher.top>l._lastTokenTop&&e.gallery.watcher.top<u&&!1===e.hadToken&&(u=e.gallery.watcher.top,d=t)}):t&&(this._logger.info("Scrolling to top"),a.forEach(function(e,t){e.gallery.watcher.top<l._lastTokenTop&&e.gallery.watcher.top>h&&!1===e.hadToken&&(h=e.gallery.watcher.top,d=t)}))}else e?a.forEach(function(e,t){e.gallery.watcher.top<r&&(d=t)}):t&&(this._logger.info("Scrolling to top"),a.forEach(function(e,t){e.gallery.watcher.top>r&&(d=t)}));a[d].token=!0,n=a[d],this._logger.info("Elem "+n.gallery.logger.debugId+" have the token now"),n.gallery.watcher.isFullyInViewport||n.gallery.watcher.isThresholdInViewport?(o.a.followscroll&&this.setPassTokenTimer(),o.a.mobilepreload&&!o.a.passivetracking?(n.gallery.logMessage("playing video!"),this.playVideo(n.gallery)):n.gallery.initOrReattachGallery(!0)):(this._logger.info("Element in queue but not visible any more"),o.a.mobilepreload&&!o.a.passivetracking?this.removeFromViewportQueue(n.gallery):a.splice(d,1),this.playNextInQueue(e,t,!1))}},e.prototype.getAllFullInViewport=function(e){var t=[];return e.forEach(function(e){e.gallery.watcher.isFullyInViewport&&t.push(e)}),t},e.prototype.getAllAutoplay=function(e){var t=[];return e.forEach(function(e){e.gallery.config.autoplay&&t.push(e)}),t},e.prototype.findElement=function(e,t){for(var i=0;i<t.length;++i)if(t[i].gallery===e)return e.logMessage("Element already in the queue. Abort"),i;return-1},e.prototype.playVideo=function(e){var t=this;e.videoNode?e.showVideoNode():(e.logMessage("no videoNode, readding"),this._timeOuts.push(setTimeout(function(){e.videoNode?(e.logMessage("video found 150ms later"),e.showVideoNode()):(t._playingVideo=e,t.addToLoadedQueue(e,!0))},150)))},e.prototype.playNextWithToken=function(e){this.playNextInQueue(e,!e,!0),this.resetHadToken()},e.prototype.setPassTokenTimer=function(){var e=this;this._passTokenNow=!1,clearTimeout(this._passTokenTimer),this._passTokenTimer=setTimeout(function(){e._passTokenNow=!0,e._logger.info("passTokenTimer free"),e.isTokenFree()&&e._queue.length>0&&e.playNextWithToken(r.a.scrollDirection)},1e3)},e.prototype.followScrollListener=function(){var e,t,i,n=this,s=pageYOffset||document.documentElement.scrollTop;this._logger.info("Follow scroll listener init"),window.addEventListener("scroll",function(){clearTimeout(e),e=setTimeout(function(){if(window.innerHeight+window.scrollY>=document.body.offsetHeight&&o.a.pulltochange)n._logger.info("Scrolling beyond bottom: change video"),n._queue.length>1&&n.anyVideoOnBottom()&&(n.passToken(),n._lastToken.cleanVideoNode(!0)),s=t;else if(o.a.followscroll){if(t=pageYOffset||document.documentElement.scrollTop,i=Math.abs(t-s),t>s?(n._logger.info("Scrolling to bottom with distance: "+i),r.a.scrollDirection=!0):(n._logger.info("Scrolling to top with distance: "+i),r.a.scrollDirection=!1),s=t,i<o.a.minscrolldistance)return void n._logger.info("Scroll distance to short");if(!1===n._passTokenNow)return void n._logger.info("Token was recently passed");n._queue.length>1?(n.passToken(),n._lastToken.cleanVideoNode(!0)):n._logger.info("No other elements on queue")}},200),n._timeOuts.push(e)})},e.prototype.anyVideoOnBottom=function(){var e=this,t=0,i=!1;return this._queue.forEach(function(e){!0===e.token&&(t=e.gallery.watcher.top)}),this._queue.forEach(function(o){o.gallery.watcher.top>t&&(i=!0,e._logger.info("More video/s on bottom to play"))}),i},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var o=i(3),n=i(5),r=i(15),s=new(function(){function e(){this._logger=new o.a("[vlx_dbg]"),this.onPlay=[],this.onStop=[],this.onTrackSummaryPlay=[],this.onTrackVideoPlay=[],this.onTrackThumbnailShown=[],this.onPreviewRedirect=[],this.onPreviewClick=[],this.onPreviewLoop=[],this.hooks=[],this.galleryItems=[]}return e.prototype.reObserve=function(){this.observer=new r.a},e.prototype.addOnPlay=function(e){return this._logger.debug("Pushed new function to OnPlay"),this.onPlay.push(e),this.onPlay},e.prototype.getOnPlay=function(){return this.onPlay},e.prototype.addOnStop=function(e){return this._logger.debug("Pushed new function to OnStop"),this.onStop.push(e),this.onStop},e.prototype.getOnStop=function(){return this.onStop},e.prototype.addOnTrackSummaryPlay=function(e){return this._logger.debug("Pushed new function to onTrackSummaryPlay"),this.onTrackSummaryPlay.push(e),this.onTrackSummaryPlay},e.prototype.getOnTrackSummaryPlay=function(){return this.onTrackSummaryPlay},e.prototype.addOnTrackVideoPlay=function(e){return this._logger.debug("Pushed new function to OnTrackVideoPlay"),this.onTrackVideoPlay.push(e),this.onTrackVideoPlay},e.prototype.getOnTrackVideoPlay=function(){return this.onTrackVideoPlay},e.prototype.addOnTrackThumbnailShown=function(e){return this._logger.debug("Pushed new function to onTrackThumbnailShown"),this.onTrackThumbnailShown.push(e),this.onTrackThumbnailShown},e.prototype.getOnTrackThumbnailShown=function(){return this.onTrackThumbnailShown},e.prototype.addOnPreviewRedirect=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewRedirect.push(e),this.onPreviewRedirect},e.prototype.getOnPreviewRedirect=function(){return this.onPreviewRedirect},e.prototype.addOnPreviewClick=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewClick.push(e),this.onPreviewClick},e.prototype.getOnPreviewClick=function(){return this.onPreviewClick},e.prototype.addOnPreviewLoop=function(e){return this._logger.debug("Pushed new function to onPreviewRedirect"),this.onPreviewLoop.push(e),this.onPreviewLoop},e.prototype.getOnPreviewLoop=function(){return this.onPreviewLoop},e.prototype.cleanQueues=function(){return this._logger.debug("Forced a play/preload queue clean."),n.a.clearQueues(),!0},e.prototype.addOnLoadGalleryItem=function(e){return this._logger.debug("Pushed new function to onLoadGalleryItem"),this.hooks.push(e),this.hooks},e.prototype.getOnLoadGalleryItem=function(){return this.hooks},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var o=i(9),n=new(function(){function e(){this._publickey="",this._device="desktop",this._onLoad="(function(){})()",this._sendDelay=1e3,this._sendDebounce=5e3,this._godMode=!1,this._passiveTracking=!1}return Object.defineProperty(e.prototype,"publickey",{get:function(){return this._publickey},set:function(e){this._publickey=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"device",{get:function(){return this._device},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onLoad",{get:function(){return this._onLoad},set:function(e){this._onLoad=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"godMode",{get:function(){return this._godMode},set:function(e){this._godMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sendDelay",{get:function(){return Math.max(parseInt(this._sendDelay,10),50)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sendDebounce",{get:function(){return this._sendDebounce},set:function(e){this._sendDebounce=e},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e,t){return void 0!==this["_"+e]?("true"===t.toLowerCase()?t=!0:"false"===t.toLowerCase()&&(t=!1),this["_"+e]=t,!0):0===e.indexOf("core")&&(e=(e=e.replace("core","")).charAt(0).toLowerCase()+e.slice(1),o.a.setValue(e,t))},Object.defineProperty(e.prototype,"passiveTracking",{get:function(){return this._passiveTracking},set:function(e){this._passiveTracking=e},enumerable:!0,configurable:!0}),e}())},function(e,t,i){"use strict";var o,n;i.d(t,"a",function(){return o}),i.d(t,"b",function(){return n}),function(e){e.summaryShow="summaryShow",e.summaryStart="summaryStart",e.summaryEnd="summaryEnd",e.summaryLoop="summaryLoop",e.summaryClick="summaryClick"}(o||(o={})),function(e){e.pro69high="pro69high",e.pro69="pro69",e.galleryPro69="galleryPro69",e.pro="pro",e.galleryShort="galleryShort"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var o=i(12),n=new(function(){function e(){this._logLevel=o.a.nope,this._xhrMaxRetry=5,this._xhrRetryTime=1e3,this._xhrTimeout=1e3}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xhrMaxRetry",{get:function(){return this._xhrMaxRetry},set:function(e){this._xhrMaxRetry=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xhrTimeout",{get:function(){return this._xhrTimeout},set:function(e){this._xhrTimeout=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xhrRetryTime",{get:function(){return this._xhrRetryTime},set:function(e){this._xhrRetryTime=e},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e,t){return void 0!==this["_"+e]&&("true"===t.toLowerCase()?t=!0:"false"===t.toLowerCase()&&(t=!1),this["_"+e]=t,!0)},e}())},function(e,t,i){"use strict";function o(e){void 0===e&&(e=4);for(var t=Math.pow(16,Math.min(e,8)-1),i=Math.pow(16,Math.min(e,8))-1,n=(Math.floor(Math.random()*(i-t+1))+t).toString(16);n.length<e;)n+=o(e-8);return n}function n(){var e=o;return e(8)+"-"+e()+"-"+e()+"-"+e()+"-"+e(12)}function r(e){if(e.dataset)return e.dataset;for(var t=e.attributes,i=t.length,o=function(e){return e.charAt(1).toUpperCase()},n={},r=0;r<i;r++){var s=t[r];if(s&&s.name&&/^data-\w[\w\-]*$/.test(s.name)){var a=s.value;n[s.name.substr(5).replace(/-./g,o)]=a}}return n}i.d(t,"a",function(){return o}),i.d(t,"b",function(){return n}),i.d(t,"c",function(){return r})},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var o=i(4),n=i(3),r=i(13),s=new(function(){function e(){this._isLocalStorageAvailable=!0,this._logger=new n.a("[LS]");try{var e="__storage_test__";localStorage.setItem(e,e),localStorage.removeItem(e)}catch(e){this._isLocalStorageAvailable=!1,this._logger.warn("localStorage is not available")}}return e.prototype.get=function(e,t){if(!this._isLocalStorageAvailable)return this._logger.warn("localStorage is not available"),!1;this._logger.info("Getting "+e+" from local storage");var i=localStorage.getItem(e);if(i)switch(t){case o.a.base64:try{i=atob(i)||!1}catch(e){i=!1}break;case o.a.json:try{i=JSON.parse(i)||!1}catch(e){i=!1}break;case o.a.plain:}return i},e.prototype.set=function(e,t,i){if(this._isLocalStorageAvailable){var n;switch(this._logger.info("Saving "+e+" to local storage"),i){case o.a.base64:try{n=btoa(t.toString())}catch(o){throw this._logger.error("Failed to convert to BASE64 (name, element, format)",e,t,i),new r.a("Can't convert from "+typeof t+" to base64")}break;case o.a.json:try{n=JSON.stringify(t)}catch(o){throw this._logger.error("Failed to convert to JSON (name, element, format)",e,t,i),new r.a("Can't convert from "+typeof t+" to base64")}break;case o.a.plain:n=t.toString()}try{localStorage.setItem(e,n)}catch(e){throw this._logger.error("Can't save to local storage. Maybe it's full",e),new r.b("Can't save to local storage. Maybe it's full")}return e}this._logger.warn("localStorage is not available")},e.prototype.remove=function(e){this._isLocalStorageAvailable?(this._logger.info("Removing "+e+" from local storage"),localStorage.removeItem(e)):this._logger.warn("localStorage is not available")},e}())},function(e,t,i){"use strict";var o;i.d(t,"a",function(){return o}),function(e){e.nope="nope",e.info="info",e.develop="develop"}(o||(o={}))},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return n});var o=function(){return function(e){this.message=e}}(),n=function(){return function(e){this.message=e}}()},function(e,t,i){"use strict";var o;i.d(t,"a",function(){return o}),function(e){e[e.outOfAB=0]="outOfAB",e[e.galleryActive=1]="galleryActive",e[e.galleryPassive=2]="galleryPassive"}(o||(o={}))},function(e,t,i){"use strict";var o,n=i(0),r=i(6),s=i(9),a=i(3),l=(i(18),function(){function e(e,t){this._LOGGER=new a.a("[XHR]"),void 0!==e&&(s.a.xhrMaxRetry=e,this._LOGGER.debug("Maximum number of retry set to "+e)),void 0!==t&&(s.a.xhrTimeout=t,this._LOGGER.debug("Timeout set to "+t))}return e.prototype.get=function(e,t,i){return this._call("GET",e,t,null,i)},e.prototype.post=function(e,t,i,o){return this._call("POST",e,t,i,o)},e.prototype._call=function(t,i,o,n,r){var a=this;return new Promise(function(l,c){a._LOGGER.info("Making Xhr "+t+" to "+i);var d=new XMLHttpRequest,u=a._stringifyQueryObject(o)||"",h=0;d.open(t,i+"?"+u,!0),r=Object.assign({Accept:"application/json, text/javascript, */*","Content-type":"application/x-www-form-urlencoded"},r),Object.keys(r).forEach(function(e){d.setRequestHeader(e,r[e])}),d.onreadystatechange=function(){4===d.readyState&&(e._isOk(d.status)?(a._LOGGER.info("Xhr "+t+" to "+i+" successful with code "+d.status),l(d.response)):e._isTimeout(d.status)?(a._LOGGER.info("Xhr "+t+" to "+i+" timed out with code "+d.status),h<s.a.xhrMaxRetry?(h+=1,setTimeout(function(){d.open("${method}",i+"?"+u,!0),d.send(null)},s.a.xhrRetryTime*h)):(a._LOGGER.warn("Xhr "+t+" to "+i+" failed with code "+d.status),c(d.status))):(a._LOGGER.warn("Xhr "+t+" to "+i+" failed with code "+d.status),c(d.status)))},d.send(a._stringifyQueryObject(n))})},e._isOk=function(e){return e>0&&e<299},e._isTimeout=function(e){return 408===e||503===e||504===e},e.prototype._stringifyQueryObject=function(e){void 0===e&&(e={});var t=null;return e&&Object.keys(e).length&&(t=Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")),t},e}()),c=i(2),d=new(function(){function e(){this._logger=new a.a("[vlx_dbg]")}return e.prototype.validateQuery=function(e){try{return document.querySelector(e),!0}catch(t){this._logger.warn("Invalid selector query found! "+e)}return this._logger.warn("Invalid selector query found! "+e),!1},e.prototype.exctractIdAttribute=function(e){var t;return e.dataset&&e.dataset.vilynxId?t=e.dataset.vilynxId:e.attributes.getNamedItem("vilynx-id")?t=e.attributes.getNamedItem("vilynx-id").value:n.a.idattribute&&e.attributes.getNamedItem(n.a.idattribute)&&(t=e.attributes.getNamedItem(n.a.idattribute).value),t},e.prototype.findElementWithBg=function(e){var t,i=n.a.bgimageselector,o=!1;return(t=Array.prototype.slice.call(e.querySelectorAll(i))).push(e),t.length>0&&t.forEach(function(e){(""!==e.style.backgroundImage&&c.a.bgImageRegex.test(e.style.backgroundImage)||e.getAttribute(n.a.scandivwbgattr))&&(n.a.imgignore&&e.matches(n.a.imgignore)||(o=!0,e.classList.add("vilynx_img")))}),o},e}()),u=i(1),h=i(4),p=i(13),f=i(10),y=new(function(){function e(){this._isSessionStorageAvailable=!0,this._logger=new a.a("[SS]");try{var e="__storage_test__";Object(f.b)(),sessionStorage.setItem(e,e),sessionStorage.removeItem(e)}catch(e){this._isSessionStorageAvailable=!1,this._logger.warn("sessionStorage is not available")}}return e.prototype.get=function(e,t){if(!this._isSessionStorageAvailable)return this._logger.warn("sessionStorage is not available"),!1;this._logger.info("Getting "+e+" from session storage");var i=sessionStorage.getItem(e);if(i)switch(t){case h.a.base64:try{i=atob(i)||!1}catch(e){i=!1}break;case h.a.json:try{i=JSON.parse(i)||!1}catch(e){i=!1}break;case h.a.plain:}return i},e.prototype.set=function(e,t,i){if(this._isSessionStorageAvailable){var o;switch(this._logger.info("Saving "+e+" to session storage"),i){case h.a.base64:try{o=btoa(t.toString())}catch(o){throw this._logger.error("Failed to convert to BASE64 (name, element, format)",e,t,i),new p.a("Can't convert from "+typeof t+" to base64")}break;case h.a.json:try{o=JSON.stringify(t)}catch(o){throw this._logger.error("Failed to convert to JSON (name, element, format)",e,t,i),new p.a("Can't convert from "+typeof t+" to base64")}break;case h.a.plain:o=t.toString()}try{sessionStorage.setItem(e,o)}catch(e){throw this._logger.error("Can't save to session storage. Maybe it's full",e),new p.b("Can't save to session storage. Maybe it's full")}return e}this._logger.warn("sessionStorage is not available")},e.prototype.remove=function(e){this._isSessionStorageAvailable?(this._logger.info("Removing "+e+" from session storage"),sessionStorage.removeItem(e)):this._logger.warn("sessionStorage is not available")},e}()),v=i(8),_=i(16),m=function(){function e(){this._logger=new a.a("[gallery_Analytics]"),this._dagda=_.a.instance(),this.summaryPlayTimeOut=n.a.summaryplaytimeout,n.a.optimizely&&this.initOptimizely()}return e.prototype.trackLoop=function(e){n.a.analytics&&this._dagdaTrackSummaryLoop(e)},e.prototype.trackSummaryPlay=function(e){this._summaryPlays+=1,n.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","summary_play"]),r.a.getOnTrackSummaryPlay().forEach(function(t){t(e.galleryData.domObject)}),n.a.analytics&&this._dagdaTrackSummaryStart(e)},e.prototype.trackVideoPlay=function(e,t){void 0!==e&&n.a.analytics&&this._dagdaTrackSummaryClick(e,t),n.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","summary_click"]),r.a.getOnTrackVideoPlay().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.trackThumbnailShown=function(e){n.a.optimizely&&window.optimizely&&window.optimizely.push(["trackEvent","thumbnail_shown"]),r.a.getOnTrackThumbnailShown().forEach(function(t){t(e.galleryData.domObject)})},e.prototype.trackSummaryEnd=function(e){n.a.analytics&&this._dagdaTrackSummaryEnd(e)},e.prototype.saveEvent=function(e,t,i){this._saved=y.get("vilynx_gallery_mpSavedEvents",h.a.json)||{},this._saved[e+t]={eventName:t,options:i},y.set("vilynx_gallery_mpSavedEvents",this._saved,h.a.json)},e.prototype.removeEvent=function(e){this._saved=y.get("vilynx_gallery_mpSavedEvents",h.a.json)||{},void 0!==this._saved[e]&&delete this._saved[e],y.set("vilynx_gallery_mpSavedEvents",this._saved,h.a.json)},e.prototype.sendSaved=function(){var e=y.get("vilynx_gallery_mpSavedEvents",h.a.json)||{};c.a.savedEventsSended=!0,Object.keys(e).forEach(function(t){window.mixpanel.vilynx.track(e[t]).eventName.replace("-"," "),e[t].options}),y.set("vilynx_gallery_mpSavedEvents",this._saved,h.a.json)},e.prototype.trackCb=function(e,t){this.removeEvent(e+t)},e.prototype.getCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()},e.prototype.initOptimizely=function(){window.optimizely=window.optimizely||[]},e.prototype._dagdaTrackSummaryLoop=function(e){this._logger.info("dagda summary loop"),this._dagda.galleryTrack({currentTime:this._getCurrentTime(e),eventType:v.a.summaryLoop,isRedirect:!1,passiveTracking:n.a.passivetracking,previewHash:e.galleryData.vilynxData.hash,resolution:this._getResolution(e)})},e.prototype._dagdaTrackSummaryEnd=function(e){this._logger.info("dagda summary end"),this._dagda.galleryTrack({currentTime:this._getTotalTime(e),eventType:v.a.summaryEnd,isRedirect:!1,passiveTracking:n.a.passivetracking,previewHash:e.galleryData.vilynxData.hash,resolution:this._getResolution(e)})},e.prototype._dagdaTrackSummaryStart=function(e){this._logger.info("dagda summary start"),this._dagda.galleryTrack({currentTime:this._getCurrentTime(e),eventType:v.a.summaryStart,isRedirect:!1,passiveTracking:n.a.passivetracking,previewHash:e.galleryData.vilynxData.hash,resolution:this._getResolution(e)})},e.prototype._dagdaTrackSummaryClick=function(e,t){this._logger.info("dagda summary click"),this._dagda.galleryTrack({currentTime:this._getCurrentTime(e),eventType:v.a.summaryClick,isRedirect:t,passiveTracking:n.a.passivetracking,previewHash:e.galleryData.vilynxData.hash,resolution:this._getResolution(e)})},e.prototype._dagdaThumbnailShown=function(e){this._logger.info("dagda ThumbnailShown"),this._dagda.galleryTrack({currentTime:0,eventType:v.a.summaryShow,isRedirect:!0,passiveTracking:n.a.passivetracking,previewHash:e.galleryData.vilynxData.hash,resolution:this._getResolution(e)})},e.prototype._getCurrentTime=function(e){return e.videoNode&&Math.round(e.videoNode.currentTime)||0},e.prototype._getTotalTime=function(e){return e.videoNode&&void 0!==e.videoNode.currentTime&&void 0!==e.videoNode.countLoops&&void 0!==e.config.duration?Math.round(e.videoNode.currentTime+e.videoNode.countLoops*e.config.duration):0},e.prototype._getResolution=function(e){return e.videoNode&&e.videoNode.resolution||v.b.galleryPro69},e}(),g=function(){return function(){}}(),b=new(function(){function e(){var e=this;this.logger=new a.a("[vlx_dbg]");var t=setInterval(function(){c.a.loaded&&(e.logger.info("ScrollMonitor initialized"),window.scrollMonitor=e.factory(),clearInterval(t))},20)}return e.prototype.factory=function(){this.version=1.2;var e,t,i,o,r,s,a="undefined"==typeof window,l=!a,c=function(){return a?0:window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},d=function(){return a?0:window.pageXOffset>=0?0:window.pageXOffset||document.documentElement&&document.documentElement.scrollWidth||document.body.scrollWidth},u=new g,h=[],p="visibilityChange",f="enterViewport",y="fullyEnterViewport",v="exitViewport",_="partiallyExitViewport",m="locationChange",b="stateChange",w="canPreload",O="canUnload",E="thresholdEnterViewport",x="thresholdExitViewport",N=[p,f,y,v,_,m,b,w,O,E,x],P={top:0,bottom:0},D=function(){return a?0:window.innerHeight||document.documentElement.clientHeight},A=function(){return a?0:window.innerWidth||document.documentElement.clientWidth},S=function(){return a?0:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)},L=function(){return a?0:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)};function k(){if(u.viewportTop=c(),u.viewportBottom=u.viewportTop+u.viewportHeight,u.documentHeight=S(),u.viewportLeft=d(),u.viewportRight=u.viewportLeft+u.viewportWidth,u.documentWidth=L(),u.documentHeight!==e||u.documentWidth!==t){for(o=h.length;o--;)h[o].recalculateLocation();e=u.documentHeight,t=u.documentWidth}}function I(){u.viewportHeight=D(),u.viewportWidth=A(),k(),j()}function T(){clearTimeout(r),r=setTimeout(I,100)}function j(){for(s=h.length;s--;)h[s].recalculateLocation(),h[s].update();for(s=h.length;s--;)h[s].triggerCallbacks()}function M(e,t,o){var n=this;this.watchItem=e,this.overFlowParent=o,this.offsets=t?t===+t?{top:t,bottom:t}:{bottom:t.bottom||P.bottom,top:t.top||P.top}:P,this.callbacks={};for(var r=0,s=N.length;r<s;r++)n.callbacks[N[r]]=[];this.locked=!1;var a,l,c,d,h,g,D,A,S=!0;function L(e){if(0!==e.length)for(D=e.length;D--;)(A=e[D]).callback.call(n,i),A.isOne&&e.splice(D,1)}this.triggerCallbacks=function(){switch(this.isInViewport&&!a&&L(this.callbacks[f]),this.isFullyInViewport&&!l&&L(this.callbacks[y]),this.isCanPreload&&!h&&L(this.callbacks[w]),this.isCanUnload&&!S&&L(this.callbacks[O]),this.isThresholdInViewport&&!g&&L(this.callbacks[E]),!this.isThresholdInViewport&&g&&L(this.callbacks[x]),this.isAboveViewport!==c&&this.isBelowViewport!==d&&(L(this.callbacks[p]),l||this.isFullyInViewport||(L(this.callbacks[y]),L(this.callbacks[_])),a||this.isInViewport||(L(this.callbacks[f]),L(this.callbacks[v]))),!this.isFullyInViewport&&l&&L(this.callbacks[_]),!this.isInViewport&&a&&L(this.callbacks[v]),this.isInViewport!==a&&L(this.callbacks[p]),!0){case a!==this.isInViewport:case l!==this.isFullyInViewport:case c!==this.isAboveViewport:case d!==this.isBelowViewport:L(this.callbacks[b])}a=this.isInViewport,l=this.isFullyInViewport,c=this.isAboveViewport,d=this.isBelowViewport,h=this.isCanPreload,S=this.isCanUnload,g=this.isThresholdInViewport},this.recalculateLocation=function(){if(!this.locked&&this.watchItem&&(this.watchItem.ownerDocument!==document||document.body.contains(this.watchItem))){var e=this.top,t=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;"none"===i&&(this.watchItem.style.display="");var o=this.watchItem.getBoundingClientRect(),n=void 0;this.parentTop=0,this.parentBottom=1/0,this.parentLeft=0,this.parentRight=1/0,this.overFlowParent&&(n=this.overFlowParent.getBoundingClientRect(),this.parentTop=Math.ceil(n.top)+u.viewportTop,this.parentBottom=Math.floor(n.bottom)+u.viewportTop,this.parentLeft=Math.ceil(n.left)+u.viewportLeft,this.parentRight=Math.floor(n.right)+u.viewportLeft),this.top=Math.ceil(o.top)+u.viewportTop,this.bottom=Math.floor(o.bottom)+u.viewportTop,this.left=Math.ceil(o.left)+u.viewportLeft,this.right=Math.floor(o.right)+u.viewportLeft,"none"===i&&(this.watchItem.style.display=i)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=u.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom,this.left=this.watchItem.left,this.right=this.watchItem.right,this.overFlowParent&&(this.parentTop=this.overFlowParent.top,this.parentBottom=this.overFlowParent.bottom,this.parentLeft=this.overFlowParent.left,this.parentRight=this.overFlowParent.right));var r=1-(this.bottom-this.top);this.top-=Math.max(r,this.offsets.top),this.bottom+=Math.max(r,this.offsets.bottom),this.height=this.bottom-this.top,this.width=this.right-this.left,void 0===e&&void 0===t||this.top===e&&this.bottom===t||L(this.callbacks[m])}},this.recalculateLocation(),this.update(),a=this.isInViewport,l=this.isFullyInViewport,c=this.isAboveViewport,d=this.isBelowViewport}u.viewportTop=null,u.viewportBottom=null,u.documentHeight=null,u.viewportHeight=D(),u.viewportWidth=A(),M.prototype={on:function(e,t,o){switch(!0){case e===p&&!this.isInViewport&&this.isAboveViewport:case e===f&&this.isInViewport:case e===y&&this.isFullyInViewport:case e===v&&this.isAboveViewport&&!this.isInViewport:case e===_&&this.isAboveViewport:case e===w&&this.isCanPreload:case e===O&&this.isCanUnload:if(t.call(this,i),o)return}if(!this.callbacks[e])throw new Error("Tried to add a scroll monitor listener of type "+e+". Your options are: "+N.join(", "));this.callbacks[e].push({callback:t,isOne:o||!1})},off:function(e,t){if(!this.callbacks[e])throw new Error("Tried to remove a scroll monitor listener of type "+e+". Your options are: "+N.join(", "));for(var i=0;i<this.callbacks[e].length;i++)if(this.callbacks[e][i]===t){this.callbacks[e].splice(i,1);break}},one:function(e,t){this.on(e,t,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height,this.width=this.right-this.left},update:function(){var e=Math.max(this.parentTop,u.viewportTop),t=Math.min(this.parentBottom,u.viewportBottom),i=Math.max(this.parentLeft,u.viewportLeft),o=Math.min(this.parentRight,u.viewportRight);this.isAboveViewport=this.top<e,this.isBelowViewport=this.bottom>t,this.overLeftDistance=this.isOverLeftViewport?i-this.left:0,this.overRightDistance=this.isOverRightViewport?this.right-o:0,this.horizontalInViewport=Math.max((this.width-(this.overLeftDistance+this.overRightDistance))/this.width,0),this.isOverLeftViewport=this.left<i,this.isOverRightViewport=this.right>o,this.isValid=this.bottom!==u.viewportTop+this.offsets.top||this.top!==u.viewportTop-this.offsets.top,this.isInViewport=this.isValid&&this.top<=t&&this.bottom>=e&&this.left<=o&&this.right>=i,this.isFullyInViewport=this.isValid&&(!this.isAboveViewport&&!this.isBelowViewport&&!this.isOverLeftViewport&&!this.isOverRightViewport||!this.isAboveViewport&&!this.isBelowViewport&&this.isOverLeftViewport&&this.isOverRightViewport||this.isAboveViewport&&this.isBelowViewport),this.isThresholdInViewport=this.isValid&&(!this.isAboveViewport&&!this.isBelowViewport||this.isAboveViewport&&this.isBelowViewport)&&100*this.horizontalInViewport>n.a.horizontalthreshold,this.isCanPreload=this.top-n.a.preloadoffset<=t&&this.bottom+n.a.preloadoffset>=e,this.isCanUnload=!this.isCanPreload},destroy:function(){var e=h.indexOf(this);h.splice(e,1);for(var t=0,i=N.length;t<i;t++)this.callbacks[N[t]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var V=function(e){return function(t,i){this.on.call(this,e,t,i)}},R=0,q=N.length;R<q;R++){var z=N[R];M.prototype[z]=V(z)}if(l)try{k()}catch(e){try{window.$(k)}catch(e){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}function B(e){i=e,k(),j()}if(l){if(window.addEventListener){var W=!1;window.addEventListener("scroll",function(e){W||window.requestAnimationFrame(function(){B(e),W=!1}),W=!0},!0),window.addEventListener("resize",T)}else window.attachEvent("onscroll",B),window.attachEvent("onresize",T);n.a.proactiveload&&setInterval(function(){u.update(),B()},200)}return u.beget=u.create=function(e,t,i){"string"==typeof e?e=document.querySelector(e):e&&e.length>0&&(e=e[0]);var o=new M(e,t,i);return h.push(o),o.update(),o},u.update=function(){i=null,k(),j()},u.recalculateLocations=function(){u.documentHeight=0,u.update()},u.version=this.version,u},e.prototype.reFactory=function(){this.logger.warn("ScrollMonitor create error, reFactory method called"),window.scrollMonitor=this.factory()},e}()),w=i(5),O=function(){function e(){}return Object.defineProperty(e.prototype,"webm",{get:function(){return this._webm},set:function(e){this._webm=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mp4",{get:function(){return this._mp4},set:function(e){this._mp4=e},enumerable:!0,configurable:!0}),e}(),E=function(){function e(e,t){this._is169=e,this._posterUrl=t,this._sources=new O}return Object.defineProperty(e.prototype,"sources",{get:function(){return this._sources},set:function(e){this._sources=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is169",{get:function(){return this._is169},set:function(e){this._is169=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"posterUrl",{get:function(){return this._posterUrl},set:function(e){this._posterUrl=e},enumerable:!0,configurable:!0}),e}(),x=function(){function e(e,t,i){this._url=e,this._mime=t,this._resolution=i}return Object.defineProperty(e.prototype,"mime",{get:function(){return this._mime},set:function(e){this._mime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._resolution=e},enumerable:!0,configurable:!0}),e}(),N=function(){function e(){}return Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!0,configurable:!0}),e}(),P=new(function(){function e(){this._logger=new a.a("[vlx_dbg]")}return e.prototype.getVideoUrl=function(e,t,i){var o,r,s,a,l,d,h,p=e.timestamp[0],f=c.a.serverUrl.slice(4),y=n.a.publickey;return h=n.a.directurl?"direct/"+y+"/"+e.externalId:e.hash,n.a.reduceresolution&&(t>640?t=639:t>360&&(t=359)),i?u.a.isMobile&&n.a.forcesmallvideo?(o="//public."+f+"/"+h+"/gallery.pro69.viwindow",l="//public."+f+"/"+h+"/pro69.viwindow0.jpg",r=v.b.galleryPro69):t>640?(o="//public."+f+"/"+h+"/pro69high.viwindow",l="//public."+f+"/"+h+"/pro69high.viwindow0.jpg",r=v.b.pro69high):t>360?(o="//public."+f+"/"+h+"/pro69.viwindow",l="//public."+f+"/"+h+"/pro69.viwindow0.jpg",r=v.b.pro69):(o="//public."+f+"/"+h+"/gallery.pro69.viwindow",l="//public."+f+"/"+h+"/pro69.viwindow0.jpg",r=v.b.galleryPro69):u.a.isMobile&&n.a.forcesmallvideo?(o="//public."+f+"/"+h+"/gallery.short.viwindow",l="//public."+f+"/"+h+"/gallery.short.viwindow0.jpg",r=v.b.galleryShort):t>360?(o="//public."+f+"/"+h+"/pro.viwindow",l="//public."+f+"/"+h+"/short.viwindow0.jpg",r=v.b.pro):(o="//public."+f+"/"+h+"/gallery.short.viwindow",l="//public."+f+"/"+h+"/gallery.short.viwindow0.jpg",r=v.b.galleryShort),s=o+".mp4",a=o+".webm",n.a.directurl||(s+="?t="+p+"&owner="+y,a+="?t="+p+"&owner="+y),(d=new E(i,l)).sources.mp4=new x(s,"video/mp4",r),d.sources.webm=new x(a,"video/webm",r),d},e.prototype.extractBGImageFromNode=function(e){return e.style.backgroundImage.slice(4,-1).replace(/["|']/g,"")},e.prototype.createCopyImage=function(e){var t=document.createElement("img");return t.className="vilynx_wrapperImg",n.a.scandivwbgattr&&e.getAttribute(n.a.scandivwbgattr)?t.src=e.getAttribute(n.a.scandivwbgattr):""!==e.style.backgroundImage?t.src=this.extractBGImageFromNode(e):e instanceof HTMLImageElement&&e.src&&e.src.length>0&&(t.src=e.src),t},e.prototype.findActiveImage=function(e){var t=null;return[].forEach.call(e,function(e){0!==e.offsetWidth&&0!==e.offsetHeight&&(!t||t.offsetWidth<e.offsetWidth)&&(t=e)}),t},e.prototype.getTargetImgSize=function(e){var t=e.parentNode.getBoundingClientRect(),i=t.height,o=t.width,n=e.getBoundingClientRect(),r=new N;return r.width=n.width,r.height=n.height,0!==i&&0!==o&&("inline"!==window.getComputedStyle(e.parentNode).display&&i<r.height&&(r.height=i),o<r.width&&(r.width=o)),r},e.prototype.showNodes=function(e){var t=this,i=0;if(e.constructor!==Array)throw new Error("nodes must be an array of dom nodes!");return e.forEach(function(e){e&&(e.classList?(i++,e.classList.remove("vilynx_fading")):(t._logger.error(e),t._logger.error("Node is not a valid dom node, does not have classList")))}),i},e.prototype.hideNodes=function(e){var t=this,i=0;if(e.constructor!==Array)throw new Error("nodes must be an array of dom nodes!");return e.forEach(function(e){e&&(e.classList?(i++,e.classList.add("vilynx_fading")):(t._logger.error(e),t._logger.error("Node is not a valid dom node, does not have classList")))}),i},e.prototype.isNodeVilynxHidden=function(e){return e.classList.contains("vilynx_fading")},e.prototype.addLeftCssToNode=function(e,t){var i=parseFloat(window.getComputedStyle(e).left),o=t;return i&&(o+=i),e.style.left=0===o?"":o+"px",o},e.prototype.elementNeedsRelative=function(e){if("static"===window.getComputedStyle(e).position){var t=this.querySelectorInclusive(e,".vilynx_mainImg"),i=e.parentNode;if(i){var o=i.getBoundingClientRect(),n=window.getComputedStyle(i),r=e.getBoundingClientRect();if(r.top!==o.top||r.left!==o.left){var s=t.getBoundingClientRect();if(s.top!==o.top||s.left!==o.left||"relative"!==n.position||-1!==n.overflow.indexOf("scroll")||-1!==n.overflow.indexOf("auto"))return!0}}}return!1},e.prototype.getImageCandidates=function(e,t){var i=Array.prototype.slice.call(e.querySelectorAll(t)),o=[];return e.classList.contains("vilynx_img")&&i.push(e),n.a.imgignore?i.forEach(function(e){e.matches(n.a.imgignore)||o.push(e)}):o=i,o},e.prototype.querySelectorInclusive=function(e,t){return e.matches(t)?e:e.querySelector(t)},e.prototype.extractAttributeChanges=function(e,t){var i;return i={additions:[],removals:[]},t.forEach(function(t){if("attributes"===t.type){var o=t.attributeName,n=t.oldValue,r=e.getAttribute(o),s=o.replace("data-",""),a=!1,l=!1;0===s.indexOf("vilynx-")&&(s=s.replace("vilynx-","vilynx_"),n&&"false"!==n&&(a=!0),r&&"false"!==r&&(l=!0),a!==l&&(l?i.additions.push(s):i.removals.push(s)))}}),i},e.prototype.getArrayChanges=function(e,t){return{additions:t.slice().filter(function(t){return-1===e.indexOf(t)}),removals:e.slice().filter(function(e){return-1===t.indexOf(e)})}},e}()),D=new(function(){function e(){this._logger=new a.a("[vlx_dbg]"),this._audioPolicyActive=u.a.isWebkit,this._audioSrcBase64="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV"}return e.prototype.doTestSound=function(e,t){var i=this;if(this._audioPolicyActive){var o=document.createElement("audio");o.src="data:audio/mp3;base64,"+this._audioSrcBase64,o.play().then(function(){i._audioPolicyActive=!1,t()}).catch(function(){i._logger.warn("Audio policy is still active. Avoiding some redirect functions."),e()})}else t()},e}()),A=function(){return function(){}}(),S=new(function(){function e(){this._maxElements=n.a.iemaxelements,this.queue=[],this.elementsDownloaded=0,this.logger=new a.a("[vlx_dbg]")}return e.prototype.addElement=function(e){-1===this.queue.indexOf(e)&&this.queue.push(e)},e.prototype.removeElement=function(e){var t=this.queue.indexOf(e);-1!==t&&this.queue.splice(t,1)},e.prototype.markElementRemoved=function(){this.elementsDownloaded--,this.elementsDownloaded===this._maxElements-1&&(this.logger.info("Elements have been removed. There is space enough in download queue to keep downloading."),this.start())},e.prototype.start=function(){var e=this;this.downloadInterval||(this.downloadInterval=setInterval(function(){e.elementsDownloaded>=e._maxElements?(clearInterval(e.downloadInterval),e.downloadInterval=null,e.logger.warn("Download queue filled. Stop downloading.")):e.downloadElement()},100))},e.prototype.downloadElement=function(){if(this.queue.length){var e=this.queue.shift();e.watcher.isInViewport?(e.attachVideoNode(),this.elementsDownloaded++):this.downloadElement()}else this.downloadInterval&&(clearInterval(this.downloadInterval),this.downloadInterval=null)},e}()),L=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),k=function(e){function t(t,i){var o=e.call(this,"["+i+":"+t+"]")||this;return o._debugId=t,o}return L(t,e),Object.defineProperty(t.prototype,"debugId",{get:function(){return this._debugId},set:function(e){this._debugId=e},enumerable:!0,configurable:!0}),t}(a.a),I=function(){function e(){this._browser=u.a,this._externalfading=!1,this._browser=u.a,this._redirect=n.a.redirect&&!this._browser.isMobile,this._redirecttext=n.a.redirecttext,this._redirectafter=n.a.redirectafter,this._redirectautoplay=n.a.redirectautoplay,this._ctatext=n.a.ctatext,this._hidectaicon=n.a.hidectaicon,this._redirectwithclick=n.a.redirectwithclick,this._redirectwithvid=n.a.redirectwithvid,this._fadeinadvance=n.a.fadeinadvance,this._mobilecta=n.a.mobilecta,this._mobilectaloopcount=n.a.mobilectaloopcount,this._audiopolicycta=n.a.audiopolicycta,this._autoplay=this._browser.isMobile&&!n.a.taptoplay||!this._browser.isMobile&&n.a.autoplay,this._autoplayonce=n.a.autoplayonce,this._stopnoimage=n.a.stopnoimage,this._pauseonhover=n.a.pauseonhover,this._pausehoveronce=n.a.pausehoveronce,this._audio=n.a.audio,this._audioonce=n.a.audioonce,this._audiohover=n.a.audiohover,this._taptoplay=n.a.taptoplay,this._topviewportoffset=n.a.topviewportoffset,this._bottomviewportoffset=n.a.bottomviewportoffset,this._noimage=n.a.noimage,this._externalfading=!1,this._isDisabled=!1,this._duration=0,this._isVertical=!1,this._videoRatio=0}return Object.defineProperty(e.prototype,"videoRatio",{get:function(){return this._videoRatio},set:function(e){this._videoRatio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},set:function(e){this._duration=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisabled",{get:function(){return this._isDisabled},set:function(e){this._isDisabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalfading",{get:function(){return this._externalfading},set:function(e){this._externalfading=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noimage",{get:function(){return this._noimage},set:function(e){this._noimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taptoplay",{get:function(){return this._taptoplay},set:function(e){this._taptoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiohover",{get:function(){return this._audiohover},set:function(e){this._audiohover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioonce",{get:function(){return this._audioonce},set:function(e){this._audioonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audio",{get:function(){return this._audio},set:function(e){this._audio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pausehoveronce",{get:function(){return this._pausehoveronce},set:function(e){this._pausehoveronce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pauseonhover",{get:function(){return this._pauseonhover},set:function(e){this._pauseonhover=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopnoimage",{get:function(){return this._stopnoimage},set:function(e){this._stopnoimage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplayonce",{get:function(){return this._autoplayonce},set:function(e){this._autoplayonce=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(e){this._autoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audiopolicycta",{get:function(){return this._audiopolicycta},set:function(e){this._audiopolicycta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilectaloopcount",{get:function(){return this._mobilectaloopcount},set:function(e){this._mobilectaloopcount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobilecta",{get:function(){return this._mobilecta},set:function(e){this._mobilecta=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fadeinadvance",{get:function(){return this._fadeinadvance},set:function(e){this._fadeinadvance=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithvid",{get:function(){return this._redirectwithvid},set:function(e){this._redirectwithvid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectwithclick",{get:function(){return this._redirectwithclick},set:function(e){this._redirectwithclick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidectaicon",{get:function(){return this._hidectaicon},set:function(e){this._hidectaicon=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ctatext",{get:function(){return this._ctatext},set:function(e){this._ctatext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectautoplay",{get:function(){return this._redirectautoplay},set:function(e){this._redirectautoplay=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirectafter",{get:function(){return this._redirectafter},set:function(e){this._redirectafter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirecttext",{get:function(){return this._redirecttext},set:function(e){this._redirecttext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redirect",{get:function(){return this._redirect},set:function(e){this._redirect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStopped",{get:function(){return this._isStopped},set:function(e){this._isStopped=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topviewportoffset",{get:function(){return this._topviewportoffset},set:function(e){this._topviewportoffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomviewportoffset",{get:function(){return this._bottomviewportoffset},set:function(e){this._bottomviewportoffset=e},enumerable:!0,configurable:!0}),e}(),T=I,j=(new I,function(){function e(e){var t=this;this._onVideoEnd=[],this._onVideoLoop=[],this._onVideoCancel=[],this._redirect=null,this._deleted=!1,this._hasSentPlayEvent=!1,this.config=new T,this._debugId=e.vilynxData.hash.substr(0,7),this.logger=new k(this._debugId,"gallery_item"),e.domObject.classList.add("vilynx"),this.galleryData=e,n.a.debug&&e.domObject.setAttribute("vlx_dbg",String(this._debugId)),n.a.ongalleryload&&r.a.getOnLoadGalleryItem().length>0&&r.a.getOnLoadGalleryItem().forEach(function(e){e(t.galleryData.domObject)});try{this.loadConfig()}catch(e){this.logger.error("Exception raised while loading the item config. Aborting item execution. Stack trace: "),this.logger.error(e)}}return e.prototype.dealloc=function(){var e=this;this._redirect&&this._redirect.dealloc(),this._redirect=void 0,this.watcher.destroy(),this.logger=void 0,this.config=void 0,this._analytics=void 0,this._debugId=void 0,this.videoNode=void 0,Object.keys(this.watcher).forEach(function(t){e.watcher[t]=void 0}),this.watcher=void 0},e.prototype.loadConfig=function(){var e=this,t=this.galleryData.domObject;return t?([].forEach.call(t.classList,function(t){var i=t.substr(7);void 0===e.config[i]?e.logger.warn("Gallery item Config register not found: "+i):(e.config[i]=!0,e.logger.debug("Gallery item Config element loaded: "+i))}),Object.keys(t.attributes).forEach(function(i){var o=t.attributes[i];if(o){var n=o.name.replace("data-","");if(0===n.indexOf("vilynx-")){var r=n.replace("vilynx-","");void 0!==e.config[r]?("boolean"==typeof e.config[r]?e.config[r]=!("false"===o.value||""===o.value):"number"==typeof e.config[r]?e.config[r]=parseInt(o.value,10):e.config[r]=o.value,e.logger.debug("Gallery item Config element loaded: "+r+"; value: "+o.value)):e.logger.warn("Gallery item Config attribute not found: "+r+";")}}}),!0):(this.logger.warn("Element not detected"),!1)},e.prototype.generateVideoUrl=function(){var e,t,i=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),o=P.findActiveImage(i);o?(t=(e=o.clientWidth)/o.clientHeight>=1.5,this.videoData=P.getVideoUrl(this.galleryData.vilynxData,e,t),this.logger.debug("Video url "+this.videoData.sources.mp4.url)):this.logger.error("Cant generate video url. No valid image found")},e.prototype.getCountLoops=function(){var e=this.videoNode.countLoops;return 1e3*this.videoNode.currentTime<300&&this.videoNode.throttle&&(e=this.videoNode.countLoops+1,this.logger.info("getCountLoops function fired before 'timeupdate' event. Adding 1 to countLoops")),e},Object.defineProperty(e.prototype,"hasSentPlayEvent",{get:function(){return this._hasSentPlayEvent},set:function(e){this._hasSentPlayEvent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"analytics",{get:function(){return this._analytics},set:function(e){this._analytics=e},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e}()),M=function(){return function(){}}(),V=function(){return function(){}}(),R=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t}(V),z=function(){return function(){}}(),B=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return B(t,e),t}(z),F=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),U=function(e){function t(t){var i=e.call(this,t)||this;return i._elementWasClicked=!1,i._mousePressed=0,i}return F(t,e),t.prototype.init=function(){this.initializeParameters(),this.initializeListeners()},t.prototype.initializeParameters=function(){this._msIeUtils=new M,this._msIeUtils.avoidIeFalseError=!1,this._msIeUtils.prevMsieLeftVariation=0,this._observers=new W,this._timeouts=new q,this._analytics=new m,P.querySelectorInclusive(this.galleryData.domObject,".vilynx_img")?this._imgSelectorQuery=".vilynx_img":this._imgSelectorQuery="img:not(.vilynx_wrapperImg)",this._wrapperNode=null},t.prototype.initializeListeners=function(){n.a.optimizely&&n.a.optimizelyoff||n.a.passivetracking?(this.mouseClickListeners(),this.mouseMoveListeners()):this.monitorizeDesktop(),this.observeVilynxId()},t.prototype.monitorizeDesktop=function(){var e=this;this._externalFadeNode=null,this.config.externalfading&&(this._externalFadeNode=document.querySelector('[data-vilynx-fadingid="'+this.galleryData.extractedUrl+'"], [vilynx-fadingid="'+this.galleryData.extractedUrl+'"]'),this._externalFadeNode||this.logger.warn("No node found on document with the attr [data-]vilynx-fadingid="+this.galleryData.extractedUrl));var t=200;n.a.aggressivelazy&&(t=1e3),(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<b.version)&&b.reFactory(),this.watcher=window.scrollMonitor.create(this.galleryData.domObject,t),this.watcher.enterViewport(function(){e.config.isDisabled||(u.a.isEdge||u.a.isMsie?e._timeouts.waitToLoadTimeout=setTimeout(function(){e.watcher.isInViewport&&(e.logger.info("Item has been more than 350ms in viewport. Loading video!"),u.a.isEdge?e.attachVideoNode():(S.addElement(e),S.start()))},350):e.attachVideoNode())}),this.watcher.exitViewport(function(){e.config.isDisabled||(clearTimeout(e._timeouts.waitToLoadTimeout),e._wrapperNode&&e.videoNode?(e.logger.info("Exiting Viewport"),e.doExitViewport()):u.a.isMsie&&S.removeElement(e))})},t.prototype.attachVideoNode=function(){var e=this;try{var t=this.galleryData.domObject.classList.contains("vilynx_registered");if(this.config.isDisabled)return void this.logger.warn("This element is disabled. Ignore enterViewport event");t?!t||this.videoNode&&!this.videoNode.paused||(this.logger.info("autoplayOrAttachVideoNode again"),this.autoplayOrAttachVideoNode()):(this.logger.info("Entering viewport for first time"),this.initGallery(),this._analytics.trackThumbnailShown(this)),this.config.autoplay&&(clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._timeouts.trackSummaryPlayTimeout=setTimeout(function(){e.videoNode.paused||e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0)},this._analytics.summaryPlayTimeOut))}catch(e){this.logger.error("Exception raised while processing the gallery attachVideoNode. Aborting item execution. Stack trace:"),this.logger.error(e)}},t.prototype.initGallery=function(){var e=this;if(this.galleryData.domObject.classList.add("vilynx_registered"),this._elementsToIgnore=[],n.a.divignore&&!this.config.autoplay){var t=this.galleryData.domObject;if(n.a.divignorelevels)for(var i=0;i<parseInt(n.a.divignorelevels,10);i++)t=t.parentNode;this._elementsToIgnore=t.querySelectorAll(n.a.divignore),[].forEach.call(this._elementsToIgnore,function(t){e.ignoreElementListeners(t)})}this.generateVideoUrl(),this.videoNode=this.createVideoDom(),this._wrapperNode=this.createWrapperDom(),this.setWrapperResize(),u.a.isSafari&&this.videoData.sources.mp4.url.includes("short")&&this.coverBackgroundWithPoster(),this._wrapperNode.appendChild(this.videoNode),this.setWrapperResize(),P.elementNeedsRelative(this.galleryData.domObject)&&(this.galleryData.domObject.style.position="relative"),this.config.autoplay&&this.setVideoAutoplay(),this.wrapperImageListeners(),this.mouseMoveListeners(),this.mouseClickListeners(),this.videoListeners(),!this.config.redirect||this.config.autoplay&&!this.config.redirectautoplay||(this._redirect=new C(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this.config.redirectwithclick&&this.config.audiopolicycta?this._onVideoEnd.push(this._redirect.checkAudioPolicy.bind(this._redirect)):this._onVideoEnd.push(this._redirect.showRedirectWrapperCountDown.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect))),r.a.getOnPreviewLoop().forEach(function(t){e._onVideoLoop.push(t)}),P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg").classList.contains("vilynx_img")?this.observeBackgroundImage():this.observeOriginalImage(),this.addConfigListener(),this.resizeVideoNode(),this.responsiveListeners()},t.prototype.doExitViewport=function(){var e=this;if(!this.config.autoplay||this.config.isDisabled||u.a.isMsie)this.config.isStopped||this.cleanVideoNode();else try{this.videoNode.readyState>0?(this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)):setTimeout(function(){e.logger.info("Video ready state is 0. Pause can't be done. Retrying 10ms later"),e.videoNode.pause(),e._hasSentPlayEvent&&(e._analytics.trackSummaryEnd(e),e._hasSentPlayEvent=!1)},10)}catch(e){this.logger.info("Pause action failed.")}},t.prototype.cleanVideoNode=function(){this._wrapperNode&&this.videoNode&&this.videoNode.parentElement===this._wrapperNode&&(this._wrapperNode.removeChild(this.videoNode),this.videoNode=null,u.a.isMsie&&S.markElementRemoved())},t.prototype.autoplayOrAttachVideoNode=function(){if(this.config.autoplay&&!u.a.isMsie)try{this.videoNode.play()}catch(e){this.watcher.destroy(),this.logger.warn("This element had a huge issue trying to do the play. Destroying watcher listeners ")}else this.reAttachVideoNode()},t.prototype.reAttachVideoNode=function(){this._wrapperNode&&(this.generateVideoUrl(),this.videoNode=this.createVideoDom(),this._wrapperNode.appendChild(this.videoNode),u.a.isSafari&&this.videoData.sources.mp4.url.includes("short")&&this.coverBackgroundWithPoster(),this.resizeVideoNode(),this.videoListeners(),u.a.isMsie&&this.config.autoplay&&this.setVideoAutoplay())},t.prototype.coverBackgroundWithPoster=function(){this._wrapperNode&&(this._wrapperNode.style.backgroundImage="url( "+this.videoData.posterUrl+" )",this._wrapperNode.style.backgroundSize="cover",this._wrapperNode.style.backgroundPosition="center")},t.prototype.createVideoDom=function(){var e=document.createElement("video"),t=document.createElement("source");return t.src=this.videoData.sources.mp4.url,t.type=this.videoData.sources.mp4.mime,e.appendChild(t),e.poster=this.videoData.posterUrl,e.resolution=this.videoData.sources.mp4.resolution,e.preload="none",e.muted=!this.config.audio,e.countLoops=0,e.throttle=!1,e},t.prototype.resizeVideoNode=function(){if(!this.config.isDisabled){try{this.videoNode.childNodes[0]}catch(e){return void this.logger.info("Cant resize video node. The video node seems to not be created")}var e=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");if(e){var t,i=e.clientWidth,o=e.clientHeight,n=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),r="";0!==i&&0!==o&&(e.classList.contains("vilynx_img")?""!==e.style.backgroundImage&&(r=P.extractBGImageFromNode(e)):r=e.currentSrc||e.src,r&&n.src!==r&&(n.src=r),this.setWrapperResize(),u.a.isMsie&&(i/(t=this.videoData.is169&&!1===this.config.isVertical?16/9:4/3)<o&&!1===this.config.isVertical?(this.videoNode.style.height=o+"px",this.videoNode.style.width=o*t+"px",this.videoNode.style.left=(i-o*t)/2+"px",this.videoNode.style.top="0"):(this.videoNode.style.height=i/t+"px",this.videoNode.style.width=i+"px",this.videoNode.style.left="0",this.videoNode.style.top=(o-i/t)/2+"px",this.config.isVertical&&this.config.videoRatio&&(this.videoNode.style.height=i/this.config.videoRatio+"px",this.videoNode.style.top=Math.round((o-i/this.config.videoRatio)/2)+"px")),this._redirect&&this._redirect.setRedirectFontSize(e)))}else this.logger.error("Cant resize video node. No valid image found")}},t.prototype.createWrapperDom=function(){var e,t;return e=document.createElement("div"),t=P.createCopyImage(this.findMainImg()),e.appendChild(t),this.galleryData.domObject.insertBefore(e,this.galleryData.domObject.childNodes[0]),e.classList.add("supra-wrapper"),this.checkOtherElementszIndex(),u.a.isSafari&&(t.style.transform="translateZ(0)"),e},t.prototype.findMainImg=function(){var e,t=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery);return(e=P.findActiveImage(t)||t[0])?(e.classList.add("vilynx_mainImg"),this.config.noimage&&e.classList.add("vilynx-hide"),this.imageListeners(e),e):null},t.prototype.observeBackgroundImage=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");new MutationObserver(function(){if(""!==t.style.backgroundImage){var i=P.extractBGImageFromNode(t),o=e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src;e.logger.info("Div with background now have url, proceed to assign src in wrapperImg"),i!==o&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())}}).observe(t,{attributes:!0,characterData:!0})},t.prototype.observeOriginalImage=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");t.addEventListener("load",function(){var i=t.currentSrc||t.src;i!==e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())})},t.prototype.observeVilynxId=function(){var e=this,t=this.galleryData.domObject,i=["vilynx-id","data-vilynx-id","href"];this._observers.idObserve=new MutationObserver(function(t){t.forEach(function(t){try{if(t.target.getAttribute(t.attributeName)!==t.oldValue){e.disableNow();var i=[e.galleryData.domObject];ie.privateScan(null,i,e,null)}}catch(t){e.logger.error("Exception raised on vilynx-id attribute observation. Aborting item  mutation. Stack trace: "),e.logger.error(t)}})}),n.a.idattribute&&i.push(n.a.idattribute),this._observers.idObserve.observe(t,{attributeFilter:i,attributeOldValue:!0,attributes:!0})},t.prototype.refreshVideoNode=function(){this.enableNow(),this.videoNode&&this.cleanVideoNode(),u.a.isMsie?(S.addElement(this),S.start()):this.autoplayOrAttachVideoNode()},t.prototype.checkOtherElementszIndex=function(){var e=this,t=this.galleryData.domObject.getElementsByTagName("*");[].forEach.call(t,function(t){var i=window.getComputedStyle(t);1!==t.nodeType||"absolute"!==i.position&&"relative"!==i.position||!t.classList||t.classList.contains("vilynx_registered")||t.classList.contains("supra-wrapper")||t.classList.contains("vilynx_mainImg")||""!==i.zIndex&&"1"!==i.zIndex&&"auto"!==i.zIndex||0===t.querySelectorAll(".vilynx_mainImg").length&&(e.logger.info("Absolute positioned element found, setting zIndex: 2"),t.style.zIndex="2")})},t.prototype.mouseMoveListeners=function(){var e,t=this,i=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");(e=this.galleryData.domObject).addEventListener("mouseenter",function(){if(i=t.galleryData.domObject.querySelector(".vilynx_wrapperImg"),!t.config.isDisabled)if(t._mousedOver=!0,n.a.passivetracking)t._timeouts.passiveTrackingPlayTimeout=setTimeout(function(){t._mousedOver&&(t._analytics.trackSummaryPlay(t),t._hasSentPlayEvent=!0)},500);else{if(t.config.autoplay){if(t.config.audiohover&&(t.videoNode.muted=!t.config.audiohover,t.videoNode.paused&&(t.logger.error("Video stopped by audio policy. Removing audio and replaying"),t.config.audiohover=!1,t.playVideo(i))),t.videoNode&&!t.videoNode.paused&&t.config.pauseonhover){t.resizeVideoNode();try{t.videoNode.pause(),t._hasSentPlayEvent&&(t._analytics.trackSummaryEnd(t),t._hasSentPlayEvent=!1)}catch(e){t.logger.info("Pause action failed.")}t.videoNode.currentTime=0,P.showNodes([i,t._externalFadeNode]),t.config.pausehoveronce&&(t.galleryData.domObject.classList.remove("vilynx_autoplay"),t.galleryData.domObject.classList.remove("vilynx_pauseonhover"),t.config.pauseonhover=!1,t.disableAutoplay())}}else t.videoNode&&t.videoNode.paused&&t.playVideo(i);t._redirect&&t.config.redirectafter&&t.doRedirectIn(t.config.redirectafter)}}),e.addEventListener("mouseleave",function(e){clearTimeout(t._timeouts.passiveTrackingPlayTimeout);var i=!1;n.a.passivetracking&&t._hasSentPlayEvent&&(t._analytics.trackSummaryEnd(t),t._hasSentPlayEvent=!1),t.config.isDisabled||(t._mousedOver=!1,n.a.passivetracking||[].forEach.call(t._elementsToIgnore,function(t){(e.relatedTarget===t||t.contains(e.relatedTarget))&&(i=!0)}),i||u.a.isSafari&&t.galleryData.domObject.matches(":hover")||t.doMouseLeave(!1))})},t.prototype.playVideo=function(e){var t=this;e.parentElement.classList&&e.parentElement.classList.contains("vilynx-hide")&&this.setWrapperResize(),this.resizeVideoNode(),this.videoNode.muted=!this.config.audio,u.a.isSafari&&u.a.isSafari<=9?this._timeouts.fadeInterval||(this._timeouts.fadeInterval=setInterval(function(){!t.videoNode.paused&&t.videoNode.currentTime>.01&&(P.hideNodes([e,t._externalFadeNode]),clearInterval(t._timeouts.fadeInterval),t._timeouts.fadeInterval=null)},50)):P.hideNodes([e,this._externalFadeNode]),clearTimeout(this._timeouts.restartTimeout),this.logger.info("Video play");try{var i=this.videoNode.play();i&&i.catch(function(i){t.logger.info("An error has been captured while playing video. "+i.name+": "+i.message),t.config.audio&&t.videoNode&&(0===i.code?(t.config.audio=!1,t.playVideo(e)):t._mousedOver&&t.playVideo(e))})}catch(e){this.logger.info("Play action failed.")}r.a.getOnPlay().forEach(function(e){e(t.galleryData.domObject)}),clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._timeouts.trackSummaryPlayTimeout=setTimeout(function(){!t.videoNode||t.videoNode.paused||t._hasSentPlayEvent||(t._analytics.trackSummaryPlay(t),t._hasSentPlayEvent=!0)},this._analytics.summaryPlayTimeOut)},t.prototype.doMouseLeave=function(e){var t=this,i=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(clearTimeout(this._timeouts.waitForDurationTimeout),this.config.autoplay)this.config.pauseonhover&&P.hideNodes([i,this._externalFadeNode]),this.config.audiohover&&this.videoNode&&(this.videoNode.muted=this.config.audiohover),this._redirect&&this._redirect.redirecting&&this.config.redirectautoplay&&this._onVideoCancel.forEach(function(e){e()});else if(!this.config.autoplay){clearInterval(this._timeouts.fadeInterval),this._timeouts.fadeInterval=null,this.videoNode&&!e&&this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1),clearTimeout(this._timeouts.trackSummaryPlayTimeout),this._onVideoCancel.forEach(function(e){e()}),r.a.getOnStop().forEach(function(e){e(t.galleryData.domObject)});try{this.videoNode.pause()}catch(e){this.logger.info("Pause action failed.")}clearTimeout(this._timeouts.restartTimeout),this._timeouts.restartTimeout=setTimeout(function(){t.logger.info("Transition end has not been fired. Doing video reset via timeout!"),t.doReset(),t._timeouts.restartTimeout=null},400),P.showNodes([i,this._externalFadeNode])}this._redirect&&this.config.redirectafter&&this._redirect.timeToRedirect&&(this._redirect.timeToRedirect=null,this.logger.info("Mouseleave fired. Avoiding redirect."))},t.prototype.doReset=function(){this.videoNode&&this.videoNode.readyState>0&&(this.videoNode.countLoops=0,this.videoNode.throttle=!1,this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1),this.videoNode.currentTime>0&&(this.videoNode.currentTime=0))},t.prototype.setVideoAutoplay=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.resizeVideoNode(),this.videoNode.loop=!this.config.autoplayonce,this.config.redirectautoplay&&this.videoNode.duration&&!this.config.redirectafter&&(this.config.redirectafter=1e3*this.videoNode.duration),this.videoNode.muted=!0,window.setTimeout(function(){try{e.videoNode.play(),e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0)}catch(t){e.logger.info("Play action failed.")}P.hideNodes([t,e._externalFadeNode])},100),this.logger.info("Autoplay video starts to play")},t.prototype.doRedirectIn=function(e){var t=this;if(this.videoNode&&this.videoNode.duration){if(!this._redirect.timeToRedirect&&!this._redirect.redirecting){var i=1e3*this.videoNode.currentTime+e,o=Math.floor(i/(1e3*(this.config.duration||this.videoNode.duration)));this._redirect.timeToRedirect=i%(1e3*(this.config.duration||this.videoNode.duration)),0===this._redirect.timeToRedirect&&++this._redirect.timeToRedirect,this._redirect.loopToRedirect=this.getCountLoops()+o,this.logger.info("Mouse over at: "+1e3*this.videoNode.currentTime+".\n                        Redirect wrapper will fire at "+this._redirect.timeToRedirect+".\n                        In the "+this._redirect.loopToRedirect+"th loop")}}else this._timeouts.waitForDurationTimeout=setTimeout(function(){t.doRedirectIn(e)},100)},t.prototype.responsiveListeners=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");window.addEventListener("resize",function(){e._deleted||e.requestPreviewResize()}),u.a.isSafari&&this._redirect&&window.addEventListener("beforeunload",function(){e._redirect.hideRedirectWrapper()}),this.imageListeners(t),this._observers.imgRemovedObserver=new MutationObserver(function(){if(!(t=P.querySelectorInclusive(e.galleryData.domObject,".vilynx_mainImg"))){e.reassignTargetImage()&&(e.setWrapperResize(),e.resizeVideoNode())}}),this._observers.imgRemovedObserver.observe(t.parentNode,{childList:!0}),this._observers.supraWrapperRemoved=new MutationObserver(function(){e.galleryData.domObject&&e.galleryData.domObject.querySelector(".supra-wrapper")||(e.logger.error("Supra-wrapper has been removed. Removing Gallery Item"),e.removeItem())}),this._observers.supraWrapperRemoved.observe(this.galleryData.domObject,{childList:!0}),n.a.resizeonscroll&&window.addEventListener("scroll",function(){e._deleted||e.requestPreviewResize()})},t.prototype.wrapperImageListeners=function(){var e=this,t=this._wrapperNode.querySelector(".vilynx_wrapperImg");t.addEventListener("transitionend",function(){clearTimeout(e._timeouts.restartTimeout),t.classList.contains("vilynx_fading")||e.doReset()},!1)},t.prototype.imageListeners=function(e){var t=this;if(!this._observedImage||this._observedImage!==e){var i=new MutationObserver(function(){t.videoNode&&(t.setWrapperResize(),t.resizeVideoNode())});i.observe(e,{attributes:!0,characterData:!0}),this.logger.info("Vilynx_mainImg has changed, observing new image"),this._observers.imageObserver&&this._observers.imageObserver.disconnect(),this._observedImage&&this._observedImage.removeEventListener("transitionend",this.endTransition),e.addEventListener("transitionend",function(e){t._deleted||t.endTransition(e)}),this._observers.imageObserver=i,this._observedImage=e,e.addEventListener("load",function(){t._deleted||(t.logger.info("Image load event fired. Doing resize."),t.setWrapperResize())})}},t.prototype.endTransition=function(e){var t=e.propertyName;["all","top","right","bottom","left","margin-right","margin-left","width","height","size","weight","transform"].some(function(e){return t===e})&&(this.logger.info("transition of type "+t+" has ended. Resizing"),this.requestPreviewResize())},t.prototype.requestPreviewResize=function(){var e=this;this._timeouts.resizeTimeout&&window.cancelAnimationFrame(this._timeouts.resizeTimeout),this._timeouts.resizeTimeout=window.requestAnimationFrame(function(){e.setWrapperResize(),e.resizeVideoNode()})},t.prototype.setWrapperResize=function(){var e=this.reassignTargetImage();if(!e)return this.logger.error("No valid image found. Hiding supra-wrapper"),this.galleryData.domObject&&this.galleryData.domObject.querySelector&&this.galleryData.domObject.querySelector(".supra-wrapper")&&this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide"),void(this.videoNode&&!this.videoNode.paused&&(this.logger.warn("Supra-wrapper is hidden but video still playing. Pausing"),this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)));this.setWrapperStyles();var t=P.getTargetImgSize(e);this._wrapperNode.style.width=t.width+"px",this._wrapperNode.style.height=t.height+"px",this._redirect&&(this._redirect.setHeight(t.height),this._redirect.setRedirectFontSize(e))},t.prototype.reassignTargetImage=function(){var e,t,i,o=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),n=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(!o){if(!(o=this.findMainImg())||!n)return null;n.src=o.src}if(e=o.clientWidth,t=o.clientHeight,i=o.naturalWidth,0===e||0===t||i<2&&!this.config.autoplay){this.logger.warn("vilynx_mainImg is too small '"+e+"x"+t+"' searching a new image");var r=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),s=void 0;if(!(s=P.findActiveImage(r))||s.naturalWidth<2&&!this.config.autoplay)return null;o.classList.remove("vilynx_mainImg"),s.classList.add("vilynx_mainImg"),n.src=s.src,o=s,this.imageListeners(o),this.logger.warn("Found new valid image updated vilynx_mainImg & src")}return o},t.prototype.setWrapperStyles=function(){if(this.galleryData.domObject.querySelector(".supra-wrapper")&&(this.galleryData.domObject.querySelector(".supra-wrapper").classList.contains("vilynx-hide")&&(this.logger.warn("Supra-wrapper was hidden but now is shown again"),this.galleryData.domObject.querySelector(".supra-wrapper").classList.remove("vilynx-hide"),this.config.autoplay&&this.setVideoAutoplay()),!this.galleryData.domObject.classList.contains("vilynx_mainImg"))){var e=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),t=window.getComputedStyle(e);if(t.cssFloat&&(this._wrapperNode.style.cssFloat=t.cssFloat),t.marginLeft||t.marginRight||t.marginTop||t.marginBottom?(this._wrapperNode.style.marginLeft=t.marginLeft,this._wrapperNode.style.marginRight=t.marginRight,this._wrapperNode.style.marginTop=t.marginTop,this._wrapperNode.style.marginBottom=t.marginBottom):t.margin&&(this._wrapperNode.style.margin=t.margin.replace(",",".")),this._wrapperNode.style.maxHeight=window.getComputedStyle(e.parentElement).maxHeight,u.a.isMsie){var i=this.galleryData.domObject.getBoundingClientRect().left-this._msIeUtils.prevMsieLeftVariation,o=parseFloat((i%1).toFixed(2)),n=void 0;0!==o&&.5!==o&&(this.logger.info("Fixing wrapper node is placed in "+i+". Normalizing decimals with left."),n=o<.5?o<.25?0-o:.5-o:o>=.75?1-o:.5-o,P.addLeftCssToNode(this.galleryData.domObject,n-this._msIeUtils.prevMsieLeftVariation),this._msIeUtils.prevMsieLeftVariation=n)}}},t.prototype.mouseClickListeners=function(){var e=this,t=this.galleryData.domObject;t.addEventListener("click",function(t){e.onMouseClick(t.which)}),u.a.isSafari||u.a.isIe||(t.addEventListener("mousedown",function(t){e._mousePressed=t.which}),t.addEventListener("mouseout",function(){e._mousePressed=0,e._elementWasClicked=!1}),t.addEventListener("mouseup",function(t){2===e._mousePressed&&2===t.which&&(e.onMouseClick(t.which),e._mousePressed=0,e.logger.info("Middle button pressed. Calling onMouseClick() function."))}))},t.prototype.onMouseClick=function(e){var t=this;if(!this.config.isDisabled){if(c.a.isRedirecting||this._elementWasClicked||(clearTimeout(this._timeouts.passiveTrackingPlayTimeout),this._hasSentPlayEvent||this._analytics.trackSummaryPlay(this),this._analytics.trackVideoPlay(this,!1),this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1,this._elementWasClicked=2!==e,r.a.getOnPreviewClick().forEach(function(e){e(t.galleryData.domObject)})),this.videoNode&&this.videoNode.currentTime>.5){var i=this.getCountLoops(),o=i*this.config.duration+this.videoNode.currentTime;this.logger.info("EngagementTime: "+o+"\n            countLoops: "+i)}this._hasSentPlayEvent=!1,this.doMouseLeave(!0)}},t.prototype.videoListeners=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),i=this.videoNode;u.a.isSafari&&(i=this.videoNode.querySelector("source")),i.addEventListener("error",function(t){e.logger.error("Loading video node has produced an error. Stopping Gallery execution."),t.error&&e.logger.info("Error code: "+t.error.toString()),e._deleted||e._msIeUtils.avoidIeFalseError||e.removeItem()}),0===this.config.duration&&this.videoNode.addEventListener("loadedmetadata",function(){e.videoNode&&(n.a.summaryplaytimeout>1e3*e.videoNode.duration&&(e._analytics.summaryPlayTimeOut=500,e._timeouts.trackSummaryPlayTimeout&&(clearTimeout(e._timeouts.trackSummaryPlayTimeout),e._timeouts.trackSummaryPlayTimeout=setTimeout(function(){e.videoNode.paused||e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0)},e._analytics.summaryPlayTimeOut))),u.a.isMsie&&(e._msIeUtils.avoidIeFalseError=!0),e.logger.info("Video metadata ready, duration is: "+e.videoNode.duration),e.config.duration=e.videoNode.duration,e.config.autoplay&&!e.config.redirectafter&&(e.config.redirectafter=1e3*e.videoNode.duration),e.config.videoRatio=e.videoNode.videoWidth/e.videoNode.videoHeight,e.config.videoRatio<1&&(e.logger.info("Video vertical found!"),e.config.isVertical=!0,e.setWrapperResize(),e.resizeVideoNode()))}),this.videoNode.addEventListener("timeupdate",function(){if(e.videoNode){var i=1e3*e.videoNode.currentTime;i>10&&(i<100*e.config.duration?e.videoNode.throttle&&(e.videoNode.throttle=!1,e.videoNode.countLoops+=1,e.logger.info("Loop count: "+e.videoNode.countLoops),e._onVideoLoop.forEach(function(t){t(e.galleryData.domObject,e.getCountLoops())})):e.videoNode.throttle=!0),e.config.autoplayonce&&e.config.fadeinadvance&&P.isNodeVilynxHidden(t)&&i+e.config.fadeinadvance>=1e3*e.videoNode.duration&&(e.logger.info("autoplayonce and fadeinadvance ("+e.config.fadeinadvance+"ms) set, hiding video node."),P.showNodes([t,e._externalFadeNode])),e._redirect&&e._redirect.timeToRedirect&&!e._redirect.redirecting&&(e.videoNode.countLoops===e._redirect.loopToRedirect&&i>=e._redirect.timeToRedirect||e.videoNode.countLoops>e._redirect.loopToRedirect)&&(e.logger.info("Redirect after fired at "+1e3*e.videoNode.currentTime+"ms,\n                            Showing redirect wrapper"),e._redirect.timeToRedirect=null,e._onVideoEnd.forEach(function(e){e()}))}}),this.videoNode.addEventListener("ended",function(){if(e.videoNode.muted=e.config.audioonce||!e.config.audio,!e.config.autoplay){e.videoNode.currentTime=0;try{e.videoNode.play()}catch(t){e.logger.info("Play action failed.")}e.config.redirectafter||e.galleryData.domObject.classList.contains("vilynx_no-redirect")||(e.logger.info("Video Ended, calling onEnd function stack"),e._onVideoEnd.forEach(function(e){e()}))}})},t.prototype.videoErrorHandler=function(e){this.logger.error("Loading video node has produced an error. Stopping Gallery execution on this element."),this.logger.error(e),this._deleted||this.removeItem()},t.prototype.removeItem=function(){var e=this;this.logger.info("Removing Gallery Item..."),this.disableNow(),this._deleted=!0,[].forEach.call(Object.keys(this._observers),function(t){e._observers[t].disconnect()}),[].forEach.call(Object.keys(this._timeouts),function(t){clearTimeout(e._timeouts[t])}),this.galleryData.domObject.querySelector(".supra-wrapper")&&this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide"),this.dealloc()},t.prototype.ignoreElementListeners=function(e){var t,i,o=this;e.addEventListener("mouseenter",function(){t=o.galleryData.domObject.querySelector(".vilynx_wrapperImg"),o.config.autoplay||o.config.isDisabled||o.videoNode.paused&&o.playVideo(t)}),e.addEventListener("mouseleave",function(e){if(!o.config.autoplay&&!o.config.isDisabled){i=o.galleryData.domObject;var t=!1;[].forEach.call(o._elementsToIgnore,function(i){(e.relatedTarget===i||i.contains(e.relatedTarget))&&(t=!0)}),e.relatedTarget===i||i.contains(e.relatedTarget)||t||o.videoNode.paused||o.doMouseLeave(!1)}})},t.prototype.addConfigListener=function(){var e,t,i,o=this;e=u.a.isIe?this.galleryData.domObject.getAttribute("class"):this.galleryData.domObject.classList.value,this._oldClasses=e?e.split(" "):null,t=this.galleryData.domObject,i={attributeOldValue:!0,attributes:!0,characterData:!1,childList:!1,subtree:!1},this._observers.configListener=new MutationObserver(function(e){var t=o.extractClassChanges(),i=P.extractAttributeChanges(o.galleryData.domObject,e),n={additions:t.additions.concat(i.additions),removals:t.removals.concat(i.removals)};o.manageConfigChanges(n)}),this._observers.configListener.observe(t,i)},t.prototype.extractClassChanges=function(){var e,t,i;return t=(e=u.a.isIe?this.galleryData.domObject.getAttribute("class"):this.galleryData.domObject.classList.value)?e.split(" "):"",i=P.getArrayChanges(this._oldClasses,t),this._oldClasses=t,i},t.prototype.manageConfigChanges=function(e){(e.additions.length||e.removals.length)&&(this.logger.info("Configuration changed:\n                        Additions: "+e.additions+"\n                        Removals: "+e.removals),this.config.autoplay&&-1!==e.removals.indexOf("vilynx_autoplay")?(this.logger.info("vilynx_autoplay class removed: Disable autoplay"),this.disableAutoplay()):this.config.autoplay||-1===e.additions.indexOf("vilynx_autoplay")||(this.logger.info("vilynx_autoplay class added: Enable autoplay"),this.enableAutoplay()),this.config.autoplay&&(!this.config.autoplayonce||this.config.autoplayonce&&!this.isOneLoopAutoplayVideoFinished())&&(this.config.isDisabled&&-1!==e.removals.indexOf("vilynx_stop")?(this.logger.info("vilynx_stop class removed: Replaying video"),this.unStopVideo()):this.config.isDisabled||-1===e.additions.indexOf("vilynx_stop")||(this.logger.info("vilynx_stop class added: Stops video"),this.stopVideo())),this.config.audiohover&&-1!==e.removals.indexOf("vilynx_audiohover")?(this.logger.info("vilynx_audiohover class removed"),this.config.audiohover=!1):this.config.audiohover||-1===e.additions.indexOf("vilynx_audiohover")||(this.logger.info("vilynx_audiohover class added"),this.config.audiohover=!0),n.a.disableall?this.config.isDisabled?-1===e.additions.indexOf("vilynx_enabled")&&-1===e.additions.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class added: Enable Gallery item"),this.enableNow()):-1===e.removals.indexOf("vilynx_enabled")&&-1===e.removals.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class removed: Disable Gallery item"),this.disableNow()):this.config.isDisabled?-1!==e.removals.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class removed: Enable Gallery item"),this.enableNow()):-1!==e.additions.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class added: Disable Gallery item"),this.disableNow()))},t.prototype.enableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!1,this.watcher.isInViewport&&(u.a.isMsie?(S.addElement(this),S.start()):this.autoplayOrAttachVideoNode()),this.config.autoplay&&P.hideNodes([e,this._externalFadeNode])},t.prototype.disableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!0,P.showNodes([e,this._externalFadeNode]),this.watcher.isInViewport&&this.doExitViewport()},t.prototype.stopVideo=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!0,this.config.isStopped=!0,this.config.stopnoimage||P.showNodes([e,this._externalFadeNode]);try{this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1)}catch(e){this.logger.info("Pause action failed.")}},t.prototype.unStopVideo=function(){this.config.isDisabled=!1,this.config.isStopped=!1,this.setVideoAutoplay()},t.prototype.isOneLoopAutoplayVideoFinished=function(){return!this.videoNode||1e3*this.videoNode.currentTime>=1e3*this.videoNode.duration-n.a.fadeinadvance},t.prototype.enableAutoplay=function(){if(this.config.autoplay=!0,this._redirect&&!this.config.redirectautoplay&&(this._wrapperNode.removeChild(this._redirect.redirectDom),this._redirect=null),this.watcher.isInViewport)this.setVideoAutoplay();else if(this._wrapperNode){this.generateVideoUrl(),this.videoNode=this.createVideoDom(),this._wrapperNode.appendChild(this.videoNode),this.resizeVideoNode(),this.videoListeners();var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");P.hideNodes([e,this._externalFadeNode])}},t.prototype.disableAutoplay=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(this.config.autoplay=!1,this.videoNode.loop=!1,P.showNodes([t,this._externalFadeNode]),this.watcher.isInViewport&&this.videoNode){try{this.videoNode.pause(),this._hasSentPlayEvent&&(this._hasSentPlayEvent=!1,this._analytics.trackSummaryEnd(this))}catch(e){this.logger.info("Pause action failed.")}this.doReset()}if(this.config.redirect&&(this._redirect=new C(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this.config.redirectwithclick&&this.config.audiopolicycta?this._onVideoEnd.push(this._redirect.checkAudioPolicy.bind(this._redirect)):this._onVideoEnd.push(this._redirect.showRedirectWrapperCountDown.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect)),this._redirect.setRedirectFontSize(t)),n.a.divignore){var i=this.galleryData.domObject;if(n.a.divignorelevels)for(var o=0;o<parseInt(n.a.divignorelevels,10);o++)i=i.parentNode;this._elementsToIgnore=i.querySelectorAll(n.a.divignore),[].forEach.call(this._elementsToIgnore,function(t){e.ignoreElementListeners(t)})}},t}(j),C=function(){function e(e,t){this._gallery=e,this._domObject=e.galleryData.domObject,this._analytics=t,this._timeOuts=new A}return e.prototype.dealloc=function(){this._gallery=void 0,this._analytics=void 0,this._timeOuts=void 0},e.prototype.createRedirectDom=function(){var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),n=window.getComputedStyle(P.querySelectorInclusive(this._domObject,".vilynx_mainImg")),r=parseFloat(n.height.replace("px",""));return this.redirectDom=e,t.classList.add("redirectCenter"),e.classList.add("redirectWrapper"),this._gallery.config.hidectaicon&&e.classList.add("hideCtaIcon"),e.appendChild(t),i.classList.add("text"),u.a.isMobile?(e.classList.add("cta"),i.innerHTML=this._gallery.config.ctatext):i.innerHTML=this._gallery.config.redirecttext,o.id="counter",o.classList.add("counter"),o.innerHTML="3",t.appendChild(i),t.appendChild(o),t.style.height=r+"px",e},e.prototype.setHeight=function(e){this.redirectDom.querySelector(".redirectCenter").style.height=e+"px"},e.prototype.setRedirectFontSize=function(e){var t=window.getComputedStyle(e),i=parseFloat(t.width.replace("px","")),o=Math.floor(.09*i);if(o>40&&(o=40),this.redirectDom){var n=this.redirectDom.querySelector("#counter"),r=this.redirectDom.querySelector(".redirectCenter"),s=this.redirectDom.querySelector(".redirectCenter .text");r.style.fontSize=o+"px",n.style.fontSize=Math.floor(1.5*o)+"px",n.style.lineHeight=Math.floor(1.7*o)+"px",i<300?(s.style.maxWidth=i+"px",s.style.lineHeight="normal",n.style.maxWidth=i+"px",n.style.fontSize=Math.floor(1.2*o)+"px",n.style.lineHeight=Math.floor(1.5*o)+"px",n.style.marginBottom=Math.floor(1.2*o)+"px",s.style.marginBottom="0px"):(s.style.maxWidth="unset",s.style.marginBottom="10px",n.style.maxWidth="unset",n.style.marginBottom="unset")}},e.prototype.checkAudioPolicy=function(){D.doTestSound(this.showRedirectWrapperOnlyCta.bind(this),this.showRedirectWrapperCountDown.bind(this))},e.prototype.showRedirectWrapperOnlyCta=function(){this.redirectDom.querySelector(".redirectCenter .text").innerHTML=this._gallery.config.ctatext,this.redirectDom.classList.add("cta"),this.showRedirectWrapper()},e.prototype.showRedirectWrapperCountDown=function(){this.redirectDom.querySelector(".redirectCenter .text").innerHTML=this._gallery.config.redirecttext,this.redirectDom.classList.remove("cta"),this.showRedirectWrapper(),this.countdownTimeouts()},e.prototype.showRedirectWrapper=function(){if(this._gallery.videoNode){var e=this._gallery.galleryData.domObject;if(this._timeOuts=new A,this._gallery.videoNode.duration<1)this._gallery.logger.error("Video shorter than 1 sec, avoiding redirect");else if(e.href||this._gallery.config.redirectwithclick||this._gallery.config.redirectwithvid){if(this._gallery.config.redirectwithvid)if(!1===new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(this._gallery.galleryData.extractedUrl))return void this._gallery.logger.error("vilynx-id is not a valid URL, abort redirect");this.redirectDom.style.visibility="visible",this.redirectDom.style.zIndex="99999999",this.redirectDom.style.opacity="1",this._timeOuts=new A,this.redirecting=!0}else this._gallery.logger.error("No parent anchor found, avoiding redirect")}},e.prototype.countdownTimeouts=function(){var e=this,t=this.redirectDom.querySelector("#counter"),i=this._gallery.videoNode.duration,o=this._gallery.galleryData.domObject,s=3;i>3?(t.innerHTML="3",this._timeOuts.twoSec=setTimeout(function(){t.innerHTML="2"},1e3),this._timeOuts.oneSec=setTimeout(function(){t.innerHTML="1"},2e3)):i>2?(t.innerHTML="2",this._timeOuts.oneSec=setTimeout(function(){t.innerHTML="1"},1e3),s=2):i>1&&(t.innerHTML="1",s=1),this._timeOuts.zeroSecs=setTimeout(function(){if(c.a.isRedirecting=!0,e._analytics.trackVideoPlay(e._gallery,!0),e._gallery.analytics.trackSummaryEnd(e._gallery),e._gallery.hasSentPlayEvent=!1,e._gallery.config.redirectwithclick&&!o)e._gallery.logger.error("No parent anchor found, avoiding redirect with .click()");else if(e._gallery.config.redirectwithclick&&o){e._gallery.logger.debug("Cleaning redirect frame");var t=e._gallery.galleryData.domObject.querySelector(n.a.redirectwithclicktarget);r.a.getOnPreviewRedirect().forEach(function(t){t(e._gallery.galleryData.domObject)}),n.a.redirectwithclicktarget&&t?t.click():e._domObject.click(),c.a.isRedirecting=!1}else{e._gallery.logger.debug("Cleaning redirect frame"),e._gallery instanceof U&&e._gallery.doMouseLeave(!0),e._gallery.analytics.trackVideoPlay(e._gallery,!0);var i=e._domObject.href;e._gallery.config.redirectwithvid&&(i=e._gallery.galleryData.extractedUrl),r.a.getOnPreviewRedirect().forEach(function(t){t(e._gallery.galleryData.domObject)}),window.location.href=i}e.redirecting=!1},1e3*s)},e.prototype.hideRedirectWrapper=function(){var e=this,t=this.redirectDom;t.querySelector("#counter").innerHTML="3",t.style.opacity="",t.style.visibility="",t.style.zIndex="",this.redirecting=!1,Object.keys(this._timeOuts).length&&(Object.keys(this._timeOuts).forEach(function(t){e._gallery.logger.debug("Clearing timeout "+t),clearTimeout(e._timeOuts[t])}),this._timeOuts=new A)},e}(),G=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return G(t,e),t}(z),Q=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Q(t,e),t}(V),J=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),X=function(e){function t(t){var i=e.call(this,t)||this;return i._oldClasses=[],i}return J(t,e),t.prototype.init=function(){var e=this;if(this._nTry=0,this._observers=new K,this._timeouts=new H,this._analytics=new m,this.mouseClickListeners(),this.observeVilynxId(),this.findElementsToFade(),n.a.taptoplay&&this.config.autoplay?this.config.taptoplay=!1:!n.a.taptoplay&&this.config.taptoplay&&(this.config.autoplay=!1),n.a.optimizelyoff||n.a.passivetracking)this.monitorizeOneAutoplay(),this.logger.warn("Optimizely OFF variation");else if(n.a.ingnoreelementheight||0!==this.galleryData.domObject.clientHeight)if(P.querySelectorInclusive(this.galleryData.domObject,".vilynx_img")?this._imgSelectorQuery=".vilynx_img:not(.vilynx_wrapperImg)":this._imgSelectorQuery="img:not(.vilynx_wrapperImg)",n.a.allautoplay)if(u.a.isIos){var t,i,o=void 0,r=void 0;if((i=(t=this.galleryData.domObject.querySelectorAll("img:not(.vilynx_wrapperImg)"))[t.length-1])&&n.a.customimgsrc)o=i,this._oldImageUrl=i[n.a.customimgsrc];else if(i)o=i,this._oldImageUrl=i.src;else{var s=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),a=void 0;if(!(a=P.findActiveImage(s)))return void this.logger.error("No valid image found");a.classList.add("vilynx_mainImg"),r=P.extractBGImageFromNode(a),this._oldImageUrl=r,o=a}n.a.directurl&&o.addEventListener("error",function(){e.logger.error("Gif url is not working. Removing gallery Item."),e.removeItem()}),this.generateGifUrl(),this.monitorizeGif()}else this.monitorizeMp4();else this.monitorizeOneAutoplay();else this.logger.warn("Element height is 0, Aborting!!!")},t.prototype.addConfigListener=function(){var e=this;this.galleryData.domObject.classList?this._oldClasses=this.galleryData.domObject.classList.value.split(" "):this._oldClasses=[];var t=this.galleryData.domObject;this._observers.configListener=new MutationObserver(function(t){var i=e.extractClassChanges(),o=P.extractAttributeChanges(e.galleryData.domObject,t),n={additions:i.additions.concat(o.additions),removals:i.removals.concat(o.removals)};e.manageConfigChanges(n)}),this._observers.configListener.observe(t,{attributeOldValue:!0,attributes:!0,characterData:!1,childList:!1,subtree:!1})},t.prototype.extractClassChanges=function(){var e=this.galleryData.domObject.classList.value.split(" "),t=P.getArrayChanges(this._oldClasses,e);return this._oldClasses=e,t},t.prototype.manageConfigChanges=function(e){this.config.isDisabled&&-1!==e.removals.indexOf("vilynx_stop")?(this.logger.info("vilynx_stop class removed: Replaying video"),this.enableNow()):this.config.isDisabled||-1===e.additions.indexOf("vilynx_stop")||(this.logger.info("vilynx_stop class added: Stops video"),this.disableNow()),n.a.disableall?this.config.isDisabled?-1===e.additions.indexOf("vilynx_enabled")&&-1===e.additions.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class added: Enable Gallery item"),this.enableNow()):-1!==e.removals.indexOf("vilynx_enabled")&&-1!==e.removals.indexOf("teaser_enabled")&&(this.logger.info("vilynx_enabled/teaser_enabled class removed: Disable Gallery item"),this.disableNow()):this.config.isDisabled?-1!==e.removals.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class removed: Enable Gallery item"),this.enableNow()):-1!==e.additions.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class added: Disable Gallery item"),this.disableNow()),this.galleryData.domObject.classList?this._oldClasses=this.galleryData.domObject.classList.value.split(" "):this._oldClasses=[]},t.prototype.enableNow=function(){this.config.isDisabled=!1,this.watcher.isInViewport&&(n.a.allautoplay?this.initOrReattachGallery(!0):(w.a.addToLoadedQueue(this,!1),w.a.addToViewportQueue(this,!1)))},t.prototype.disableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!0,this.showNodes([e]),w.a.removeFromViewportQueue(this),n.a.mobilepreload&&w.a.removeFromLoadedQueue(this)},t.prototype.monitorizeGif=function(){var e=this,t=0;n.a.previewdelay&&(t=n.a.previewdelay),(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<b.version)&&b.reFactory(),this.watcher=window.scrollMonitor.create(this.galleryData.domObject),this.watcher.enterViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):(e.logger.info("Entering Viewport"),setTimeout(function(){e.watcher.isInViewport&&(e.logger.info("User stops scrolling"),e.showGif())},1e3*t+300))}),this.watcher.exitViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):(e.logger.info("Exiting Viewport"),e.hideGif())})},t.prototype.monitorizeMp4=function(){var e=this;(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<b.version)&&b.reFactory(),this.watcher=window.scrollMonitor.create(this.galleryData.domObject),this.watcher.enterViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):(e.logger.info("Entering Viewport"),e.initOrReattachGallery(!0))}),this.watcher.exitViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):e._wrapperNode&&e.videoNode&&(e.logger.info("Exiting Viewport"),e.cleanVideoNode(!1))})},t.prototype.monitorizeOneAutoplay=function(){var e=this,t=!1,i=this.getFirstScrollableParent(this.galleryData.domObject),o=this.config.topviewportoffset,r=this.config.bottomviewportoffset;!n.a.pulltochange&&!n.a.followscroll||n.a.scrollListenerAdded||(n.a.scrollListenerAdded=!0,w.a.followScrollListener()),(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<b.version)&&b.reFactory(),!i||"BODY"===i.tagName||i.clientWidth===document.body.clientHeight&&i.clientHeight===document.body.clientHeight?i=void 0:(o=parseInt(i.getAttribute("vilynx_topOffset"),10)||0,r=parseInt(i.getAttribute("vilynx_bottomOffset"),10)||0),this.watcher=window.scrollMonitor.create(this.galleryData.domObject,{bottom:r,top:o},i),n.a.mobilepreload&&!n.a.passivetracking&&(this.watcher.canPreload(function(){e.config.isDisabled||e.videoNode||0===e.galleryData.domObject.offsetHeight||w.a.addToLoadedQueue(e,!1)}),this.watcher.canUnload(function(){e.videoNode&&(e.logger.info("Element is far from viewport, remove it from loaded queue and clean videoNode"),w.a.removeFromLoadedQueue(e))}),this.watcher.enterViewport(function(){e.videoNode||e.config.isDisabled||w.a.addToLoadedQueue(e,!1)})),this.watcher.fullyEnterViewport(function(){if(e.watcher.isInViewport){if(e.config.isDisabled)return void e.logger.info("Element is disabled, ignore watcher event");n.a.passivetracking||(n.a.initmobilequeue&&(n.a.initmobilequeue=!1,t=!0),n.a.mobilepreload&&(e.videoNode||w.a.addToLoadedQueue(e,!1))),e.logger.info("Video added to viewportQueue"),w.a.addToViewportQueue(e,t)}}),this.watcher.partiallyExitViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):(n.a.passivetracking||(e.config.taptoplay&&(e._tapedElementNotInQueue=!0),e.logger.info("Exiting Viewport")),c.a.scrollDirection=e.watcher.isAboveViewport,w.a.removeFromViewportQueue(e))}),this.watcher.thresholdEnterViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):e.watcher.isFullyInViewport||(w.a.addToViewportQueue(e,t),e.logger.info("Video added to viewportQueue by thresholdEnterViewport cb()"))}),this.watcher.thresholdExitViewport(function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore watcher event"):(e.logger.info("Exiting Viewport"),c.a.scrollDirection=e.watcher.isAboveViewport,w.a.removeFromViewportQueue(e))})},t.prototype.getFirstScrollableParent=function(e){for(var t=e,i=!1;"BODY"!==t.tagName&&!i;){t=t.parentElement;var o=window.getComputedStyle(t);i=-1!==o.overflowY.indexOf("auto")||-1!==o.overflowY.indexOf("scroll")}return t},t.prototype.initOrReattachGallery=function(e){var t=this.galleryData.domObject.classList.contains("vilynx_registered");this.watcher.top<0||0===this.watcher.bottom?this.logger.info("Element not really in viewport"):n.a.passivetracking?(this.analytics.trackSummaryPlay(this),this._hasSentPlayEvent=!0):t?t&&!this.videoNode&&(this.logger.info("reAttachVideoNode again"),this.reAttachVideoNode(e)):(this.logger.info("Entering viewport for first time"),this.initGallery(e),this._analytics.trackThumbnailShown(this))},t.prototype.logMessage=function(e){this.logger.info(e)},t.prototype.initGallery=function(e){var t=this;this.galleryData.domObject.classList.add("vilynx_registered"),this.generateVideoUrl(),this.videoNode=this.createVideoDom(),this._wrapperNode=this.createWrapperDom(),this._wrapperNode.appendChild(this.videoNode),this.animateResize(null),this.watcher.watchItem=this._wrapperNode,this.config.mobilecta&&(this._redirect=new C(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this._onVideoEnd.push(),this._onVideoEnd.push(this._redirect.showRedirectWrapper.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect))),r.a.getOnPreviewLoop().forEach(function(e){t._onVideoLoop.push(e)}),P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg").classList.contains("vilynx_img")?this.observeBackgroundImage():this.observeOriginalImage(),this.resizeVideoNode(),e&&this.showVideoNode(),this.addConfigListener(),this.wrapperImageListeners(),this.videoListeners(),this.responsiveListeners()},t.prototype.findElementsToFade=function(){this._externalFadeNode=null,this.config.externalfading&&(this._externalFadeNode=document.querySelector('[data-vilynx-fadingid="'+this.galleryData.extractedUrl+'"], [vilynx-fadingid="'+this.galleryData.extractedUrl+'"]'),this._externalFadeNode||this.logger.warn("No node found on document with the attr\n                    [data-]vilynx-fadingid="+this.galleryData.extractedUrl))},t.prototype.observeBackgroundImage=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");this._observers.bgObserve=new MutationObserver(function(){if(""!==t.style.backgroundImage){var i=P.extractBGImageFromNode(t),o=e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src;e.logger.info("Div with background now have url, proceed to assign src in wrapperImg"),i!==o&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())}}),this._observers.bgObserve.observe(t,{attributes:!0,characterData:!0})},t.prototype.observeOriginalImage=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");t.addEventListener("load",function(){var i=t.currentSrc||t.src;i!==e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src&&(e.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=i,e.resizeVideoNode())})},t.prototype.observeVilynxId=function(){var e=this,t=this.galleryData.domObject,i=["vilynx-id","data-vilynx-id"];this._observers.idObserve=new MutationObserver(function(t){t.forEach(function(t){try{if(t.target.getAttribute(t.attributeName)!==t.oldValue){var i=[e.galleryData.domObject];ie.privateScan(null,i,e,null)}}catch(t){e.logger.error("Exception raised on vilynx-id attribute observation. Aborting item  mutation. Stack trace: "),e.logger.error(t)}})}),n.a.idattribute&&i.push(n.a.idattribute),this._observers.idObserve.observe(t,{attributeFilter:i,attributeOldValue:!0,attributes:!0})},t.prototype.refreshVideoNode=function(){this.generateVideoUrl(),this.videoNode?n.a.mobilepreload?w.a.removeFromLoadedQueue(this):this.cleanVideoNode(!1):n.a.allautoplay&&u.a.isIphone&&(this.hideGif(),this.generateGifUrl()),this.watcher&&(n.a.mobilepreload&&this.watcher.isCanPreload&&w.a.addToLoadedQueue(this,!1),this.watcher.isInViewport&&(n.a.allautoplay?u.a.isIphone?this.showGif():this.initOrReattachGallery(!0):w.a.addToViewportQueue(this,!1)))},t.prototype.checkOtherElementszIndex=function(){var e=this,t=this.galleryData.domObject.getElementsByTagName("*");[].forEach.call(t,function(t){var i=window.getComputedStyle(t);1!==t.nodeType||"absolute"!==i.position&&"relative"!==i.position||t.classList.contains("vilynx_registered")||t.classList.contains("supra-wrapper")||t.classList.contains("vilynx_mainImg")||""!==i.zIndex&&"1"!==i.zIndex&&"auto"!==i.zIndex||0===t.querySelectorAll(".vilynx_mainImg").length&&(e.logger.info("Absolute positioned element found, setting zIndex: 2"),t.style.zIndex="2")})},t.prototype.createVideoDom=function(){var e=document.createElement("video"),t=document.createElement("source");return t.src=this.videoData.sources.mp4.url,t.type=this.videoData.sources.mp4.mime,e.appendChild(t),e.poster=this.videoData.posterUrl,e.resolution=this.videoData.sources.mp4.resolution,e.setAttribute("playsinline","true"),e.muted=!0,n.a.previewdelay||n.a.mobilepreload||e.setAttribute("autoplay","true"),this.config.autoplayonce||e.setAttribute("loop","true"),e.countLoops=0,e.throttle=!1,e.style.visibility="hidden",e},t.prototype.showVideoNode=function(){var e=this;this.logger.info("Showing video node");var t=function(){if(n.a.allautoplay||w.a.elementHasToken(e)){if(e.videoNode)if(!n.a.allautoplay||e.watcher.isThresholdInViewport){(n.a.previewdelay||n.a.mobilepreload)&&(e.videoNode.parentNode||(e.videoNode=e._wrapperNode.querySelector("video")),e._timeouts.restartTimeout?clearTimeout(e._timeouts.restartTimeout):e.doReset(),e.videoNode.play());var i=e.galleryData.domObject.querySelector(".vilynx_wrapperImg");e.videoNode.style.visibility="visible",e.logger.info("Canplay callback, adding vilynx_fading class"),e.hideNodes([i,e._externalFadeNode]),e.videoNode.removeEventListener("canplaythrough",t),e._timeouts.trackSummaryPlayTimeout&&clearTimeout(e._timeouts.trackSummaryPlayTimeout),e._timeouts.trackSummaryPlayTimeout=setTimeout(function(){e.logger.info("Analytics summary_play tracking"),e._hasSentPlayEvent||(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0),e._timeouts.trackSummaryPlayTimeout=null},e._analytics.summaryPlayTimeOut),e.config.mobilecta&&e.config.redirectafter&&(e._timeouts.redirectafterTimeout=setTimeout(function(){e.logger.info("Showing redirectWrapper after "+e.config.redirectafter+" milliseconds"),e._onVideoEnd.forEach(function(e){e()})},e.config.redirectafter))}else e.stopVideoPlaying()}else e.logger.info("Element doesn't have the token. Abort showVideoNode")};this.videoNode.readyState>3&&n.a.mobilepreload?t():n.a.previewdelay?setTimeout(function(){e.videoNode&&(e.videoNode.readyState>3||u.a.isIos?t():e.videoNode.addEventListener("canplaythrough",t))},1e3*n.a.previewdelay):(n.a.mobilepreload&&(0===this.videoNode.readyState?setTimeout(function(){e.videoNode&&w.a.elementHasToken(e)&&(e.logger.info("readyState 0 -> replaying"),e.videoNode.play())},500):setTimeout(function(){e.videoNode&&e.videoNode.play()},20)),this.videoNode.addEventListener("canplaythrough",t))},t.prototype.resizeVideoNode=function(){var e,t,i,o,n;if(!this.config.isDisabled){try{this.videoNode.childNodes[0]}catch(e){return void this.logger.info("Cant resize video node. The video node seems to not be created")}var r=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");r?(e=r.clientWidth,t=r.clientHeight,i=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),n="",0!==e&&0!==t&&(r.classList.contains("vilynx_img")?""!==r.style.backgroundImage&&(n=P.extractBGImageFromNode(r)):n=r.currentSrc||r.src,n&&i.src!==n&&(i.src=n),this.animateResize(null),u.a.isWindowsMobile&&(e/(o=this.videoData.is169?16/9:4/3)<t?(this.videoNode.style.height=t+"px",this.videoNode.style.width=t*o+"px",this.videoNode.style.left=(e-t*o)/2+"px",this.videoNode.style.top="0"):(this.videoNode.style.height=e/o+"px",this.videoNode.style.width=e+"px",this.videoNode.style.left="0",this.videoNode.style.top=(t-e/o)/2+"px")))):this.logger.error("Cant resize video node. No valid image found")}},t.prototype.animateResize=function(e){var t,i=this.reassignTargetImage();if(!i)return this.logger.error("No valid image found"),void this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide");t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg").getBoundingClientRect(),(!e||e.width!==t.width||e.height!==t.height)&&(e=P.getTargetImgSize(i),this.setWrapperResize(),window.requestAnimationFrame(this.animateResize.bind(this,e)))},t.prototype.setWrapperResize=function(){var e=this.reassignTargetImage();if(!e)return this.logger.error("No valid image found"),void this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide");this.setWrapperStyles();var t=P.getTargetImgSize(e);this._wrapperNode.style.width=t.width+"px",this._wrapperNode.style.height=t.height+"px",this._redirect&&(this._redirect.setHeight(t.height),this._redirect.setRedirectFontSize(e))},t.prototype.reassignTargetImage=function(){var e,t,i=this,o=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");if(!o){if(!(o=this.findMainImg()))return null;this.galleryData.domObject.querySelector(".vilynx_wrapperImg").src=o.src}if(e=o.clientWidth,t=o.clientHeight,0===e||0===t){this.logger.warn("vilynx_mainImg is too small '"+e+"x"+t+"' searching a new image");var n=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),r=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),s=void 0;if(!(s=P.findActiveImage(n)))return this._nTry<5&&setTimeout(function(){i._nTry++,i.animateResize(null)},200),null;o.classList.remove("vilynx_mainImg"),s.classList.add("vilynx_mainImg"),r.src=s.src,o=s,this.imageListeners(o),this.logger.warn("Found new valid image updated vilynx_mainImg & src")}return o},t.prototype.setWrapperStyles=function(){if(this.galleryData.domObject.querySelector(".supra-wrapper").classList.contains("vilynx-hide")&&(this.logger.warn("Supra-wrapper was hidden but now is shown again"),this.galleryData.domObject.querySelector(".supra-wrapper").classList.remove("vilynx-hide")),!this.galleryData.domObject.classList.contains("vilynx_mainImg")){var e=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),t=window.getComputedStyle(e);(t.cssFloat||t.cssFloat)&&(this._wrapperNode.style.cssFloat=t.cssFloat||t.cssFloat),t.margin?this._wrapperNode.style.margin=t.margin.replace(",","."):t.margin&&(this._wrapperNode.style.margin=t.margin.replace(",",".")),"none"===window.getComputedStyle(e.parentNode).maxHeight?this._wrapperNode.style.maxHeight="none":this._wrapperNode.style.maxHeight=window.getComputedStyle(e.parentNode).maxHeight}},t.prototype.createWrapperDom=function(){var e,t,i=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery),o=i[0];return o=P.findActiveImage(i)||o,e=document.createElement("div"),o.classList.add("vilynx_mainImg"),t=P.createCopyImage(this.findMainImg()),e.appendChild(t),this.galleryData.domObject.insertBefore(e,this.galleryData.domObject.childNodes[0]),e.classList.add("supra-wrapper"),this.checkOtherElementszIndex(),P.elementNeedsRelative(this.galleryData.domObject)&&(this.galleryData.domObject.style.position="relative"),e},t.prototype.findMainImg=function(){var e,t=P.getImageCandidates(this.galleryData.domObject,this._imgSelectorQuery);return(e=P.findActiveImage(t)||t[0])?(e.classList.add("vilynx_mainImg"),this.config.noimage&&e.classList.add("vilynx-hide"),this.imageListeners(e),e):null},t.prototype.responsiveListeners=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");window.addEventListener("resize",function(){e._deleted||e.requestPreviewResize()}),this.imageListeners(t),window.addEventListener("orientationchange",function(){e.requestPreviewResize()}),this._observers.imgRemovedObserver=new MutationObserver(function(){if(!(t=P.querySelectorInclusive(e.galleryData.domObject,".vilynx_mainImg"))){e.reassignTargetImage()&&e.requestPreviewResize()}}),this._observers.imgRemovedObserver.observe(t.parentNode,{childList:!0}),n.a.resizeonscroll&&window.addEventListener("scroll",function(){e._deleted||e.requestPreviewResize()})},t.prototype.imageListeners=function(e){var t=this;if(!this._observedImage||this._observedImage!==e){var i=new MutationObserver(function(){t.videoNode&&t.requestPreviewResize()});i.observe(e,{attributes:!0,characterData:!0}),this._observers.imageObserver&&this._observers.imageObserver.disconnect(),this._observers.imageObserver=i,this._observedImage=e,e.addEventListener("load",function(){t.logger.info("Image load event fired. Doing resize."),t.setWrapperResize()})}},t.prototype.requestPreviewResize=function(){var e=this;this._timeouts.resizeTimeout&&window.cancelAnimationFrame(this._timeouts.resizeTimeout),this._timeouts.resizeTimeout=window.requestAnimationFrame(function(){e.animateResize(null),e.resizeVideoNode()})},t.prototype.removeItem=function(){var e=this;this.logger.info("Removing Gallery Item..."),this.config.isDisabled=!0,this._deleted=!0,n.a.allautoplay&&u.a.isIphone?this.hideGif():(w.a.removeFromViewportQueue(this),n.a.mobilepreload&&w.a.removeFromLoadedQueue(this),this.galleryData.domObject.querySelector(".supra-wrapper")&&(this.galleryData.domObject.querySelector(".supra-wrapper").classList.add("vilynx-hide"),this.videoNode&&this._wrapperNode.removeChild(this.videoNode))),[].forEach.call(Object.keys(this._observers),function(t){e._observers[t].disconnect()}),[].forEach.call(Object.keys(this._timeouts),function(t){clearTimeout(e._timeouts[t])})},t.prototype.videoListeners=function(){var e=this,t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),i=this.videoNode;u.a.isIphone&&(i=this.videoNode.querySelector("source")),i.addEventListener("error",function(t){e.logger.error("Loading video node has produced an error. Stopping Gallery execution."),t.error&&e.logger.info("Error code: "+t.error.toString()),e._deleted||e.removeItem()}),0===this.config.duration&&this.videoNode.addEventListener("loadedmetadata",function(){e.videoNode&&(n.a.summaryplaytimeout>1e3*e.videoNode.duration&&(e._analytics.summaryPlayTimeOut=500,e._timeouts.trackSummaryPlayTimeout&&clearTimeout(e._timeouts.trackSummaryPlayTimeout)),e.logger.info("Video metadata ready, duration is: "+e.videoNode.duration),void 0!==e.videoNode.duration&&(e.config.duration=e.videoNode.duration))}),this.videoNode.addEventListener("timeupdate",function(){if(e.videoNode){var i=1e3*e.videoNode.currentTime;i>10&&(i<100*e.config.duration?e.videoNode.throttle&&(e.videoNode.throttle=!1,e.videoNode.countLoops+=1,e.logger.info("Loop count: "+e.videoNode.countLoops),e.config.mobilecta&&!e.config.redirectafter&&e.videoNode.countLoops===e.config.mobilectaloopcount&&(e.logger.info("Showing redirectWrapper"),e._onVideoEnd.forEach(function(e){e()})),e._onVideoLoop.forEach(function(t){t(e.galleryData.domObject,e.getCountLoops())})):e.videoNode.throttle=!0),e.config.autoplayonce&&e.config.fadeinadvance&&P.isNodeVilynxHidden(t)&&i+e.config.fadeinadvance>=1e3*e.videoNode.duration&&(e.logger.info("autoplayonce and fadeinadvance ("+e.config.fadeinadvance+"ms) set, hiding video node."),e.showNodes([t,e._externalFadeNode]),e.config.mobilecta&&!e.config.redirectafter&&(e.logger.info("Showing redirectWrapper"),e._onVideoEnd.forEach(function(e){e()})))}})},t.prototype.mouseClickListeners=function(){var e=this,t=this.galleryData.domObject;t.addEventListener("click",function(){if(e.config.isDisabled)e.logger.info("Element is disabled, ignore click event");else if(n.a.passivetracking&&!e._hasSentPlayEvent&&(e._analytics.trackSummaryPlay(e),e._hasSentPlayEvent=!0),e._analytics.trackVideoPlay(e,!1),r.a.getOnPreviewClick().forEach(function(t){t(e.galleryData.domObject)}),n.a.passivetracking&&e._hasSentPlayEvent&&(e._analytics.trackSummaryEnd(e),e._hasSentPlayEvent=!1),e.videoNode&&e.videoNode.currentTime){var t=e.videoNode.currentTime;t=e.videoNode.countLoops*e.config.duration+t,e.logger.info("EngagementTime: "+t+", countLoops: "+e.videoNode.countLoops),e._hasSentPlayEvent&&(e._analytics.trackSummaryEnd(e),e._hasSentPlayEvent=!1)}}),this.config.taptoplay&&(t.addEventListener("touchstart",function(){e.config.isDisabled?e.logger.info("Element is disabled, ignore tap event"):(e.logger.info("Tap to anchor. Showing video node"),e._tapedElementNotInQueue=!w.a.forceToken(e))}),t.addEventListener("touchmove",function(){e._tapedElementNotInQueue&&!e.config.isDisabled&&(e.logger.info("Element not in viewport yet"),e._tapedElementNotInQueue=!w.a.forceToken(e))}),t.addEventListener("touchend",function(){e._tapedElementNotInQueue=!1}))},t.prototype.wrapperImageListeners=function(){var e=this,t=this._wrapperNode.querySelector(".vilynx_wrapperImg");t.addEventListener("transitionend",function(){clearTimeout(e._timeouts.restartTimeout),t.classList.contains("vilynx_fading")||n.a.mobilepreload&&e.doReset()},!1)},t.prototype.doReset=function(){this.videoNode&&this.videoNode.readyState>0&&(this.videoNode.countLoops=0,this.videoNode.throttle=!1,this.videoNode.currentTime=0)},t.prototype.stopOrCleanVideoNode=function(){!n.a.passivetracking&&n.a.mobilepreload?this.stopVideoPlaying():this.cleanVideoNode(!1),clearTimeout(this._timeouts.trackSummaryPlayTimeout)},t.prototype.stopVideoPlaying=function(){var e=this;if(n.a.passivetracking&&this._hasSentPlayEvent)return this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1,!0;if(this._wrapperNode&&this.videoNode&&!this.videoNode.paused){var t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),i=this.videoNode.currentTime||0;this.logger.info("stop video playing (but the element "+this.logger.debugId+" still loaded)"),this.logger.info("Removing class vilynx_fading"),this.showNodes([t,this._externalFadeNode]),this.videoNode.pause(),this._hasSentPlayEvent&&(this._analytics.trackSummaryEnd(this),this._hasSentPlayEvent=!1),i=this.videoNode.countLoops*this.config.duration+i,this.logger.info("Mobile engagementTime: "+i+", countLoops: "+this.videoNode.countLoops),n.a.mobilepreload&&(clearTimeout(this._timeouts.restartTimeout),this._timeouts.restartTimeout=setTimeout(function(){e.doReset(),e._timeouts.restartTimeout=null},400))}n.a.mobilepreload&&this.config.mobilecta&&this._onVideoCancel.forEach(function(e){e()})},t.prototype.cleanVideoNode=function(e){var t=this,i=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.stopVideoPlaying(),clearTimeout(this._timeouts.redirectafterTimeout),this._timeouts.cleanVideonodeTimeput||(this._onVideoCancel.forEach(function(e){e()}),this._timeouts.cleanVideonodeTimeput=setTimeout(function(){t.logger.info("cleaning video node"),t.videoNode&&t._wrapperNode&&(t.videoNode.pause(),t._wrapperNode.removeChild(t.videoNode)),t.videoNode=null,t.config.mobilecta&&t._onVideoCancel.forEach(function(e){e()}),i&&t.showNodes([i]),e?w.a.playNextWithToken(c.a.scrollDirection):t.watcher.isThresholdInViewport||w.a.removeFromViewportQueue(t),t._timeouts.cleanVideonodeTimeput=void 0},200))},t.prototype.hideNodes=function(e){this.galleryData.domObject.classList.add("vilynx_activeSummary"),P.hideNodes(e)},t.prototype.showNodes=function(e){this.galleryData.domObject.classList.remove("vilynx_activeSummary"),P.showNodes(e)},t.prototype.reAttachVideoNode=function(e){this.generateVideoUrl(),this.videoNode=this.createVideoDom(),void 0===this._wrapperNode&&(this._wrapperNode=this.galleryData.domObject.querySelector(".supra-wrapper")),this._wrapperNode.appendChild(this.videoNode),this.resizeVideoNode(),e&&this.showVideoNode(),this.videoListeners(),this.responsiveListeners()},t.prototype.showGif=function(){var e,t=this.galleryData.domObject.querySelectorAll("img:not(.vilynx_wrapperImg)");if(t)if(e=t[t.length-1])this._oldImageUrl=e.src,n.a.customimgsrc&&e[n.a.customimgsrc]?(this._oldImageUrl=e.src,e[n.a.customimgsrc]=this._gifUrl):e.src=this._gifUrl;else{var i=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");this._oldImageUrl=P.extractBGImageFromNode(i),i.style.backgroundImage='url("'+this._gifUrl+'")'}else this.logger.error("No valid image found, gif cannot be shown")},t.prototype.hideGif=function(){var e,t=this.galleryData.domObject.querySelectorAll("img:not(.vilynx_wrapperImg)");if(t)if((e=t[t.length-1])&&n.a.customimgsrc&&e[n.a.customimgsrc])e[n.a.customimgsrc]=this._oldImageUrl;else if(e)e.src=this._oldImageUrl;else{P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg").style.backgroundImage='url("'+this._oldImageUrl+'")'}else this.logger.error("No valid image found, gif cannot be hidden")},t.prototype.generateGifUrl=function(){var e,t=c.a.serverUrl.slice(4),i="";e=n.a.directurl?"direct/"+n.a.publickey+"/"+this.galleryData.vilynxData.externalId:this.galleryData.vilynxData.hash,i=n.a.smallgif?"//public."+t+"/"+e+"/pro69.viwindow_xs.gif":"//public."+t+"/"+e+"/pro69.viwindow.gif",i+="?owner="+n.a.publickey,this._gifUrl=i},t}(j),Y=function(){return function(){}}(),Z=function(){return function(){}}(),$=new(function(){function e(){}return e.prototype.setCurrentItem=function(e){this.currentGalleryItem?(this._moveVideoNode(this.currentGalleryItem,e),this.currentGalleryItem=e):(this._videoDom=this._createVideoDom(e),this.currentGalleryItem=e,this.currentGalleryItem.wrapperNode.appendChild(this._videoDom),this.currentGalleryItem.videoNode=this._videoDom)},e.prototype._moveVideoNode=function(e,t){t.wrapperNode.appendChild(this._videoDom),e.videoNode=null,t.videoNode=this._videoDom,this._videoDom.pause(),this._videoDom.setAttribute("src",t.videoData.sources._mp4.url),this._videoDom.load()},e.prototype._createVideoDom=function(e){var t=document.createElement("video"),i=document.createElement("source");return i.src=e.videoData.sources.mp4.url,i.type=e.videoData.sources.mp4.mime,t.appendChild(i),t.poster=e.videoData.posterUrl,t.resolution=e.videoData.sources.mp4.resolution,t.preload="none",t.muted=!e.config.audio,t.countLoops=0,t.throttle=!1,t},e}()),ee=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),te=function(e){function t(t){return e.call(this,t)||this}return ee(t,e),t.prototype.init=function(){this._observers=new W,this._timeouts=new q,this._analytics=new m,P.querySelectorInclusive(this.galleryData.domObject,".vilynx_img")?this._imgSelectorQuery=".vilynx_img":this._imgSelectorQuery="img:not(.vilynx_wrapperImg)",this._onVideoEnd=[],this._onVideoCancel=[],this._wrapperNode=null,this.observeVilynxId(),n.a.optimizely&&n.a.optimizelyoff||n.a.passivetracking||this.monitorizeDesktop()},t.prototype.monitorizeDesktop=function(){var e=this;this._externalFadeNode=null,this.config.externalfading&&(this._externalFadeNode=document.querySelector('[data-vilynx-fadingid="'+this.galleryData.extractedUrl+'"], [vilynx-fadingid="'+this.galleryData.extractedUrl+'"]'),this._externalFadeNode||this.logger.warn("No node found on document with the attr [data-]vilynx-fadingid="+this.galleryData.extractedUrl));var t=200;n.a.aggressivelazy&&(t=1e3),(void 0===window.scrollMonitor||!window.scrollMonitor.version||window.scrollMonitor.version<b.version)&&b.reFactory(),this.watcher=window.scrollMonitor.create(this.galleryData.domObject,t),this.watcher.enterViewport(function(){e.config.isDisabled||e.attachVideoNode()}),this.watcher.exitViewport(function(){e.config.isDisabled||(clearTimeout(e._timeouts.waitToLoadTimeout),e._wrapperNode&&e.videoNode&&(e.logger.info("Exiting Viewport"),e.doExitViewport()))})},t.prototype.attachVideoNode=function(){try{var e=this.galleryData.domObject.classList.contains("vilynx_registered");if(this.config.isDisabled)return void this.logger.warn("This element is disabled. Ignore enterViewport event");e?!e||this.videoNode&&!this.videoNode.paused||(this.logger.info("autoplayOrAttachVideoNode again"),this.autoplayOrAttachVideoNode()):(this.logger.info("Entering viewport for first time"),this.initGallery(),this._analytics.trackThumbnailShown(this))}catch(e){this.logger.error("Exception raised while processing the gallery attachVideoNode. Aborting item execution. Stack trace:"),this.logger.error(e)}},t.prototype.initGallery=function(){if(this.galleryData.domObject.classList.add("vilynx_registered"),this._elementsToIgnore=[],n.a.divignore&&!this.config.autoplay){var e=this.galleryData.domObject;if(n.a.divignorelevels)for(var t=0;t<parseInt(n.a.divignorelevels,10);t++)e=e.parentNode;this._elementsToIgnore=e.querySelectorAll(n.a.divignore)}this.generateVideoUrl(),this._wrapperNode=this.createWrapperDom(),this.setWrapperResize(),this.setWrapperResize(),P.elementNeedsRelative(this.galleryData.domObject)&&(this.galleryData.domObject.style.position="relative"),this.config.autoplay&&this.logger.warn("VIZO platform only allows one video a a time, All autoplay is impossible"),this.wrapperImageListeners(),this.videoListeners(),!this.config.redirect||this.config.autoplay&&!this.config.redirectautoplay||(this._redirect=new C(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this.config.redirectwithclick&&this.config.audiopolicycta?this._onVideoEnd.push(this._redirect.checkAudioPolicy.bind(this._redirect)):this._onVideoEnd.push(this._redirect.showRedirectWrapperCountDown.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect))),P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg").classList.contains("vilynx_img")?this.observeBackgroundImage():this.observeOriginalImage(),this.addConfigListener(),this.resizeVideoNode(),this.responsiveListeners()},t.prototype.doExitViewport=function(){var e=this;if(this.config.autoplay&&!this.config.isDisabled)try{this.videoNode.readyState>0?this.videoNode.pause():setTimeout(function(){e.logger.info("Video ready state is 0. Pause can't be done. Retrying 10ms later"),e.videoNode.pause()},10)}catch(e){this.logger.info("Pause action failed.")}else this.config.isStopped||this.cleanVideoNode()},t.prototype.cleanVideoNode=function(){this._wrapperNode&&this.videoNode&&this.videoNode.parentElement===this._wrapperNode&&(this._wrapperNode.removeChild(this.videoNode),this.videoNode=null)},t.prototype.autoplayOrAttachVideoNode=function(){var e=this;if(this.config.autoplay)try{this.videoNode.play().catch(function(t){e.logger.warn("Play action failed."),e.logger.warn(t)})}catch(e){this.watcher.destroy(),this.logger.warn("This element had a huge issue trying to do the play. Destroying watcher listeners ")}},t.prototype.resizeVideoNode=function(){if(!this.config.isDisabled){try{this.videoNode.childNodes[0]}catch(e){return void this.logger.info("Cant resize video node. The video node seems to not be created")}var e=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");if(e){var t,i=e.clientWidth,o=e.clientHeight,n=this.galleryData.domObject.querySelector(".vilynx_wrapperImg"),r="";0!==i&&0!==o&&(e.classList.contains("vilynx_img")?""!==e.style.backgroundImage&&(r=P.extractBGImageFromNode(e)):r=e.currentSrc||e.src,r&&n.src!==r&&(n.src=r),this.setWrapperResize(),i/(t=this.videoData.is169&&!1===this.config.isVertical?16/9:4/3)<o&&!1===this.config.isVertical?(this.videoNode.style.height=o+"px",this.videoNode.style.width=o*t+"px",this.videoNode.style.left=(i-o*t)/2+"px",this.videoNode.style.top="0"):(this.videoNode.style.height=i/t+"px",this.videoNode.style.width=i+"px",this.videoNode.style.left="0",this.videoNode.style.top=(o-i/t)/2+"px",this.config.isVertical&&this.config.videoRatio&&(this.videoNode.style.height=i/this.config.videoRatio+"px",this.videoNode.style.top=Math.round((o-i/this.config.videoRatio)/2)+"px")),this._redirect&&this._redirect.setRedirectFontSize(e))}else this.logger.error("Cant resize video node. No valid image found")}},t.prototype.createWrapperDom=function(){var e,t;return e=document.createElement("div"),t=P.createCopyImage(this.findMainImg()),e.appendChild(t),this.galleryData.domObject.insertBefore(e,this.galleryData.domObject.childNodes[0]),e.classList.add("supra-wrapper"),this.checkOtherElementszIndex(),e},t.prototype.refreshVideoNode=function(){this.enableNow(),this.videoNode&&this.cleanVideoNode(),this.autoplayOrAttachVideoNode()},t.prototype.playVideo=function(e){var t=this;e.parentElement.classList&&e.parentElement.classList.contains("vilynx-hide")&&this.setWrapperResize(),this.resizeVideoNode(),this.videoNode.muted=!this.config.audio,P.hideNodes([e,this._externalFadeNode]),clearTimeout(this._timeouts.restartTimeout),this.logger.info("Video play");try{var i=this.videoNode.play();i&&i.catch(function(i){t.logger.info("An error has been captured while playing video. "+i.name+": "+i.message),t.config.audio&&t.videoNode&&0===i.code&&(t.config.audio=!1,t.playVideo(e))})}catch(e){this.logger.info("Play action failed.")}r.a.getOnPlay().forEach(function(e){e()})},t.prototype.setVideoAutoplay=function(){var e=this;$.setCurrentItem(this);var t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.resizeVideoNode(),this.videoNode.loop=!this.config.autoplayonce,this.config.redirectautoplay&&this.videoNode.duration&&!this.config.redirectafter&&(this.config.redirectafter=1e3*this.videoNode.duration),this.videoNode.muted=!0,window.setTimeout(function(){e.videoNode&&e.videoNode.play().then(function(){P.hideNodes([t,e._externalFadeNode])}).catch(function(t){e.logger.warn("Play action failed."),e.logger.warn(t)})},100),this.logger.info("Autoplay video starts to play")},t.prototype.responsiveListeners=function(){var e=this,t=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg");window.addEventListener("resize",function(){e._deleted||e.requestPreviewResize()}),this.imageListeners(t),this._observers.imgRemovedObserver=new MutationObserver(function(){if(!(t=P.querySelectorInclusive(e.galleryData.domObject,".vilynx_mainImg"))){e.reassignTargetImage()&&(e.setWrapperResize(),e.resizeVideoNode())}}),this._observers.imgRemovedObserver.observe(t.parentNode,{childList:!0}),this._observers.supraWrapperRemoved=new MutationObserver(function(){e.galleryData.domObject&&e.galleryData.domObject.querySelector(".supra-wrapper")||(e.logger.error("Supra-wrapper has been removed. Removing Gallery Item"),e.removeItem())}),this._observers.supraWrapperRemoved.observe(this.galleryData.domObject,{childList:!0}),n.a.resizeonscroll&&window.addEventListener("scroll",function(){e._deleted||e.requestPreviewResize()})},t.prototype.setWrapperStyles=function(){if(this.galleryData.domObject.querySelector(".supra-wrapper")&&(this.galleryData.domObject.querySelector(".supra-wrapper").classList.contains("vilynx-hide")&&(this.logger.warn("Supra-wrapper was hidden but now is shown again"),this.galleryData.domObject.querySelector(".supra-wrapper").classList.remove("vilynx-hide"),this.config.autoplay&&this.setVideoAutoplay()),!this.galleryData.domObject.classList.contains("vilynx_mainImg"))){var e=P.querySelectorInclusive(this.galleryData.domObject,".vilynx_mainImg"),t=window.getComputedStyle(e);t.cssFloat&&(this._wrapperNode.style.cssFloat=t.cssFloat),t.marginLeft||t.marginRight||t.marginTop||t.marginBottom?(this._wrapperNode.style.marginLeft=t.marginLeft,this._wrapperNode.style.marginRight=t.marginRight,this._wrapperNode.style.marginTop=t.marginTop,this._wrapperNode.style.marginBottom=t.marginBottom):t.margin&&(this._wrapperNode.style.margin=t.margin.replace(",",".")),this._wrapperNode.style.maxHeight=window.getComputedStyle(e.parentElement).maxHeight}},t.prototype.mouseClickListeners=function(){},t.prototype.onMouseClick=function(e){},t.prototype.videoListeners=function(){var e=this;if(this.videoNode){var t=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.videoNode.addEventListener("error",function(t){e.logger.error("Loading video node has produced an error. Stopping Gallery execution."),t.error&&e.logger.info("Error code: "+t.error.toString()),e._deleted||e.removeItem()}),0===this.config.duration&&this.videoNode.addEventListener("loadedmetadata",function(){e.videoNode&&(n.a.summaryplaytimeout>1e3*e.videoNode.duration&&(e._analytics.summaryPlayTimeOut=500),e.logger.info("Video metadata ready, duration is: "+e.videoNode.duration),e.config.duration=e.videoNode.duration,e.config.autoplay&&!e.config.redirectafter&&(e.config.redirectafter=1e3*e.videoNode.duration),e.config.videoRatio=e.videoNode.videoWidth/e.videoNode.videoHeight,e.config.videoRatio<1&&(e.logger.info("Video vertical found!"),e.config.isVertical=!0,e.setWrapperResize(),e.resizeVideoNode()))}),this.videoNode.addEventListener("timeupdate",function(){if(e.videoNode){var i=1e3*e.videoNode.currentTime;i>10&&(i<100*e.config.duration?e.videoNode.throttle&&(e.videoNode.throttle=!1,e.videoNode.countLoops+=1,e.logger.info("Loop count: "+e.videoNode.countLoops)):e.videoNode.throttle=!0),e.config.autoplayonce&&e.config.fadeinadvance&&P.isNodeVilynxHidden(t)&&i+e.config.fadeinadvance>=1e3*e.videoNode.duration&&(e.logger.info("autoplayonce and fadeinadvance ("+e.config.fadeinadvance+"ms) set, hiding video node."),P.showNodes([t,e._externalFadeNode])),e._redirect&&e._redirect.timeToRedirect&&!e._redirect.redirecting&&(e.videoNode.countLoops===e._redirect.loopToRedirect&&i>=e._redirect.timeToRedirect||e.videoNode.countLoops>e._redirect.loopToRedirect)&&(e.logger.info("Redirect after fired at "+1e3*e.videoNode.currentTime+"ms,\n                            Showing redirect wrapper"),e._redirect.timeToRedirect=null,e._onVideoEnd.forEach(function(e){e()}))}}),this.videoNode.addEventListener("ended",function(){if(e.videoNode.muted=e.config.audioonce||!e.config.audio,!e.config.autoplay){e.videoNode.currentTime=0;try{e.videoNode.play().catch(function(t){e.logger.warn("Play action failed."),e.logger.warn(t)})}catch(t){e.logger.info("Play action failed.")}e.config.redirectafter||e.galleryData.domObject.classList.contains("vilynx_no-redirect")||(e.logger.info("Video Ended, calling onEnd function stack"),e._onVideoEnd.forEach(function(e){e()}))}})}},t.prototype.ignoreElementListeners=function(e){},t.prototype.addConfigListener=function(){var e,t,i,o=this;e=this.galleryData.domObject.classList.value,this._oldClasses=e?e.split(" "):null,t=this.galleryData.domObject,i={attributeOldValue:!0,attributes:!0,characterData:!1,childList:!1,subtree:!1},this._observers.configListener=new MutationObserver(function(e){var t=o.extractClassChanges(),i=P.extractAttributeChanges(o.galleryData.domObject,e),n={additions:t.additions.concat(i.additions),removals:t.removals.concat(i.removals)};o.manageConfigChanges(n)}),this._observers.configListener.observe(t,i)},t.prototype.extractClassChanges=function(){var e,t,i;return t=(e=this.galleryData.domObject.classList.value)?e.split(" "):"",i=P.getArrayChanges(this._oldClasses,t),this._oldClasses=t,i},t.prototype.manageConfigChanges=function(e){(e.additions.length||e.removals.length)&&(this.logger.info("Configuration changed:\n                        Additions: "+e.additions+"\n                        Removals: "+e.removals),this.config.autoplay&&-1!==e.removals.indexOf("vilynx_autoplay")?(this.logger.info("vilynx_autoplay class removed: Disable autoplay"),this.disableAutoplay()):this.config.autoplay||-1===e.additions.indexOf("vilynx_autoplay")||(this.logger.info("vilynx_autoplay class added: Enable autoplay"),this.enableAutoplay()),this.config.autoplay&&(!this.config.autoplayonce||this.config.autoplayonce&&!this.isOneLoopAutoplayVideoFinished())&&(this.config.isDisabled&&-1!==e.removals.indexOf("vilynx_stop")?(this.logger.info("vilynx_stop class removed: Replaying video"),this.unStopVideo()):this.config.isDisabled||-1===e.additions.indexOf("vilynx_stop")||(this.logger.info("vilynx_stop class added: Stops video"),this.stopVideo())),this.config.audiohover&&-1!==e.removals.indexOf("vilynx_audiohover")?(this.logger.info("vilynx_audiohover class removed"),this.config.audiohover=!1):this.config.audiohover||-1===e.additions.indexOf("vilynx_audiohover")||(this.logger.info("vilynx_audiohover class added"),this.config.audiohover=!0),n.a.disableall?this.config.isDisabled?-1===e.additions.indexOf("vilynx_enabled")&&-1===e.additions.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class added: Enable Gallery item"),this.enableNow()):-1===e.removals.indexOf("vilynx_enabled")&&-1===e.removals.indexOf("teaser_enabled")||(this.logger.info("vilynx_enabled/teaser_enabled class removed: Disable Gallery item"),this.disableNow()):this.config.isDisabled?-1!==e.removals.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class removed: Enable Gallery item"),this.enableNow()):-1!==e.additions.indexOf("vilynx_disabled")&&(this.logger.info("vilynx_disabled class added: Disable Gallery item"),this.disableNow()))},t.prototype.enableNow=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");this.config.isDisabled=!1,this.watcher.isInViewport&&this.autoplayOrAttachVideoNode(),this.config.autoplay&&P.hideNodes([e,this._externalFadeNode])},t.prototype.enableAutoplay=function(){if(this.config.autoplay=!0,this._redirect&&!this.config.redirectautoplay&&(this._wrapperNode.removeChild(this._redirect.redirectDom),this._redirect=null),this.watcher.isInViewport)this.setVideoAutoplay();else if(this._wrapperNode){this.generateVideoUrl(),$.setCurrentItem(this),this.resizeVideoNode(),this.videoListeners();var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");P.hideNodes([e,this._externalFadeNode])}},t.prototype.disableAutoplay=function(){var e=this.galleryData.domObject.querySelector(".vilynx_wrapperImg");if(this.config.autoplay=!1,P.showNodes([e,this._externalFadeNode]),this.config.redirect&&(this._redirect=new C(this,this._analytics),this._wrapperNode.appendChild(this._redirect.createRedirectDom()),this.config.redirectwithclick&&this.config.audiopolicycta?this._onVideoEnd.push(this._redirect.checkAudioPolicy.bind(this._redirect)):this._onVideoEnd.push(this._redirect.showRedirectWrapperCountDown.bind(this._redirect)),this._onVideoCancel.push(this._redirect.hideRedirectWrapper.bind(this._redirect)),this._redirect.setRedirectFontSize(e)),n.a.divignore){var t=this.galleryData.domObject;if(n.a.divignorelevels)for(var i=0;i<parseInt(n.a.divignorelevels,10);i++)t=t.parentNode;this._elementsToIgnore=t.querySelectorAll(n.a.divignore)}},Object.defineProperty(t.prototype,"wrapperNode",{get:function(){return this._wrapperNode},set:function(e){this._wrapperNode=e},enumerable:!0,configurable:!0}),t}(U),ie=new(function(){function e(){this._browser=u.a,this._logger=new a.a("[vlx_dbg]"),this._domElementsArray=[],this._preparedDomElementsArray=[],this._finderTimeout=!0,this._mixPanel=!1}return e.prototype.softScan=function(e){var t=this,i=[];[].forEach.call(e,function(e){var o=[];e&&e.tagName?e.classList.contains("vilynx_registered")||e.classList.contains("supra-wrapper")?t._logger.warn("This new node is a gallery registered element (target have class vilynx_registered, supra-wrapper): "+e):e.classList.contains("vilynx_disabled")||e.classList.contains("vilynxignore")||e.closest(".vilynxignore")?t._logger.warn("This new node is a disabled element hasclass vilynx_disabled OR vilynxignore): "+e):(e.matches(t._selectorQuery)&&o.push(e),o=o.concat([].slice.call(e.querySelectorAll(t._selectorQuery))),[].forEach.call(o,function(e){var t=d.findElementWithBg(e),o=[].slice.call(e.querySelectorAll("img"));!e.closest(".vilynxignore")&&(o&&o.some(function(e){return!e.matches(n.a.imgignore)})||t)&&i.push(e)})):t._logger.warn("This new node is not a valid element (tag have not a name): "+e)}),e=[],0!==i.length&&(this._logger.info("New soft scan invoked"),this._logger.info(i),this.privateScan(null,i,null,null))},e.prototype.privateScan=function(e,t,i,o){var r,s=this;if(o&&(this._selectorQuery=o),e?(this._logger.info('Starting Scan with query: "'+this._selectorQuery+'" over the element '+e.nodeName),r=e.querySelectorAll(this._selectorQuery),[].forEach.call(r,function(e){var t=d.findElementWithBg(e),i=[].slice.call(e.querySelectorAll("img")),o=new Z;e.closest(".vilynxignore")||!(i&&i.some(function(e){return!e.matches(n.a.imgignore)})||t)||s._domElementsArray.some(function(t){return t.domObject===e})||(o.domObject=e,n.a.directurl&&(o.vilynxData=new Y,o.vilynxData.externalId=d.exctractIdAttribute(e)),s._domElementsArray.push(o))})):t&&(this._logger.info("Pushing "+t.length+" elements to the extractor"),[].forEach.call(t,function(e){var t=new Z;t.domObject=e,t.galleryItem=i,n.a.directurl&&(t.vilynxData=new Y,t.vilynxData.externalId=d.exctractIdAttribute(e)),s._domElementsArray.some(function(e){return e.domObject===t.domObject})||s._domElementsArray.push(t)})),this._logger.info("----- SCAN RESULT ------"),this._logger.info("Found "+this._domElementsArray.length+" elements"),this._logger.info("/----- SCAN RESULT ------/"),0!==this._domElementsArray.length)if(n.a.directurl)for(var a=this._domElementsArray.length-1;a>=0;a--)this.createGalleryItem(this._domElementsArray[a]),this._domElementsArray.splice(a,1);else this._finderTimeout&&(this._finderTimeout=!1,this.getHashesDebounce())},e.prototype.getHashesDebounce=function(){var e=this,t=setTimeout(function(){e.prepareGetHashes(),e._finderTimeout=!0,clearTimeout(t)},250)},e.prototype.prepareGetHashes=function(){var e=this;this.extractor(),0===this._preparedDomElementsArray.length?this._logger.info("All valid domElements were removed by extractor. Prevent call to get_hashes"):(this._logger.info("Call to get_hashes with "+this._preparedDomElementsArray.length+" elements"),this.getHashes(function(t){var i=JSON.parse(t);i.hashes.forEach(function(e){e.url=e.url[0],e.hash=e.hash[0],e.title?e.title=e.title[0]:e.title=""}),e._preparedDomElementsArray.forEach(function(e){i.hashes.forEach(function(t){t.url!==e.extractedUrl&&t.url.slice(0,-1)!==e.extractedUrl&&t.url!==e.extractedUrl.slice(0,-1)||(e.vilynxData=t)})});for(var o=e._preparedDomElementsArray.length-1;o>=0;o--){var n=e._preparedDomElementsArray[o];n.vilynxData&&e.createGalleryItem(n),e._preparedDomElementsArray.splice(o,1)}},0))},e.prototype.createGalleryItem=function(e){if(e.galleryItem)e.galleryItem.galleryData.vilynxData=e.vilynxData,e.galleryItem.refreshVideoNode();else try{var t=void 0;(t=u.a.isMobile?new X(e):n.a.viziodevice?new te(e):new U(e)).init(),r.a.galleryItems.push(t)}catch(e){this._logger.error("Exception raised while processing the gallery item. Aborting item execution. Stack trace:"),this._logger.error(e)}},e.prototype.extractor=function(){var e=new RegExp(n.a.urlregexp),t=window.location.host+window.location.pathname;!n.a.ignorecurrenturl||void 0!==this._currentUrl&&t.match(this._currentUrl)||(this._currentUrl=new RegExp("^(http:|https:)?(//)?("+t.replace(new RegExp("/$"),"")+")(/)?$"));for(var i=this._domElementsArray.length-1;i>=0;i--){var o=this._domElementsArray[i];if(void 0===o.extractedUrl){var r,s=o.domObject,a=void 0;(r=d.exctractIdAttribute(s))?a=r:!n.a.ignorehref&&"a"===s.localName&&s.attributes.href&&(a=s.href),n.a.urlregexp&&a&&(a=a.replace(e,"")),n.a.ignorecurrenturl&&a&&a.match(this._currentUrl)&&(this._logger.warn("url matches with current url. Removing from array"),a=""),a?(o.extractedUrl=a,this._preparedDomElementsArray.push(o)):(this._logger.warn("Can't find URL for dom node. Removing from array"),this._logger.warn(s)),this._domElementsArray.splice(i,1)}}this._logger.info("Extractor job done. Got "+this._preparedDomElementsArray.length+" Items"),this._logger.debug(this._preparedDomElementsArray)},e.prototype.getHashes=function(e,t){var i=this,o="//"+c.a.serverUrl+"/get_hashes.php",r={owner:n.a.publickey,title:"",url:""},s=new l;this._preparedDomElementsArray.forEach(function(e){r.url+=e.extractedUrl+","}),s.post(o,"",r).then(function(t){e(t)}).catch(function(o){i._preparedDomElementsArray=[],o&&((t+=1)<=c.a.maxRetries?(i._logger.warn("Error executing XHR to  get_hashes, retry in "+c.a.retryTime+" ( Retry "+t+" of "+c.a.maxRetries+" )"),setTimeout(function(){i.getHashes(e,t)},c.a.retryTime)):i._logger.error("FUBAR: Can't  get video hashes. Aborting"))})},e}()),oe=function(){return function(){}}(),ne=function(){function e(){this._logger=new a.a("[vlx_dbg]"),this._logger.debug("Listener class initialized"),this._finder=ie,this._validItemsQuerySelector=this.buildValidItemsSelector(),ie.privateScan(document,null,null,this._validItemsQuerySelector),this._mutationTarget=document.querySelector("body"),this._mutationObserverSettings=new oe,this._mutationObserverSettings.childList=!0,this._mutationObserverSettings.attributes=!1,this._mutationObserverSettings.characterData=!1,this._mutationObserverSettings.subtree=!0,this._mutationObserverSettings.attributeOldValue=!1,this._ignoreElementsQuery=".supra-wrapper",n.a.ignoreparentelement&&d.validateQuery(n.a.ignoreparentelement)&&(this._ignoreElementsQuery+=", "+n.a.ignoreparentelement),this.addEs6DomChangesListener(),this.vilynxEnabledListener(),this.vilynxConfigListener()}return e.prototype.buildValidItemsSelector=function(){var e,t=":not(.vilynxignore):not(.vilynx_registered):not(.vilynx_disabled)",i="[vilynx-id]"+t+", [data-vilynx-id]"+t;return n.a.idattribute&&(i+=", ["+n.a.idattribute+"]"+t),e="a"+t+", "+i,n.a.directurl&&n.a.disableall?(e=".vilynx_enabled[vilynx-id]"+t+", .teaser_enabled[vilynx-id]"+t+", .vilynx_enabled[data-vilynx-id]"+t+", .teaser_enabled[data-vilynx-id]"+t,n.a.idattribute&&(e+=", .vilynx_enabled["+n.a.idattribute+"]"+t+", .teaser_enabled["+n.a.idattribute+"]"+t)):n.a.directurl?e=i:n.a.disableall&&(e=".vilynx_enabled"+t+", .teaser_enabled"+t),e},e.prototype.addEs6DomChangesListener=function(){var e=this;this._logger.debug("Adding ES6 MutationObserver"),new MutationObserver(function(t){var i=[],o=[];t.forEach(function(t){Array.prototype.slice.call(t.addedNodes).forEach(function(t){if((t.classList&&t.classList.contains("vilynx_enabled")||t.childElementCount)&&!t.closest(e._ignoreElementsQuery)&&(i.push(t),t.querySelectorAll(".vilynx_enabled").length>0||t.classList.contains("vilynx_enabled"))){if(t.classList.contains("vilynx_enabled"))o.push(t);else{var n=Array.prototype.slice.call(t.querySelectorAll(".vilynx_enabled"));o=o.concat(n)}e.vilynxEnabledListener(o)}})}),e._finder.softScan(i)}).observe(this._mutationTarget,this._mutationObserverSettings)},e.prototype.vilynxEnabledListener=function(e){var t,i=this,o=[];t=void 0!==e?e:document.querySelectorAll(".vilynx_enabled:not(.vilynxignore):not(.vilynx_registered):not(.vilynx_disabled)"),Array.prototype.forEach.call(t,function(e){var t=!e.getAttribute("vilynx-id")&&!e.getAttribute("data-vilynx-id")&&(!n.a.idattribute||!e.getAttribute(n.a.idattribute))||e.attributes.getNamedItem("href"),r=[].slice.call(e.querySelectorAll("img")),s=!(r.length&&r.some(function(e){return!e.matches(n.a.imgignore)})||d.findElementWithBg(e));if(e&&(t||s)&&e.classList&&!e.classList.contains("vilynx_observe")){var a=new MutationObserver(function(){var t=[];e.classList&&!e.classList.contains("vilynx_registered")&&(t.push(e),i._finder.softScan(t),i._logger.debug("vilynx_observe element configuration has changed. Adding it to the finder."))}),l=new oe;l.childList=!1,l.subtree=!1,l.attributes=!0,l.characterData=!1,t&&(o.push("vilynx-id","data-vilynx-id","href"),n.a.idattribute&&o.push(n.a.idattribute)),s&&(o.push("style"),l.subtree=!0,l.childList=!0),l.attributeFilter=o,a.observe(e,l),e.classList.add("vilynx_observe")}})},e.prototype.vilynxConfigListener=function(){var e=this,t=c.a.scriptTag;new MutationObserver(function(i){i.forEach(function(i){var o,r=i.attributeName,s=t.getAttributeNode(r);s&&(r=r.replace("data-",""),void 0===n.a[r]?e._logger.warn("Config register not found: "+r):("true"===(o=s.nodeValue)?o=!0:"false"===o&&(o=!1),n.a[r]=o,e._logger.debug("Config element changed after loaded: "+r)))})}).observe(t,{attributes:!0,characterData:!1,childList:!1,subtree:!1})},e}();t.a=ne},function(e,t,i){"use strict";var o,n,r,s,a,l=i(9),c=i(3),d=(i(18),i(7));!function(e){e.mediaPlay="mediaPlay",e.mediaPause="mediaPause",e.mediaEnd="mediaEnd",e.mediaUpdate="mediaUpdate"}(o||(o={})),function(e){e.articleOpen="articleOpen",e.articleScroll="articleScroll"}(n||(n={})),function(e){e.mediaEvent="mediaEvent",e.textEvent="textEvent",e.galleryEvent="galleryEvent",e.recoEvent="recoEvent",e.hitEvent="hitEvent",e.loadEvent="loadEvent"}(r||(r={})),function(e){e.notSent="notSent",e.sending="sending",e.sent="sent"}(s||(s={})),function(e){e.pageLoad="pageLoad",e.spaNavigation="spaNavigation"}(a||(a={}));var u,h=i(10),p=function(){return function(e){this.message=e}}(),f=i(4),y=i(11),v=new(function(){function e(){this._isPluginReady=!1,this._apiBasePath="https://dagda.vilynx.com",this._pluginVersion="%%pluginVersion%%",this._uuid=y.a.get("vlx_uuid",f.a.plain)||Object(h.b)(),y.a.set("vlx_uuid",this._uuid,f.a.plain)}return Object.defineProperty(e.prototype,"isPluginReady",{get:function(){return this._isPluginReady},set:function(e){this._isPluginReady=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"apiBasePath",{get:function(){return this._apiBasePath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pluginVersion",{get:function(){return this._pluginVersion},enumerable:!0,configurable:!0}),e}()),_=new(function(){function e(){this._legacyMode=!0,navigator&&navigator.sendBeacon&&(this._legacyMode=!1)}return e.prototype.send=function(e){return this._legacyMode?this._gifSend(e):this._beaconSend(e)},e.prototype._beaconSend=function(e){return new Promise(function(t,i){navigator.sendBeacon(v.apiBasePath+"/b",'{"e":"'+e+'"}')?t():i()})},e.prototype._gifSend=function(e){return new Promise(function(t,i){var o=new Image;o.src=v.apiBasePath+"/b.gif?e="+e,o.style.display="none",o.style.visibility="hidden",o.addEventListener("load",t),o.addEventListener("error",i),document.body.appendChild(o)})},e}()),m=i(8);!function(e){e.enterViewport="enterViewport",e.mouseOver="mouseOver",e.click="click"}(u||(u={}));var g,b=function(){function e(e){if(this._sendAlone=!1,this._sendStatus=s.notSent,!e)throw new p("Event is required, none found on first parameter");this._evId=e._evId||Object(h.a)(8),this.url=e.url||window.location.href,this.originUrl=e.originUrl||document.referrer,this.publicKey=e.publicKey||d.a.publickey,this.eventTime=e.eventTime||+new Date}return e.prototype.canSend=function(){return this._sendStatus===s.notSent},e.prototype.isSent=function(){this._sendStatus=s.sent},e.prototype.getMeta=function(){return{GUID:this._evId,UA:navigator.userAgent,UUID:v.uuid,screen_size:window.screen.availHeight+"x"+window.screen.availWidth}},e.prototype.send=function(){var e=this;this.sending(),this._sendAlone=!0;var t=btoa(JSON.stringify(this));return _.send(t).then(function(){e.isSent()})},e.prototype.sending=function(){this._sendStatus=s.sending},e}(),w=new(function(){function e(){}return e.prototype.toSnake=function(e){return this._convertTo(e,!0)},e.prototype.toCamel=function(e){return this._convertTo(e,!1)},e.prototype._convertTo=function(e,t){if("string"==typeof e)return t?this._buildKeySnake(e):this._buildKeyCamel(e);if(Array.isArray(e))return t?e.map(this.toSnake,this):e.map(this.toCamel,this);if(e&&"object"==typeof e){var i={};for(var o in e){if(Object.hasOwnProperty.call(e,o))i[t?this._buildKeySnake(o):this._buildKeyCamel(o)]=t?this.toSnake(e[o]):this.toCamel(e[o])}return i}return e},e.prototype._buildKeyCamel=function(e){return e.replace(/_./g,function(e){return e.slice(1,2).toUpperCase()})},e.prototype._buildKeySnake=function(e){return e.replace(/(?!^)([A-Z])/g,function(e){return"_"+e.toLowerCase()}).toLowerCase()},e}()),O=(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),E=function(e){function t(t){var i=this;if(!t)throw new p("Event is required, none found on first parameter");return(i=e.call(this,t)||this)._guaranteeMediaEvent(t),i.eventCategory=r.mediaEvent,i.eventType=t.eventType,i.elementId=t.elementId,i.currentTime=t.currentTime,i}return O(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),current_time:w.toSnake(this.currentTime),element_id:this.elementId,event_id:this._evId,event_time:this.eventTime,event_type:w.toSnake(this.eventType),origin_url:this.originUrl,public_key:this.publicKey,url:this.url};return this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeMediaEvent=function(e){if(e.eventType in o==!1)throw new p('"event.eventType" must be one of the following: ('+Object.getOwnPropertyNames(o)+") ");if("string"!=typeof e.elementId)throw new p('"event.elementId" must be a string and a valid GUID.');if(isNaN(e.currentTime))throw new p('"event.currentTime" must be valid number.');if(e.url&&"string"!=typeof e.url)throw new p('"event.url" must be valid string.');return!0},t}(b),x=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),N=function(e){function t(t){var i=this;if(!t)throw new p("Event is required, none found on first parameter");return(i=e.call(this,t)||this)._guaranteeGalleryEvent(t),i.eventCategory=r.galleryEvent,i.eventType=t.eventType,i.previewHash=t.previewHash,i.currentTime=t.currentTime,i.isRedirect=t.isRedirect||!1,i.resolution=t.resolution,i.passiveTracking=t.passiveTracking,i}return x(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),current_time:this.currentTime,event_id:this._evId,event_time:this.eventTime,event_type:w.toSnake(this.eventType),origin_url:this.originUrl,passive_tracking:this.passiveTracking,preview_hash:this.previewHash,public_key:this.publicKey,resolution:this.resolution,url:this.url};return this.eventType===m.a.summaryClick&&(e.is_redirect=this.isRedirect),this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeGalleryEvent=function(e){if(e.eventType in m.a==!1)throw new p('"event.eventType" must be one of the following: ('+Object.getOwnPropertyNames(m.a)+") ");if("string"!=typeof e.previewHash)throw new p('"event.elementGuid" must be a string and a valid GUID.');if(isNaN(e.currentTime))throw new p('"event.currentTime" must be valid number.');if(e.url&&"string"!=typeof e.url)throw new p('"event.url" must be valid string.');if(e.isRedirect&&"boolean"!=typeof e.isRedirect)throw new p('"event.isRedirect" must be valid boolean.');if(e.resolution in m.b==!1)throw new p('"event.resolution" must be one of the following: ('+Object.getOwnPropertyNames(m.b)+") ");return!0},t}(b),P=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),D=function(e){function t(t){var i=e.call(this,t)||this;return i._guaranteeRecoEvent(t),i.eventCategory=r.recoEvent,i.eventType=t.eventType,i.elemHash=t.elemHash,i}return P(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),elem_hash:this.elemHash,event_id:this._evId,event_time:this.eventTime,event_type:w.toSnake(this.eventType),origin_url:this.originUrl,public_key:this.publicKey,url:this.url};return this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeRecoEvent=function(e){if(e.eventType in u==!1)throw new p('"event.eventType" must be one of the following: ('+Object.getOwnPropertyNames(u)+")");if("string"!=typeof e.elemHash)throw new p('"event.elemHash" must be a string and a valid GUID.');return!0},t}(b),A=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),S=function(e){function t(t){var i=this;if(!t)throw new p("Event is required, none found on first parameter");return(i=e.call(this,t)||this)._guaranteeTextEvent(t),i.eventCategory=r.textEvent,i.elementId=t.elementId,i.eventType=t.eventType,i.scrollPercentage=t.scrollPercentage,i}return A(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),element_id:this.elementId,event_id:this._evId,event_time:this.eventTime,event_type:w.toSnake(this.eventType),origin_url:this.originUrl,public_key:this.publicKey,scroll_percentage:this.scrollPercentage,url:this.url};return this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeTextEvent=function(e){if(e.eventType in n==!1)throw new p('"event.eventType" must be one of the following: ('+Object.getOwnPropertyNames(n)+")");if("string"!=typeof e.elementId)throw new p('"event.elementGuid" must be a string and a valid GUID.');if(isNaN(e.scrollPercentage))throw new p('"event.scrollPercentage" must be a number between 0 and 100.');return!0},t}(b),L=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),k=function(e){function t(t){var i=this;if(!t)throw new p("Event is required, none found on first parameter");return(i=e.call(this,t)||this)._guaranteeHitEvent(t),i.eventCategory=r.hitEvent,i.passiveTracking=t.passiveTracking,i.eventType=t.eventType,i}return L(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),event_id:this._evId,event_time:this.eventTime,event_type:w.toSnake(this.eventType),origin_url:this.originUrl,passive_tracking:this.passiveTracking,public_key:this.publicKey,url:this.url};return this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeHitEvent=function(e){if(e.eventType in a==!1)throw new p('"event.eventType" must be one of the following: ('+Object.getOwnPropertyNames(a)+") ");return!0},t}(b),I=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),T=function(e){function t(t){var i=this;if(!t)throw new p("Event is required, none found on first parameter");return(i=e.call(this,t)||this)._guaranteeHitEvent(t),i.pluginName=t.pluginName,i.pluginVersion=t.pluginVersion,i.eventCategory=r.loadEvent,i}return I(t,e),t.prototype.toJSON=function(){var e={category:w.toSnake(this.eventCategory),event_id:this._evId,event_time:this.eventTime,origin_url:this.originUrl,plugin_name:this.pluginName,plugin_version:this.pluginVersion,public_key:this.publicKey,url:this.url};return this._sendAlone?{_meta_:this.getMeta(),event:e}:e},t.prototype._guaranteeHitEvent=function(e){if(e.url&&"string"!=typeof e.url)throw new p('"event.url" must be valid string.');return!0},t}(b),j=new(function(){function e(){this.ua=navigator.userAgent.toLowerCase(),this.isMozilla=this._dr("firefox"),this.isWebkit=this._dr("webkit"),this.isOpera=this._dr("opera"),this.isMsie=this._dr("msie|trident|edge"),this.isIe=this._dr("trident"),this.isEdge=this._dr("edge"),this.isIe10=this._dr("msie"),this.isChrome=this._dr("chrome"),this.isAndroid=this._dr("android"),this.isIos=this._dr("iphone|ipad|ipod"),this.isIpad=this._dr("ipad"),this.isAndroidTablet=this.isAndroid&&this._dr("^mobile"),this.isTablet=this.isIpad||this.isAndroidTablet,this.isIphone=this._dr("iphone"),this.isOperaMini=this._dr("opera mini"),this.isWindowsMobile=this._dr("iemobile"),this.isKindle=this._dr("kindle|silk|kftt|kfot|kfjwa|kfjwi"),this.isMobile=this.isAndroid||this.isIos||this.isIphone||this.isOperaMini||this.isWindowsMobile||this.isKindle,this.isOldIphone=this.isIphone&&window.screen.height/window.screen.width==1.5&&window.devicePixelRatio<=2,this.isSafari=this._checkIsSafari()}return e.prototype._dr=function(e){return new RegExp(e).test(this.ua)},e.prototype._checkIsSafari=function(){var e;return!!this._dr("^((?!chrome).)*safari")&&(e=this.ua.search("version/"),parseInt(this.ua.substr(e+8,3),10))},e}()),M=function(){return function(e,t,i,o,n,r){this.GUID=e,this.UA=t,this.UUID=i,this.group_length=o,this.screen_size=r}}(),V=function(){function e(e,t){this.groupLength=0,this._logger=new c.a("[DAGDA_EV_Group]"),this.events=e,this.groupLength=this.events.length,this.creationTime=+new Date,this._guid=Object(h.a)(6),e.forEach(function(e){return e.sending()}),this._logger.info("New group created",this),this._meta_=t||this._defaultMeta()}return e.prototype.toJSON=function(){var e={};return this.events.forEach(function(t){try{e[t.eventCategory].push(t)}catch(i){e[t.eventCategory]=[t]}}),{_meta_:this._meta_,events:this.events}},e.prototype.sendGroup=function(){var e=btoa(JSON.stringify(this));return this._logger.info("Sending new event group",this.toJSON()),_.send(e)},e.prototype._defaultMeta=function(){return new M(this._guid,navigator.userAgent,v.uuid,this.groupLength,d.a.publickey,window.screen.availHeight+"x"+window.screen.availWidth)},e}(),R=function(){function e(){var e=this;this.events=[],this.initEvents=[],this._unsentEvents=0,this._logger=new c.a("[DAGDA_Session]"),0!==d.a.sendDelay?(this._logger.info("Timeout to send events set to "+d.a.sendDebounce),this._savePreviousSessionEvents(),this.sendEvents(),this._clearUnsent(),setTimeout(function(){setInterval(function(){e.sendEvents().then(function(){}).catch(function(){e._logger.info("No events to send")})},d.a.sendDelay)},d.a.sendDebounce)):this._logger.info("Send delay is set to 0, dagda session is useless");var t=function(){e._storeUnsent(),e.sendEvents()};j.isIos?window.addEventListener("pagehide",t,!1):window.addEventListener("beforeunload",t,!1)}return e.prototype.push=function(e){this._logger.info("New event Added",e),this.events.push(e),this._unsentEvents+=1},e.prototype.sendEvents=function(){var e=this,t=this._getEventsReadyToSend();return t.splice(20,t.length),new Promise(function(i,o){if(t.length>0){var n=new V(t);n.sendGroup().then(function(){n=void 0,t.forEach(function(e){return e.isSent()}),e._clearUnsent(),i()}).catch(function(){e._logger.warn("Failed to send "+t.length+". Restoring event status"),t.forEach(function(e){return e.canSend()})})}else i()})},e.prototype._getEventsReadyToSend=function(){var e=this.events?this.events.filter(function(e){return e.canSend()}):[];return e.length&&this.initEvents.length&&(e=e.concat(this.initEvents.filter(function(e){return e.canSend()}))),e},e.prototype._storeUnsent=function(){var e=this._getEventsReadyToSend();if(e.length){var t=new V(e);y.a.set("dgd_unsent",JSON.stringify(t),f.a.base64)}},e.prototype._clearUnsent=function(){y.a.remove("dgd_unsent")},e.prototype._savePreviousSessionEvents=function(){var e=this,t=y.a.get("dgd_unsent",f.a.base64);if(t){var i=JSON.parse(t).events;i&&i.forEach(function(t){var i;try{i=e._rawToEvent(t)}catch(i){e._logger.error("Exception parsing event",t,i)}i&&e.push(i)})}},e.prototype._rawToEvent=function(e){var t;switch(e.category){case"hit_event":return t={eventId:e._evId,eventTime:e.event_time,eventType:w.toCamel(e.event_type),originUrl:e.origin_url,passiveTracking:e.passive_tracking,publicKey:e.public_key,url:e.url},new k(t);case"load_event":return t={eventId:e._evId,eventTime:e.event_time,originUrl:e.origin_url,pluginName:e.plugin_name,pluginVersion:e.plugin_version,publicKey:e.public_key,url:e.url},new T(t);case"text_event":return t={currentTime:e.current_time,elementId:e.element_id,eventId:e._evId,eventTime:e.event_time,eventType:w.toCamel(e.event_type),originUrl:e.origin_url,publicKey:e.public_key,scrollPercentage:e.scroll_percentage,url:e.url},new S(t);case"reco_event":return t={elemHash:e.elem_hash,eventId:e._evId,eventTime:e.event_time,eventType:w.toCamel(e.event_type),originUrl:e.origin_url,publicKey:e.public_key,url:e.url},new D(t);case"gallery_event":return t={currentTime:e.current_time,eventId:e._evId,eventTime:e.event_time,eventType:w.toCamel(e.event_type),isRedirect:e.is_redirect,originUrl:e.origin_url,passiveTracking:e.passive_tracking,previewHash:e.preview_hash,publicKey:e.public_key,resolution:e.resolution,url:e.url},new N(t);case"media_event":return t={currentTime:e.current_time,elementId:e.element_id,eventId:e._evId,eventTime:e.event_time,eventType:w.toCamel(e.event_type),originUrl:e.origin_url,publicKey:e.public_key,url:e.url},new E(t);default:return this._logger.error("Raw event from local Storage can't be parsed.",e),null}},e}(),q=function(){function e(e,t){this._logger=new c.a("[DAGDA]"),this._dagdaSession=new R,t&&(d.a.publickey=t.publicKey,d.a.passiveTracking=t.passiveTracking,l.a.logLevel=t.logLevel||l.a.logLevel),this._defineProperties(),this._logger.info("Dagda class initialized");var i=new k({eventType:a.pageLoad,passiveTracking:d.a.passiveTracking,publicKey:d.a.publickey});if(this._dagdaSession.initEvents.push(i),window.vilynx=window.vilynx||{},window.vilynx.dagda=window.vilynx.dagda||{},!window.vilynx.dagda.t){window.vilynx.dagda.mediaTrack=this.mediaTrack,window.vilynx.dagda.textTrack=this.textTrack,window.vilynx.dagda.t=+new Date,d.a.godMode&&(window.vilynx.dagda.galleryTrack=this.galleryTrack,window.vilynx.dagda.recoTrack=this.recoTrack);var o=new T(e);this._dagdaSession.initEvents.push(o)}this._clearCache()}return e.prototype._defineProperties=function(){var e=this;this.mediaTrack=function(t){var i=new E(t);0===d.a.sendDelay?i.send():e._dagdaSession.push(i)},this.textTrack=function(t){var i=new S(t);e._logger.info("New Text Event created",t,i),0===d.a.sendDelay?i.send():e._dagdaSession.push(i)},this.galleryTrack=function(t){var i=new N(t);e._logger.info("New Gallery event created",t,i),0===d.a.sendDelay?i.send():e._dagdaSession.push(i)},this.recoTrack=function(t){var i=new D(t);e._logger.info("New Text Event created",t,i),0===d.a.sendDelay?i.send():e._dagdaSession.push(i)}},e.prototype._clearCache=function(){var e=this,t=window.vilynx.dagda.chM||[],i=window.vilynx.dagda.chT||[];t.forEach(function(t){try{var i=new E(t);e._logger.info("New Media Event created from cache",i),e._dagdaSession.push(i)}catch(i){e._logger.error("The cached event "+t+" is not a valid mediaEvent",i)}}),t=[],i.forEach(function(t){try{var i=new S(t);e._logger.info("New Text Event created from cache",i),e._dagdaSession.push(i)}catch(i){e._logger.error("The cached event "+t+" is not a valid textEvent",i)}}),i=[],0===d.a.sendDelay&&this._dagdaSession.sendEvents()},e}(),z=i(2),B=i(0);i.d(t,"a",function(){return W});var W=function(){function e(){}return e.instance=function(){return B.a.analytics&&!this._dagda&&(d.a.setValue("sendDelay","5000"),this._dagda=new q({pluginName:"gallery",pluginVersion:z.a.galleryVersion},{publicKey:B.a.publickey,passiveTracking:B.a.passivetracking})),this._dagda},e}()},function(e,t,i){"use strict";var o=function(){function e(){}return e.prototype.chance=function(e){if(e>100||e<0)throw new Error("number must be between 0 and 100");return Math.random()<.01*e},e.prototype.randomInt=function(e,t){return Math.floor(Math.random()*(t+1)+e)},e.prototype.generateRandomHex=function(e){void 0===e&&(e=4);for(var t=Math.pow(16,Math.min(e,8)-1),i=Math.pow(16,Math.min(e,8))-1,o=(Math.floor(Math.random()*(i-t+1))+t).toString(16);o.length<e;)o+=this.generateRandomHex(e-8);return o},e.prototype.generateRandomUUID=function(){var e=this.generateRandomHex;return e(8)+"-"+e()+"-"+e()+"-"+e()+"-"+e(12)},e}();t.a=new o},function(e,t,i){(function(t,i){e.exports=function(){"use strict";function e(e){return"function"==typeof e}function o(){var e=setTimeout;return function(){return e(n,1)}}function n(){for(var e=0;e<g;e+=2){var t=A[e],i=A[e+1];t(i),A[e]=void 0,A[e+1]=void 0}g=0}function r(e,t){var i=this,o=new this.constructor(a);void 0===o[L]&&_(o);var n=i._state;if(n){var r=arguments[n-1];O(function(){return v(n,o,r,i._result)})}else f(i,o,e,t);return o}function s(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(a);return d(t,e),t}function a(){}function l(e){try{return e.then}catch(e){return j.error=e,j}}function c(t,i,o){i.constructor===t.constructor&&o===r&&i.constructor.resolve===s?function(e,t){t._state===I?h(e,t._result):t._state===T?p(e,t._result):f(t,void 0,function(t){return d(e,t)},function(t){return p(e,t)})}(t,i):o===j?(p(t,j.error),j.error=null):void 0===o?h(t,i):e(o)?function(e,t,i){O(function(e){var o=!1,n=function(e,t,i,o){try{e.call(t,i,o)}catch(e){return e}}(i,t,function(i){o||(o=!0,t!==i?d(e,i):h(e,i))},function(t){o||(o=!0,p(e,t))},e._label);!o&&n&&(o=!0,p(e,n))},e)}(t,i,o):h(t,i)}function d(e,t){e===t?p(e,new TypeError("You cannot resolve a promise with itself")):function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?c(e,t,l(t)):h(e,t)}function u(e){e._onerror&&e._onerror(e._result),y(e)}function h(e,t){e._state===k&&(e._result=t,e._state=I,0!==e._subscribers.length&&O(y,e))}function p(e,t){e._state===k&&(e._state=T,e._result=t,O(u,e))}function f(e,t,i,o){var n=e._subscribers,r=n.length;e._onerror=null,n[r]=t,n[r+I]=i,n[r+T]=o,0===r&&e._state&&O(y,e)}function y(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var o=void 0,n=void 0,r=e._result,s=0;s<t.length;s+=3)o=t[s],n=t[s+i],o?v(i,o,n,r):n(r);e._subscribers.length=0}}function v(t,i,o,n){var r=e(o),s=void 0,a=void 0,l=void 0,c=void 0;if(r){if((s=function(e,t){try{return e(t)}catch(e){return j.error=e,j}}(o,n))===j?(c=!0,a=s.error,s.error=null):l=!0,i===s)return void p(i,new TypeError("A promises callback cannot return that same promise."))}else s=n,l=!0;i._state!==k||(r&&l?d(i,s):c?p(i,a):t===I?h(i,s):t===T&&p(i,s))}function _(e){e[L]=M++,e._state=void 0,e._result=void 0,e._subscribers=[]}var m=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},g=0,b=void 0,w=void 0,O=function(e,t){A[g]=e,A[g+1]=t,2===(g+=2)&&(w?w(n):S())},E="undefined"!=typeof window?window:void 0,x=E||{},N=x.MutationObserver||x.WebKitMutationObserver,P="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),D="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,A=new Array(1e3),S=void 0;S=P?function(){return t.nextTick(n)}:N?function(){var e=0,t=new N(n),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}():D?function(){var e=new MessageChannel;return e.port1.onmessage=n,function(){return e.port2.postMessage(0)}}():void 0===E?function(){try{var e=Function("return this")().require("vertx");return void 0!==(b=e.runOnLoop||e.runOnContext)?function(){b(n)}:o()}catch(e){return o()}}():o();var L=Math.random().toString(36).substring(2),k=void 0,I=1,T=2,j={error:null},M=0,V=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(a),this.promise[L]||_(this.promise),m(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?h(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&h(this.promise,this._result))):p(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===k&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,o=i.resolve;if(o===s){var n=l(e);if(n===r&&e._state!==k)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(i===R){var d=new i(a);c(d,e,n),this._willSettleAt(d,t)}else this._willSettleAt(new i(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},e.prototype._settledAt=function(e,t,i){var o=this.promise;o._state===k&&(this._remaining--,e===T?p(o,i):this._result[t]=i),0===this._remaining&&h(o,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;f(e,void 0,function(e){return i._settledAt(I,t,e)},function(e){return i._settledAt(T,t,e)})},e}(),R=function(){function e(t){this[L]=M++,this._result=this._state=void 0,this._subscribers=[],a!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){d(e,t)},function(t){p(e,t)})}catch(t){p(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(i){return t.resolve(e()).then(function(){return i})},function(i){return t.resolve(e()).then(function(){throw i})})},e}();return R.prototype.then=r,R.all=function(e){return new V(this,e).promise},R.race=function(e){var t=this;return new t(m(e)?function(i,o){for(var n=e.length,r=0;r<n;r++)t.resolve(e[r]).then(i,o)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},R.resolve=s,R.reject=function(e){var t=new this(a);return p(t,e),t},R._setScheduler=function(e){w=e},R._setAsap=function(e){O=e},R._asap=O,R.polyfill=function(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var o=null;try{o=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===o&&!t.cast)return}e.Promise=R},R.Promise=R,R.polyfill(),R}()}).call(this,i(20),i(21))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _modules_helpers_exposed__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_modules_domObserve__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_vilynx_frontend_core_Logger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3),_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1),_styles_vpg_less__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(22),_styles_vpg_less__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_styles_vpg_less__WEBPACK_IMPORTED_MODULE_6__),_vilynx_frontend_core_config_coreConfig__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9),_vilynx_frontend_core_enums_logger__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12),_vilynx_frontend_core_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(10),_vilynx_frontend_core_localstorage__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(11),_vilynx_frontend_core_random__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(17),_polyfills_path__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(27),_polyfills_path__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_polyfills_path__WEBPACK_IMPORTED_MODULE_12__),_polyfills_assign__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(28),_polyfills_assign__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_polyfills_assign__WEBPACK_IMPORTED_MODULE_13__),_polyfills_closest__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(29),_polyfills_closest__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_polyfills_closest__WEBPACK_IMPORTED_MODULE_14__),_polyfills_matches__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(30),_polyfills_matches__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_polyfills_matches__WEBPACK_IMPORTED_MODULE_15__),_vilynx_dagda_src_dagda_config_publicConfig__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(7),_modules_helpers_viewportQueue__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(5),_vilynx_frontend_core_enums_storage__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(4),_GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(14),_modules_analytics_dagda__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(16),Bootstrap=function(){function Bootstrap(){var e=this;this._logger=new _vilynx_frontend_core_Logger__WEBPACK_IMPORTED_MODULE_4__.a("[Bootstrap]"),this._addTurboLinkListener(),this._loadConfig().then(function(){var t="complete"===document.readyState||"interactive"===document.readyState;e._configureABTesting()?(e._logger.info("User is on A/B group or A/B testing is disabled. Loading gallery."),t?e.initGallery():document.addEventListener("DOMContentLoaded",function(){e.initGallery()})):e._logger.info("User is out of A/B testing, Gallery will not be loaded")}).catch(function(){e._logger.critical("Cannot load Vilynx Gallery config, unable to initialize.")})}return Bootstrap.prototype.initGallery=function(){var _this=this;if(_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.disablestorage||this.insertVilynxIFrame(),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.analytics&&_modules_analytics_dagda__WEBPACK_IMPORTED_MODULE_20__.a.instance(),_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isTablet&&(_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__.a.tapToPlay=!0),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.ongalleryload)setTimeout(function(){try{eval(_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.ongalleryload)()}catch(e){_this._logger.error("Error executing ongalleryload callback")}var observe=new _modules_domObserve__WEBPACK_IMPORTED_MODULE_1__.a},500);else var observe=new _modules_domObserve__WEBPACK_IMPORTED_MODULE_1__.a},Bootstrap.prototype.insertVilynxIFrame=function(){var e=document.createElement("iframe");return e.style.display="none",e.src=_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__.a.iframeUrl,window.addEventListener("message",function(e){"https://static.vilynx.com"!==e.origin&&"https://static.test.vilynx.com"!==e.origin||(_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__.a.vilynxUID=e.data)},!1),document.querySelector("body").appendChild(e),!0},Bootstrap.prototype._addTurboLinkListener=function(){var e=this;document.addEventListener("turbolinks:load",function(){e._clearGalleryItems()})},Bootstrap.prototype._clearGalleryItems=function(){_modules_helpers_viewportQueue__WEBPACK_IMPORTED_MODULE_17__.a.clearQueues(),window.vilynx.gallery.galleryItems.forEach(function(e){e.removeItem(),e=void 0}),window.vilynx.gallery.galleryItems=[],window.vilynx.gallery.reObserve()},Bootstrap.prototype._loadConfig=function(){var e=this,t=document.querySelector('script[src*="gallery/vpg"],script[data-gallery-local]');return new Promise(function(i,o){null==t&&(e._logger.critical("FUBAR: Can't find script tag"),o());var n=Object(_vilynx_frontend_core_utils__WEBPACK_IMPORTED_MODULE_9__.c)(t),r=void 0!==n&&Object.keys(n).length>0;_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__.a.scriptTag=t,_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.debug||(_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.debug=!!localStorage.getItem("vilynx_gallery_debug"),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.debug&&(_vilynx_frontend_core_config_coreConfig__WEBPACK_IMPORTED_MODULE_7__.a.logLevel=_vilynx_frontend_core_enums_logger__WEBPACK_IMPORTED_MODULE_8__.a.develop,e._logger.info("Gallery debug enabled by localStorage"))),t||(e._logger.warn("Vilynx Script not detected"),o()),Object.keys(t.attributes).forEach(function(i){var o=t.attributes[i],n=o.name,s=o.value;r||(n=n.replace("data-","")),void 0===_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[n]?e._logger.warn("Config register not found: "+n):("number"==typeof _config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[n]?s=parseInt(o.value,10):"boolean"==typeof _config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[n]&&("true"===(s=o.value).toLowerCase()?s=!0:"false"===s.toLowerCase()&&(s=!1)),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[n]=s,e._logger.debug("Config element loaded: "+n))}),n&&Object.keys(n).forEach(function(t){var i,o=t;void 0===_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[o]?e._logger.warn("Config register not found: "+o):("true"===(i=n[t]).toLowerCase()?i=!0:"false"===i.toLowerCase()&&(i=!1),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a[o]=i,e._logger.debug("Config element loaded: "+o))}),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.debug&&(_vilynx_frontend_core_config_coreConfig__WEBPACK_IMPORTED_MODULE_7__.a.logLevel=_vilynx_frontend_core_enums_logger__WEBPACK_IMPORTED_MODULE_8__.a.develop),_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.publickey||(e._logger.critical("FUBAR: Can't find userid. Aborting"),o()),(_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isMobile&&_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.nomobile||_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isTablet&&_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.notablet)&&(e._logger.info("Vilynx Gallery deactivated in mobile"),o()),_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isOldIphone&&(e._logger.info("Vilynx Gallery disabled on iPhone 4 and lower"),o()),_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isIe10&&(e._logger.info("Vilynx Gallery disabled on IE10 and lower"),o()),_modules_helpers_browser__WEBPACK_IMPORTED_MODULE_5__.a.isVizio&&null===_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.viziodevice&&(_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.viziodevice=!0),e._logger.info("Config loaded"),_vilynx_dagda_src_dagda_config_publicConfig__WEBPACK_IMPORTED_MODULE_16__.a.publickey=_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.publickey,_config_privateConfig__WEBPACK_IMPORTED_MODULE_3__.a.loaded=!0,i()})},Bootstrap.prototype._configureABTesting=function(){var e,t,i;if(0===_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.abtestingpercentage)return!0;_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.passivetracking&&this._logger.warn("Setting passive tracking will override A/B testing which is also configured.");var o=_vilynx_frontend_core_localstorage__WEBPACK_IMPORTED_MODULE_10__.a.get("vlx_gallery_AB",_vilynx_frontend_core_enums_storage__WEBPACK_IMPORTED_MODULE_18__.a.plain);if(o)switch(t=parseInt(o,10)){case _GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.outOfAB:return!1;case _GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.galleryActive:return!0;case _GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.galleryPassive:return _config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.passivetracking=!0,!0}var n=_vilynx_frontend_core_random__WEBPACK_IMPORTED_MODULE_11__.a.chance(_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.abtestingpercentage),r=_vilynx_frontend_core_random__WEBPACK_IMPORTED_MODULE_11__.a.chance(50);return i=n&&r,e=n,_config_globalConfig__WEBPACK_IMPORTED_MODULE_2__.a.passivetracking=i,t=e?i?_GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.galleryPassive:_GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.galleryActive:_GalleryABStatus__WEBPACK_IMPORTED_MODULE_19__.a.outOfAB,_vilynx_frontend_core_localstorage__WEBPACK_IMPORTED_MODULE_10__.a.set("vlx_gallery_AB",t.toString(),_vilynx_frontend_core_enums_storage__WEBPACK_IMPORTED_MODULE_18__.a.plain),e},Bootstrap}(),bootstrap=new Bootstrap;window.vilynx?window.vilynx.gallery=_modules_helpers_exposed__WEBPACK_IMPORTED_MODULE_0__.a:window.vilynx={gallery:_modules_helpers_exposed__WEBPACK_IMPORTED_MODULE_0__.a}},function(e,t){var i,o,n=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var l,c=[],d=!1,u=-1;function h(){d&&l&&(d=!1,l.length?c=l.concat(c):u=-1,c.length&&p())}function p(){if(!d){var e=a(h);d=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,d=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function y(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new f(e,t)),1!==c.length||d||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=y,n.addListener=y,n.once=y,n.off=y,n.removeListener=y,n.removeAllListeners=y,n.emit=y,n.prependListener=y,n.prependOnceListener=y,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){var o=i(23);"string"==typeof o&&(o=[[e.i,o,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(25)(o,n);o.locals&&(e.exports=o.locals)},function(e,t,i){(e.exports=i(24)(!1)).push([e.i,".vilynx_fading:not([vilynx-fadingid]):not([data-vilynx-fadingid]) {\n  opacity: 1 !important;\n  visibility: visible;\n}\n.vilynx_registered .vilynx_wrapperImg {\n  height: 100%;\n  width: 100%;\n  transition: opacity 0.35s linear;\n  position: relative;\n  z-index: 1;\n  object-fit: cover;\n}\n.vilynx_registered .vilynx_wrapperImg.vilynx-hide {\n  opacity: 0;\n  visibility: hidden;\n}\n.vilynx_registered .vilynx_wrapperImg.vilynx_fading {\n  opacity: 0 !important;\n}\n.vilynx_registered div:not(vilynx_img).vilynx_fading:not([vilynx-fadingid]):not([data-vilynx-fadingid]) {\n  opacity: 1 !important;\n  visibility: visible;\n}\n.vilynx_registered .supra-wrapper video {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: -5;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.vilynx_registered .supra-wrapper {\n  overflow: hidden;\n  position: absolute;\n  z-index: 1;\n  width: 100%;\n}\n.vilynx_registered .supra-wrapper.vilynx-hide {\n  opacity: 0;\n  visibility: hidden;\n}\n.vilynx_registered.vilynx_disabled .supra-wrapper {\n  opacity: 0;\n  visibility: hidden;\n}\n.vilynx_registered .redirectWrapper {\n  display: table;\n  position: absolute;\n  left: 0;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  height: 100% !important;\n  width: 100%;\n  text-align: center;\n  z-index: 1000;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity 0.35s linear !important;\n}\n.vilynx_registered .redirectWrapper .redirectCenter {\n  display: table-cell;\n  vertical-align: middle;\n}\n.vilynx_registered .redirectWrapper .redirectCenter .text {\n  max-width: 100%;\n  margin-bottom: 10px;\n  font-family: sans-serif;\n  color: white;\n}\n.vilynx_registered .redirectWrapper .redirectCenter .counter {\n  max-width: 100%;\n  font-family: sans-serif;\n  color: white;\n}\n.vilynx_registered .redirectWrapper.cta.hideCtaIcon .counter {\n  display: none;\n}\n.vilynx_registered .redirectWrapper.cta .redirectCenter .text {\n  margin-bottom: 8px;\n  font-weight: 100;\n}\n.vilynx_registered .redirectWrapper.cta .counter {\n  position: relative;\n  display: block;\n  content: '';\n  width: 35px;\n  height: 35px;\n  border-radius: 50%;\n  border: 2px solid #FFF;\n  text-indent: -1000px;\n  left: 50%;\n  margin-left: -20px;\n}\n.vilynx_registered .redirectWrapper.cta .counter:before {\n  display: block;\n  content: '';\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-top: 10px solid transparent;\n  border-bottom: 10px solid transparent;\n  border-left: 18px solid white;\n  left: 50%;\n  margin-left: -7px;\n  top: 50%;\n  margin-top: -10px;\n}\n.vilynx_gif {\n  display: block;\n  position: absolute;\n  top: 0;\n  width: 100%;\n  z-index: 20;\n}\n[data-vilynx-fadingid],\n[vilynx-fadingid] {\n  transition: opacity 0.35s linear;\n}\n.vilynx_fading[data-vilynx-fadingid],\n.vilynx_fading[vilynx-fadingid] {\n  opacity: 0;\n}\n@media only screen and (max-device-width: 736px) {\n  .vilynx_registered img {\n    transition: none;\n  }\n}\n",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=function(e,t){var i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var n=(s=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),r=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[i].concat(r).concat([n]).join("\n")}var s;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},n=0;n<this.length;n++){var r=this[n][0];"number"==typeof r&&(o[r]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&o[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}},function(e,t,i){var o,n,r={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=o.apply(this,arguments)),n}),a=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var o=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,i);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}}(),l=null,c=0,d=[],u=i(26);function h(e,t){for(var i=0;i<e.length;i++){var o=e[i],n=r[o.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](o.parts[s]);for(;s<o.parts.length;s++)n.parts.push(m(o.parts[s],t))}else{var a=[];for(s=0;s<o.parts.length;s++)a.push(m(o.parts[s],t));r[o.id]={id:o.id,refs:1,parts:a}}}}function p(e,t){for(var i=[],o={},n=0;n<e.length;n++){var r=e[n],s=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};o[s]?o[s].parts.push(a):i.push(o[s]={id:s,parts:[a]})}return i}function f(e,t){var i=a(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=d[d.length-1];if("top"===e.insertAt)o?o.nextSibling?i.insertBefore(t,o.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),d.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(e.insertAt.before,i);i.insertBefore(t,n)}}function y(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=d.indexOf(e);t>=0&&d.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var o=function(){0;return i.nc}();o&&(e.attrs.nonce=o)}return _(t,e.attrs),f(e,t),t}function _(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}function m(e,t){var i,o,n,r;if(t.transform&&e.css){if(!(r="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=r}if(t.singleton){var s=c++;i=l||(l=v(t)),o=w.bind(null,i,s,!1),n=w.bind(null,i,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",_(t,e.attrs),f(e,t),t}(t),o=function(e,t,i){var o=i.css,n=i.sourceMap,r=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||r)&&(o=u(o));n&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([o],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,i,t),n=function(){y(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(t),o=function(e,t){var i=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}.bind(null,i),n=function(){y(i)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=p(e,t);return h(i,t),function(e){for(var o=[],n=0;n<i.length;n++){var s=i[n];(a=r[s.id]).refs--,o.push(a)}e&&h(p(e,t),t);for(n=0;n<o.length;n++){var a;if(0===(a=o[n]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete r[a.id]}}}};var g,b=(g=[],function(e,t){return g[e]=t,g.filter(Boolean).join("\n")});function w(e,t,i,o){var n=i?"":o.css;if(e.styleSheet)e.styleSheet.cssText=b(t,n);else{var r=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,o=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(n=0===r.indexOf("//")?r:0===r.indexOf("/")?i+r:o+r.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t){"path"in Event.prototype||Object.defineProperty(Event.prototype,"path",{get:function(){for(var e=[],t=this.target;t;)e.push(t),t=t.parentElement;return-1===e.indexOf(window)&&-1===e.indexOf(document)&&e.push(document),-1===e.indexOf(window)&&e.push(window),e}})},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},writable:!0,configurable:!0})},function(e,t){window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,i=(this.document||this.ownerDocument).querySelectorAll(e),o=this;do{for(t=i.length;--t>=0&&i.item(t)!==o;);}while(t<0&&(o=o.parentElement));return o})},function(e,t){if(Element&&!Element.prototype.matches){let e=Element.prototype;e.matches=e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector}}]);